<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width">
<meta name="theme-color" content="#222"><meta name="generator" content="Hexo 7.3.0">

  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">



<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.7.2/css/all.min.css" integrity="sha256-dABdfBfUoC8vJUBOwGVdm8L9qlMWaHTIfXt+7GnZCIo=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/3.1.1/animate.min.css" integrity="sha256-PR7ttpcvz8qrF57fur/yAx1qXMFJeJFiA6pSzWi0OIE=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/fancyapps-ui/5.0.31/fancybox/fancybox.css" integrity="sha256-gkQVf8UKZgQ0HyuxL/VnacadJ+D2Kox2TCEBuNQg5+w=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pace/1.2.4/themes/blue/pace-theme-minimal.css">
  <script src="https://cdnjs.cloudflare.com/ajax/libs/pace/1.2.4/pace.min.js" integrity="sha256-gqd7YTjg/BtfqWSwsJOvndl0Bxc8gFImLEkXQT8+qj0=" crossorigin="anonymous"></script>

<script class="next-config" data-name="main" type="application/json">{"hostname":"vinyyang.github.io","root":"/","images":"/images","scheme":"Gemini","darkmode":false,"version":"8.22.0","exturl":false,"sidebar":{"position":"left","width_expanded":320,"width_dual_column":240,"display":"post","padding":18,"offset":12},"hljswrap":true,"copycode":{"enable":true,"style":null},"fold":{"enable":false,"height":500},"bookmark":{"enable":false,"color":"#222","save":"auto"},"mediumzoom":false,"lazyload":false,"pangu":true,"comments":{"style":"tabs","active":"giscus","storage":true,"lazyload":false,"nav":null,"activeClass":"giscus"},"stickytabs":false,"motion":{"enable":true,"async":false,"duration":200,"transition":{"menu_item":"fadeInDown","post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"i18n":{"placeholder":"搜索...","empty":"没有找到任何搜索结果：${query}","hits_time":"找到 ${hits} 个搜索结果（用时 ${time} 毫秒）","hits":"找到 ${hits} 个搜索结果"},"path":"/search.xml","localsearch":{"enable":true,"top_n_per_article":1,"unescape":false,"preload":false}}</script><script src="/js/config.js"></script>

    <meta name="description" content="数据库原理与应用（外教版）">
<meta property="og:type" content="article">
<meta property="og:title" content="数据库原理与应用（外教版）">
<meta property="og:url" content="https://vinyyang.github.io/%E6%95%B0%E6%8D%AE%E5%BA%93%E5%8E%9F%E7%90%86%E4%B8%8E%E5%BA%94%E7%94%A8%EF%BC%88%E5%A4%96%E6%95%99%E7%89%88%EF%BC%89/index.html">
<meta property="og:site_name" content="Viny与CS的邂逅">
<meta property="og:description" content="数据库原理与应用（外教版）">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://vinyyang.github.io/%E6%95%B0%E6%8D%AE%E5%BA%93%E5%8E%9F%E7%90%86%E4%B8%8E%E5%BA%94%E7%94%A8%EF%BC%88%E5%A4%96%E6%95%99%E7%89%88%EF%BC%89/image-20250422103948934.png">
<meta property="og:image" content="https://vinyyang.github.io/%E6%95%B0%E6%8D%AE%E5%BA%93%E5%8E%9F%E7%90%86%E4%B8%8E%E5%BA%94%E7%94%A8%EF%BC%88%E5%A4%96%E6%95%99%E7%89%88%EF%BC%89/image-20250422103959905.png">
<meta property="og:image" content="https://vinyyang.github.io/%E6%95%B0%E6%8D%AE%E5%BA%93%E5%8E%9F%E7%90%86%E4%B8%8E%E5%BA%94%E7%94%A8%EF%BC%88%E5%A4%96%E6%95%99%E7%89%88%EF%BC%89/image-20250422104145155.png">
<meta property="og:image" content="https://vinyyang.github.io/%E6%95%B0%E6%8D%AE%E5%BA%93%E5%8E%9F%E7%90%86%E4%B8%8E%E5%BA%94%E7%94%A8%EF%BC%88%E5%A4%96%E6%95%99%E7%89%88%EF%BC%89/image-20250422104233490.png">
<meta property="og:image" content="https://vinyyang.github.io/%E6%95%B0%E6%8D%AE%E5%BA%93%E5%8E%9F%E7%90%86%E4%B8%8E%E5%BA%94%E7%94%A8%EF%BC%88%E5%A4%96%E6%95%99%E7%89%88%EF%BC%89/image-20250423142752778.png">
<meta property="og:image" content="https://vinyyang.github.io/%E6%95%B0%E6%8D%AE%E5%BA%93%E5%8E%9F%E7%90%86%E4%B8%8E%E5%BA%94%E7%94%A8%EF%BC%88%E5%A4%96%E6%95%99%E7%89%88%EF%BC%89/image-20250423142907232-1745389748192-1.png">
<meta property="og:image" content="https://vinyyang.github.io/%E6%95%B0%E6%8D%AE%E5%BA%93%E5%8E%9F%E7%90%86%E4%B8%8E%E5%BA%94%E7%94%A8%EF%BC%88%E5%A4%96%E6%95%99%E7%89%88%EF%BC%89/image-20250423143114397.png">
<meta property="og:image" content="https://vinyyang.github.io/%E6%95%B0%E6%8D%AE%E5%BA%93%E5%8E%9F%E7%90%86%E4%B8%8E%E5%BA%94%E7%94%A8%EF%BC%88%E5%A4%96%E6%95%99%E7%89%88%EF%BC%89/image-20250423143220424.png">
<meta property="og:image" content="https://vinyyang.github.io/%E6%95%B0%E6%8D%AE%E5%BA%93%E5%8E%9F%E7%90%86%E4%B8%8E%E5%BA%94%E7%94%A8%EF%BC%88%E5%A4%96%E6%95%99%E7%89%88%EF%BC%89/image-20250423143414571.png">
<meta property="og:image" content="https://vinyyang.github.io/%E6%95%B0%E6%8D%AE%E5%BA%93%E5%8E%9F%E7%90%86%E4%B8%8E%E5%BA%94%E7%94%A8%EF%BC%88%E5%A4%96%E6%95%99%E7%89%88%EF%BC%89/image-20250510210337610.png">
<meta property="og:image" content="https://vinyyang.github.io/%E6%95%B0%E6%8D%AE%E5%BA%93%E5%8E%9F%E7%90%86%E4%B8%8E%E5%BA%94%E7%94%A8%EF%BC%88%E5%A4%96%E6%95%99%E7%89%88%EF%BC%89/image-20250510210509270.png">
<meta property="og:image" content="https://vinyyang.github.io/%E6%95%B0%E6%8D%AE%E5%BA%93%E5%8E%9F%E7%90%86%E4%B8%8E%E5%BA%94%E7%94%A8%EF%BC%88%E5%A4%96%E6%95%99%E7%89%88%EF%BC%89/image-20250510211849132.png">
<meta property="og:image" content="https://vinyyang.github.io/%E6%95%B0%E6%8D%AE%E5%BA%93%E5%8E%9F%E7%90%86%E4%B8%8E%E5%BA%94%E7%94%A8%EF%BC%88%E5%A4%96%E6%95%99%E7%89%88%EF%BC%89/image-20250510211855671.png">
<meta property="og:image" content="https://vinyyang.github.io/%E6%95%B0%E6%8D%AE%E5%BA%93%E5%8E%9F%E7%90%86%E4%B8%8E%E5%BA%94%E7%94%A8%EF%BC%88%E5%A4%96%E6%95%99%E7%89%88%EF%BC%89/image-20250510211901064.png">
<meta property="og:image" content="https://vinyyang.github.io/%E6%95%B0%E6%8D%AE%E5%BA%93%E5%8E%9F%E7%90%86%E4%B8%8E%E5%BA%94%E7%94%A8%EF%BC%88%E5%A4%96%E6%95%99%E7%89%88%EF%BC%89/image-20250510211911012.png">
<meta property="og:image" content="https://vinyyang.github.io/%E6%95%B0%E6%8D%AE%E5%BA%93%E5%8E%9F%E7%90%86%E4%B8%8E%E5%BA%94%E7%94%A8%EF%BC%88%E5%A4%96%E6%95%99%E7%89%88%EF%BC%89/image-20250510212232034.png">
<meta property="og:image" content="https://vinyyang.github.io/%E6%95%B0%E6%8D%AE%E5%BA%93%E5%8E%9F%E7%90%86%E4%B8%8E%E5%BA%94%E7%94%A8%EF%BC%88%E5%A4%96%E6%95%99%E7%89%88%EF%BC%89/image-20250510212323974.png">
<meta property="og:image" content="https://vinyyang.github.io/%E6%95%B0%E6%8D%AE%E5%BA%93%E5%8E%9F%E7%90%86%E4%B8%8E%E5%BA%94%E7%94%A8%EF%BC%88%E5%A4%96%E6%95%99%E7%89%88%EF%BC%89/image-20250510213141605.png">
<meta property="og:image" content="https://vinyyang.github.io/%E6%95%B0%E6%8D%AE%E5%BA%93%E5%8E%9F%E7%90%86%E4%B8%8E%E5%BA%94%E7%94%A8%EF%BC%88%E5%A4%96%E6%95%99%E7%89%88%EF%BC%89/image-20250510213433472.png">
<meta property="og:image" content="https://vinyyang.github.io/%E6%95%B0%E6%8D%AE%E5%BA%93%E5%8E%9F%E7%90%86%E4%B8%8E%E5%BA%94%E7%94%A8%EF%BC%88%E5%A4%96%E6%95%99%E7%89%88%EF%BC%89/image-20250510213942400.png">
<meta property="og:image" content="https://vinyyang.github.io/%E6%95%B0%E6%8D%AE%E5%BA%93%E5%8E%9F%E7%90%86%E4%B8%8E%E5%BA%94%E7%94%A8%EF%BC%88%E5%A4%96%E6%95%99%E7%89%88%EF%BC%89/image-20250510214138658.png">
<meta property="og:image" content="https://vinyyang.github.io/%E6%95%B0%E6%8D%AE%E5%BA%93%E5%8E%9F%E7%90%86%E4%B8%8E%E5%BA%94%E7%94%A8%EF%BC%88%E5%A4%96%E6%95%99%E7%89%88%EF%BC%89/image-20250510214230173.png">
<meta property="og:image" content="https://vinyyang.github.io/%E6%95%B0%E6%8D%AE%E5%BA%93%E5%8E%9F%E7%90%86%E4%B8%8E%E5%BA%94%E7%94%A8%EF%BC%88%E5%A4%96%E6%95%99%E7%89%88%EF%BC%89/image-20250510214250575.png">
<meta property="og:image" content="https://vinyyang.github.io/%E6%95%B0%E6%8D%AE%E5%BA%93%E5%8E%9F%E7%90%86%E4%B8%8E%E5%BA%94%E7%94%A8%EF%BC%88%E5%A4%96%E6%95%99%E7%89%88%EF%BC%89/05cd82aa4503ad50ed57d1976d79780.jpg">
<meta property="og:image" content="https://vinyyang.github.io/%E6%95%B0%E6%8D%AE%E5%BA%93%E5%8E%9F%E7%90%86%E4%B8%8E%E5%BA%94%E7%94%A8%EF%BC%88%E5%A4%96%E6%95%99%E7%89%88%EF%BC%89/795b3dc0b26f16d0748643ce504f868.jpg">
<meta property="og:image" content="https://vinyyang.github.io/%E6%95%B0%E6%8D%AE%E5%BA%93%E5%8E%9F%E7%90%86%E4%B8%8E%E5%BA%94%E7%94%A8%EF%BC%88%E5%A4%96%E6%95%99%E7%89%88%EF%BC%89/image-20250429103002135.png">
<meta property="og:image" content="https://vinyyang.github.io/%E6%95%B0%E6%8D%AE%E5%BA%93%E5%8E%9F%E7%90%86%E4%B8%8E%E5%BA%94%E7%94%A8%EF%BC%88%E5%A4%96%E6%95%99%E7%89%88%EF%BC%89/image-20250429103706006.png">
<meta property="og:image" content="https://vinyyang.github.io/%E6%95%B0%E6%8D%AE%E5%BA%93%E5%8E%9F%E7%90%86%E4%B8%8E%E5%BA%94%E7%94%A8%EF%BC%88%E5%A4%96%E6%95%99%E7%89%88%EF%BC%89/image-20250506083447472.png">
<meta property="og:image" content="https://vinyyang.github.io/%E6%95%B0%E6%8D%AE%E5%BA%93%E5%8E%9F%E7%90%86%E4%B8%8E%E5%BA%94%E7%94%A8%EF%BC%88%E5%A4%96%E6%95%99%E7%89%88%EF%BC%89/image-20250507144701216.png">
<meta property="og:image" content="https://vinyyang.github.io/%E6%95%B0%E6%8D%AE%E5%BA%93%E5%8E%9F%E7%90%86%E4%B8%8E%E5%BA%94%E7%94%A8%EF%BC%88%E5%A4%96%E6%95%99%E7%89%88%EF%BC%89/image-20250514144309539.png">
<meta property="article:published_time" content="2025-04-22T00:05:21.000Z">
<meta property="article:modified_time" content="2025-06-13T17:07:50.836Z">
<meta property="article:author" content="Viny Yang">
<meta property="article:tag" content="学习">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://vinyyang.github.io/%E6%95%B0%E6%8D%AE%E5%BA%93%E5%8E%9F%E7%90%86%E4%B8%8E%E5%BA%94%E7%94%A8%EF%BC%88%E5%A4%96%E6%95%99%E7%89%88%EF%BC%89/image-20250422103948934.png">


<link rel="canonical" href="https://vinyyang.github.io/%E6%95%B0%E6%8D%AE%E5%BA%93%E5%8E%9F%E7%90%86%E4%B8%8E%E5%BA%94%E7%94%A8%EF%BC%88%E5%A4%96%E6%95%99%E7%89%88%EF%BC%89/">


<script class="next-config" data-name="page" type="application/json">{"sidebar":"","isHome":false,"isPost":true,"lang":"zh-CN","comments":true,"permalink":"https://vinyyang.github.io/%E6%95%B0%E6%8D%AE%E5%BA%93%E5%8E%9F%E7%90%86%E4%B8%8E%E5%BA%94%E7%94%A8%EF%BC%88%E5%A4%96%E6%95%99%E7%89%88%EF%BC%89/","path":"数据库原理与应用（外教版）/","title":"数据库原理与应用（外教版）"}</script>

<script class="next-config" data-name="calendar" type="application/json">""</script>
<title>数据库原理与应用（外教版） | Viny与CS的邂逅</title>
  

  <script src="/js/third-party/analytics/baidu-analytics.js"></script>
  <script async src="https://hm.baidu.com/hm.js?7d748fca465d5b9edd218c485f0a2579"></script>






<script src="//sdk.jinrishici.com/v2/browser/jinrishici.js"></script>
<script>
  jinrishici.load((result) => {
    let jrsc = document.getElementById('jrsc');
    const data = result.data;
    let author = data.origin.author;
    let title = '《' + data.origin.title + '》';
    let content = data.content.substr(0, data.content.length - 1);
    let dynasty = data.origin.dynasty.substr(0, data.origin.dynasty.length - 1);
    jrsc.innerText = content + ' @ ' + dynasty + '·' + author + title;
  });
</script>
<div style="text-align: center"><span id="jrsc" >正在加载今日诗词....</span></div>
  <noscript>
    <link rel="stylesheet" href="/css/noscript.css">
  </noscript>
<link rel="alternate" href="/atom.xml" title="Viny与CS的邂逅" type="application/atom+xml">
</head>

<body itemscope itemtype="http://schema.org/WebPage" class="use-motion">
  <div class="headband"></div>

  <main class="main">
    <div class="column">
      <header class="header" itemscope itemtype="http://schema.org/WPHeader"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏" role="button">
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <i class="logo-line"></i>
      <p class="site-title">Viny与CS的邂逅</p>
      <i class="logo-line"></i>
    </a>
      <p class="site-subtitle" itemprop="description">虽千万人吾往矣</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger" aria-label="搜索" role="button">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>



<nav class="site-nav">
  <ul class="main-menu menu"><li class="menu-item menu-item-home"><a href="/" rel="section"><i class="fa fa-home fa-fw"></i>首页</a></li><li class="menu-item menu-item-about"><a href="/about/" rel="section"><i class="fa fa-user fa-fw"></i>关于</a></li><li class="menu-item menu-item-tags"><a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>标签</a></li><li class="menu-item menu-item-categories"><a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>分类</a></li><li class="menu-item menu-item-archives"><a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>归档</a></li><li class="menu-item menu-item-guestbook"><a href="/guestbook/" rel="section"><i class="fa fa-book fa-fw"></i>留言板</a></li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>搜索
        </a>
      </li>
  </ul>
</nav>



  <div class="search-pop-overlay">
    <div class="popup search-popup">
      <div class="search-header">
        <span class="search-icon">
          <i class="fa fa-search"></i>
        </span>
        <div class="search-input-container">
          <input autocomplete="off" autocapitalize="off" maxlength="80"
                placeholder="搜索..." spellcheck="false"
                type="search" class="search-input">
        </div>
        <span class="popup-btn-close" role="button">
          <i class="fa fa-times-circle"></i>
        </span>
      </div>
      <div class="search-result-container">
        <div class="search-result-icon">
          <i class="fa fa-spinner fa-pulse fa-5x"></i>
        </div>
      </div>
    </div>
  </div>

</header>
        
  
  <aside class="sidebar">

    <div class="sidebar-inner sidebar-nav-active sidebar-toc-active">
      <ul class="sidebar-nav">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <div class="sidebar-panel-container">
        <!--noindex-->
        <div class="post-toc-wrap sidebar-panel">
            <div class="post-toc animated"><ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#4-22"><span class="nav-number">1.</span> <span class="nav-text">4.22</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#4-23"><span class="nav-number">2.</span> <span class="nav-text">4.23</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#4-29"><span class="nav-number">3.</span> <span class="nav-text">4.29</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#3NF%EF%BC%88%E7%AC%AC%E4%B8%89%E8%8C%83%E5%BC%8F%EF%BC%89%EF%BC%9A%E9%9D%9E%E4%B8%BB%E9%94%AE%E5%88%97%E4%B9%8B%E9%97%B4%E4%B8%8D%E8%83%BD-%E2%80%9C%E9%97%B4%E6%8E%A5%E4%BE%9D%E8%B5%96%E2%80%9D%EF%BC%8C%E5%8F%AA%E8%83%BD-%E2%80%9C%E7%9B%B4%E6%8E%A5%E9%9D%A0%E4%B8%BB%E9%94%AE%E2%80%9D"><span class="nav-number">3.1.</span> <span class="nav-text">3NF（第三范式）：非主键列之间不能 “间接依赖”，只能 “直接靠主键”</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#4-30"><span class="nav-number">4.</span> <span class="nav-text">4.30</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#5-6"><span class="nav-number">5.</span> <span class="nav-text">5.6</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#5-7"><span class="nav-number">6.</span> <span class="nav-text">5.7</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#5-13"><span class="nav-number">7.</span> <span class="nav-text">5.13</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#5-14"><span class="nav-number">8.</span> <span class="nav-text">5.14</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#5-14%EF%BC%882%EF%BC%89sort"><span class="nav-number">9.</span> <span class="nav-text">5.14（2）sort</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#5-14%EF%BC%883%EF%BC%89transaction-and-ACID%EF%BC%88%E4%BA%8B%E5%8A%A1%E5%92%8CACID%E7%89%B9%E6%80%A7%EF%BC%89"><span class="nav-number">10.</span> <span class="nav-text">5.14（3）transaction and ACID（事务和ACID特性）</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#5-15%EF%BC%88%E6%9C%80%E5%90%8E%E4%B8%80%E6%AC%A1%E8%AF%BE%EF%BC%8912-concurrency-control%E5%B9%B6%E5%8F%91%E6%8E%A7%E5%88%B6"><span class="nav-number">11.</span> <span class="nav-text">5.15（最后一次课）12.concurrency control并发控制</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#assignment-3%E5%89%8D%E7%BD%AE%E7%BB%83%E4%B9%A0%EF%BC%9AB-%E6%A0%91"><span class="nav-number">12.</span> <span class="nav-text">assignment 3前置练习：B+树</span></a></li></ol></div>
        </div>
        <!--/noindex-->

        <div class="site-overview-wrap sidebar-panel">
          <div class="site-author animated" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="Viny Yang"
      src="/images/avatar.png">
  <p class="site-author-name" itemprop="name">Viny Yang</p>
  <div class="site-description" itemprop="description">陌上花开，可缓缓归矣</div>
</div>
<div class="site-state-wrap animated">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
        <a href="/archives/">
          <span class="site-state-item-count">9</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
          <a href="/categories/">
        <span class="site-state-item-count">4</span>
        <span class="site-state-item-name">分类</span></a>
      </div>
      <div class="site-state-item site-state-tags">
          <a href="/tags/">
        <span class="site-state-item-count">5</span>
        <span class="site-state-item-name">标签</span></a>
      </div>
  </nav>
</div>
  <div class="links-of-author animated">
      <span class="links-of-author-item">
        <a href="https://github.com/VinyYang" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;VinyYang" rel="noopener me" target="_blank"><i class="fab fa-github fa-fw"></i>GitHub</a>
      </span>
      <span class="links-of-author-item">
        <a href="/images/email.png" title="E-Mail → &#x2F;images&#x2F;email.png" rel="noopener me"><i class="fa fa-envelope fa-fw"></i>E-Mail</a>
      </span>
      <span class="links-of-author-item">
        <a href="/images/wechat.png" title="Wechat → &#x2F;images&#x2F;wechat.png" rel="noopener me"><i class="fab fa-weixin fa-fw"></i>Wechat</a>
      </span>
      <span class="links-of-author-item">
        <a href="/images/qq.png" title="QQ → &#x2F;images&#x2F;qq.png" rel="noopener me"><i class="fab fa-qq fa-fw"></i>QQ</a>
      </span>
  </div>
  <div class="cc-license animated" itemprop="license">
    <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" class="cc-opacity" rel="noopener" target="_blank"><img src="https://cdnjs.cloudflare.com/ajax/libs/creativecommons-vocabulary/2020.11.3/assets/license_badges/small/by_nc_sa.svg" alt="Creative Commons"></a>
  </div>

        </div>
      </div>
        <div class="back-to-top animated" role="button" aria-label="返回顶部">
          <i class="fa fa-arrow-up"></i>
          <span>0%</span>
        </div>
    </div>

    
    <div class="sidebar-inner sidebar-blogroll">
      <div class="links-of-blogroll animated">
        <div class="links-of-blogroll-title"><i class="fa fa-globe fa-fw"></i>
          链接
        </div>
        <ul class="links-of-blogroll-list">
            <li class="links-of-blogroll-item">
              <a href="https://zhuanlan.zhihu.com/p/618864711" title="https:&#x2F;&#x2F;zhuanlan.zhihu.com&#x2F;p&#x2F;618864711" rel="noopener" target="_blank">配置主题</a>
            </li>
            <li class="links-of-blogroll-item">
              <a href="https://zhuanlan.zhihu.com/p/671308695" title="https:&#x2F;&#x2F;zhuanlan.zhihu.com&#x2F;p&#x2F;671308695" rel="noopener" target="_blank">重新部署</a>
            </li>
            <li class="links-of-blogroll-item">
              <a href="https://copilot.github.com/" title="https:&#x2F;&#x2F;copilot.github.com&#x2F;" rel="noopener" target="_blank">Copilot</a>
            </li>
            <li class="links-of-blogroll-item">
              <a href="https://chat.deepseek.com/" title="https:&#x2F;&#x2F;chat.deepseek.com&#x2F;" rel="noopener" target="_blank">DeepSeek</a>
            </li>
            <li class="links-of-blogroll-item">
              <a href="https://chatgpt.com/" title="https:&#x2F;&#x2F;chatgpt.com&#x2F;" rel="noopener" target="_blank">ChatGPT</a>
            </li>
        </ul>
      </div>
    </div>
  </aside>


    </div>

    <div class="main-inner post posts-expand">


  


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://vinyyang.github.io/%E6%95%B0%E6%8D%AE%E5%BA%93%E5%8E%9F%E7%90%86%E4%B8%8E%E5%BA%94%E7%94%A8%EF%BC%88%E5%A4%96%E6%95%99%E7%89%88%EF%BC%89/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.png">
      <meta itemprop="name" content="Viny Yang">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Viny与CS的邂逅">
      <meta itemprop="description" content="陌上花开，可缓缓归矣">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="数据库原理与应用（外教版） | Viny与CS的邂逅">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          数据库原理与应用（外教版）
        </h1>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2025-04-22 08:05:21" itemprop="dateCreated datePublished" datetime="2025-04-22T08:05:21+08:00">2025-04-22</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">更新于</span>
      <time title="修改时间：2025-06-14 01:07:50" itemprop="dateModified" datetime="2025-06-14T01:07:50+08:00">2025-06-14</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/%E5%AD%A6%E4%B9%A0/" itemprop="url" rel="index"><span itemprop="name">学习</span></a>
        </span>
    </span>

  
    <span class="post-meta-item" title="阅读次数" id="busuanzi_container_page_pv">
      <span class="post-meta-item-icon">
        <i class="far fa-eye"></i>
      </span>
      <span class="post-meta-item-text">阅读次数：</span>
      <span id="busuanzi_value_page_pv"></span>
    </span>

    <span class="post-meta-break"></span>
    <span class="post-meta-item" title="本文字数">
      <span class="post-meta-item-icon">
        <i class="far fa-file-word"></i>
      </span>
      <span class="post-meta-item-text">本文字数：</span>
      <span>73k</span>
    </span>
    <span class="post-meta-item" title="阅读时长">
      <span class="post-meta-item-icon">
        <i class="far fa-clock"></i>
      </span>
      <span class="post-meta-item-text">阅读时长 &asymp;</span>
      <span>2:12</span>
    </span>
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody"><p>数据库原理与应用（外教版）</p>
<h2 id="4-22">4.22</h2>
<p>1.主码（primary key）：</p>
<p>主码也称为主键，是表中的一个或多个字段（列）的组合，其值能够唯一地标识表中的每一行记录，即表中的任意两条记录的主码值都不相同，并且主码不允许包含空值（NULL）。</p>
<p>例如，在一个 <code>Students</code> 表中，包含 <code>StudentID</code>（学生编号）、<code>Name</code>（姓名）、<code>Age</code>（年龄）等字段，<code>StudentID</code> 就可以设置为主码。因为每个学生的编号都是唯一的，通过 <code>StudentID</code> 能够准确地确定每一个学生的记录。</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">create table</span> Students(</span><br><span class="line">    StudentID <span class="type">int</span> <span class="keyword">primary key</span>,</span><br><span class="line">    Name <span class="type">varchar</span>(<span class="number">50</span>),</span><br><span class="line">    Age <span class="type">int</span></span><br><span class="line">);</span><br></pre></td></tr></table></figure>
<p>主码的作用主要有：</p>
<ul>
<li><strong>保证数据的唯一性</strong>：确保表中的每一行数据都是独一无二的，避免出现重复记录。</li>
<li><strong>作为表的唯一标识</strong>：方便在数据库操作中（如查询、更新、删除等）准确地定位和操作特定的记录。</li>
<li><strong>建立表之间的联系</strong>：与其他表的外码配合，建立表之间的关联关系。</li>
</ul>
<p>2.外码（foreign key）：</p>
<p>外码也叫外键，是一个表中的一个或多个字段（列），它的值与另一个表（称为主表或父表）的主码或候选码相对应。外码用于建立两个表之间的关联关系，通过外码可以实现数据的参照完整性。</p>
<p>例如，有一个 <code>Orders</code> 表，包含 <code>OrderID</code>（订单编号）、<code>CustomerID</code>（客户编号）、<code>OrderDate</code>（订单日期）等字段，同时有一个 <code>Customers</code> 表，包含 <code>CustomerID</code>（客户编号）、<code>CustomerName</code>（客户姓名）等字段。在 <code>Orders</code> 表中的 <code>CustomerID</code> 就可以设置为外码，它参照了 <code>Customers</code> 表中的 <code>CustomerID</code> 主码。</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">create table</span> Customers(</span><br><span class="line">    CustomerID <span class="type">int</span> <span class="keyword">primary key</span>,</span><br><span class="line">    CustomerName <span class="type">varchar</span>(<span class="number">50</span>)</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"><span class="keyword">create table</span> Orders(</span><br><span class="line">    OrderID <span class="type">int</span> <span class="keyword">primary key</span>,</span><br><span class="line">    customerID <span class="type">int</span>,</span><br><span class="line">    Orderdate <span class="type">date</span>,</span><br><span class="line">    <span class="keyword">foreign key</span> (CustomerID) <span class="keyword">references</span> Customers(CustomerID)</span><br><span class="line">);</span><br></pre></td></tr></table></figure>
<p>外码的作用主要有：</p>
<ul>
<li><strong>建立表间关系</strong>：明确地表示出两个表之间的关联，使得数据库中的数据能够更好地组织和管理。</li>
<li><strong>保证数据的一致性和完整性</strong>：当对主表中的主码进行修改或删除操作时，数据库管理系统会根据外码约束规则进行相应的处理，以确保相关表中的数据保持一致。例如，当删除 <code>Customers</code> 表中一个客户的记录时，如果 <code>Orders</code> 表中有该客户的订单记录，根据外码约束的设置（如级联删除、拒绝删除等），可以保证数据的完整性不被破坏。</li>
</ul>
<p>3.关系代数</p>
<p>（1）选择select（$\sigma_F(R)$）</p>
<p>选择操作是从关系中挑选出满足给定条件的元组。设 R 为一个关系，F 是一个条件表达式，那么选择操作可表示为$ \sigma_{F}(R)$。</p>
<p>示例：假设存在一个关系 <code>Students</code>，包含字段 <code>StudentID</code>、<code>Name</code>、<code>Age</code>。若要挑选出年龄大于 20 的学生，操作如下：</p>
<p><code>-- SQL 示例 </code></p>
<p><code>SELECT * FROM Students WHERE Age &gt; 20;</code></p>
<p>在关系代数里，可表示成$ \sigma_{Age &gt; 20}(Students)$。</p>
<p>（2）投影projection（ $\pi_{A_1, A_2, \cdots, A_n}(R)$）</p>
<p>投影操作是从关系里选取特定的属性列，并且去除重复的元组。设$ R $为一个关系，$A_1, A_2, \cdots, A_n$是 R 的属性，那么投影操作可表示为 $\pi_{A_1, A_2, \cdots, A_n}(R)$。</p>
<p>示例：还是以 <code>Students</code> 关系为例，若要获取所有学生的姓名和学号，操作如下：</p>
<p><code>-- SQL 示例 </code></p>
<p><code>SELECT StudentID, Name FROM Students;</code></p>
<p>在关系代数里，可表示成 $\pi_{StudentID, Name}(Students)$。</p>
<p>（3）连接union（$R \cup S$）</p>
<p>并操作要求参与运算的两个关系 R 和 S 具有相同的属性列，并且属性的域也相同。它会把两个关系的元组合并，同时去除重复的元组。</p>
<p>示例：假设有两个关系 <code>ClassA</code> 和 <code>ClassB</code>，它们的结构一样，都包含 <code>StudentID</code> 和 <code>Name</code> 字段。若要把两个班级的学生信息合并，操作如下：</p>
<p><code>-- SQL 示例 </code></p>
<p><code>SELECT * FROM ClassA UNION SELECT * FROM ClassB;</code></p>
<p>在关系代数里，可表示成 $ClassA \cup ClassB$。</p>
<p>（4）内连接intersect($R\cap S$)</p>
<p>交操作同样要求参与运算的两个关系 R 和 S 具有相同的属性列，并且属性的域也相同。它会返回两个关系中相同的元组。</p>
<p>示例：对于 <code>ClassA</code> 和 <code>ClassB</code> 关系，若要找出同时在两个班级的学生，操作如下：</p>
<p><code>-- SQL 示例 </code></p>
<p><code>SELECT * FROM ClassA INTERSECT SELECT * FROM ClassB;</code></p>
<p>在关系代数里，可表示成$ClassA \cap ClassB$。</p>
<p>（5）差difference（$R-S$）</p>
<p>差操作要求参与运算的两个关系 R 和 S 具有相同的属性列，并且属性的域也相同。它会返回在关系 R 中但不在关系 S 中的元组。</p>
<p>示例：对于 <code>ClassA</code> 和 <code>ClassB</code> 关系，若要找出只在 <code>ClassA</code> 而不在 <code>ClassB</code> 的学生，操作如下：</p>
<p><code>-- SQL 示例 </code></p>
<p><code>SELECT * FROM ClassA EXCEPT SELECT * FROM ClassB;</code></p>
<p>在关系代数里，可表示成 $ClassA - ClassB$。</p>
<p>（6）笛卡尔积product（$R\times S$）</p>
<p>笛卡尔积操作会把关系 R 中的每个元组和关系 S 中的每个元组进行组合，形成一个新的关系。新关系的属性列是 R 和 S 的属性列的并集。</p>
<p>示例：假设存在关系 <code>Employees</code>（包含 <code>EmployeeID</code>、<code>EmployeeName</code>）和 <code>Departments</code>（包含 <code>DepartmentID</code>、<code>DepartmentName</code>），若要得到员工和部门的所有可能组合，操作如下：</p>
<p><code>-- SQL 示例 </code></p>
<p><code>SELECT * FROM Employees, Departments;</code></p>
<p>在关系代数里，可表示成$Employees \times Departments$。</p>
<p>（7）连接join（$R \bowtie S$）</p>
<p>连接操作是从两个关系的笛卡尔积中选取满足一定条件的元组。常见的连接类型有等值连接、自然连接等。</p>
<p>等值连接</p>
<p>等值连接是在笛卡尔积的基础上，选取两个关系中指定属性相等的元组。设 R 和 S 是两个关系，A 是 R 的属性，B 是 S 的属性，等值连接可表示为$R \bowtie_{A = B} S$。</p>
<p>示例：假设有关系 <code>Orders</code>（包含 <code>OrderID</code>、<code>CustomerID</code>）和 <code>Customers</code>（包含 <code>CustomerID</code>、<code>CustomerName</code>），若要获取订单及其对应的客户信息，操作如下：</p>
<p><code>-- SQL 示例 </code></p>
<p><code>SELECT * FROM Orders </code></p>
<p><code>JOIN Customers ON Orders.CustomerID = Customers.CustomerID;</code></p>
<p>在关系代数里，可表示成</p>
<p>$Orders \bowtie_{Orders.CustomerID = Customers.CustomerID} Customers$。</p>
<p>自然连接</p>
<p>自然连接是一种特殊的等值连接，它会自动选取两个关系中相同名称的属性进行等值比较，并且去除重复的属性列。</p>
<p>示例：对于上述的 <code>Orders</code> 和 <code>Customers</code> 关系，使用自然连接获取订单及其对应的客户信息，操作如下：</p>
<p><code>-- SQL 示例 </code></p>
<p><code>SELECT * FROM Orders NATURAL JOIN Customers;</code></p>
<p>在关系代数里，可表示成 $Orders \bowtie Customers$ 。</p>
<p>4.SQL Query</p>
<p>SQL 查询是用来从数据库里获取数据的语句。一个基本的 SQL 查询包含 <code>SELECT</code>、<code>FROM</code> 和 <code>WHERE</code> 子句。</p>
<p>5.Doucument Data Model（NOSQL）</p>
<p>文档数据模型是 NoSQL 数据库里常见的数据模型，数据以文档的形式存储，通常是 JSON、BSON 或者 XML 格式。文档数据库中的文档可以包含嵌套结构，并且不同文档的结构可以不同。</p>
<p>6.Vector Data Model/Mechine Learning Model</p>
<p>向量数据模型是把数据表示成向量的形式，常用于机器学习、信息检索等领域。例如，在文本处理中，可以把文档或者单词表示成向量，通过向量之间的相似度来衡量文档或者单词之间的相关性。</p>
<p>7.SQL简介:</p>
<p>major commands(e.g. select update delete insert);DML,DDL,TCL,DCL</p>
<ul>
<li><strong>SELECT</strong>：从数据库中选取数据。</li>
</ul>
<p><code>select * from Employees;</code></p>
<ul>
<li><strong>UPDATE</strong>：更新数据库中的数据。</li>
</ul>
<p><code>update empolyees set Salary=6000 where EmployeeID=1;</code></p>
<ul>
<li><strong>DELETE</strong>：从数据库中删除数据。</li>
</ul>
<p><code>delete from Employees where EmployeeID=1;</code></p>
<ul>
<li><strong>INSERT</strong>：向数据库中插入新的数据。</li>
</ul>
<p><code>insert into Employees(EmployeeID,Name,Salary) values(2,'Bob',5500); </code></p>
<ul>
<li>数据操作语言<strong>Data Manipulation Language</strong>（DML）</li>
</ul>
<p>DML 用于操作数据库中的数据，主要包括 <code>SELECT</code>、<code>INSERT</code>、<code>UPDATE</code> 和 <code>DELETE</code> 语句。</p>
<ul>
<li>数据定义语言<strong>Data Definition Language</strong>（DDL）</li>
</ul>
<p>DDL 用于定义数据库的结构，例如创建、修改和删除数据库对象（如表、视图、索引等）。常见的 DDL 语句有 <code>CREATE</code>、<code>ALTER</code> 和 <code>DROP</code>。</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 创建一个新的表</span></span><br><span class="line"><span class="keyword">CREATE TABLE</span> Employees (</span><br><span class="line">    EmployeeID <span class="type">INT</span> <span class="keyword">PRIMARY KEY</span>,</span><br><span class="line">    Name <span class="type">VARCHAR</span>(<span class="number">50</span>),</span><br><span class="line">    Salary <span class="type">DECIMAL</span>(<span class="number">10</span>, <span class="number">2</span>)</span><br><span class="line">);</span><br></pre></td></tr></table></figure>
<ul>
<li>事务控制语言<strong>Transaction Control Language</strong>（TCL）</li>
</ul>
<p>TCL 用于管理数据库中的事务，例如提交事务、回滚事务等。常见的 TCL 语句有 <code>COMMIT</code>、<code>ROLLBACK</code> 和 <code>SAVEPOINT</code>。</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">start</span> transaction;</span><br><span class="line"><span class="keyword">update</span> Employees <span class="keyword">set</span> Salary<span class="operator">=</span><span class="number">6000</span> <span class="keyword">where</span> EmployeeID<span class="operator">=</span><span class="number">1</span>;</span><br><span class="line"><span class="keyword">commit</span>;</span><br></pre></td></tr></table></figure>
<ul>
<li>数据控制语言<strong>Data Control Language</strong>（DCL）</li>
</ul>
<p>DCL 用于控制用户对数据库对象的访问权限，例如授予和撤销权限。常见的 DCL 语句有 <code>GRANT</code> 和 <code>REVOKE</code>。</p>
<p><code>grant select on Employees to 'user'@'localhost'</code></p>
<p>8.Select Syntax</p>
<p>（1）distinct</p>
<p><code>DISTINCT</code> 关键字用于去除查询结果中的重复行。</p>
<p><code>select distinct Department from Employees;</code></p>
<p><img src="/%E6%95%B0%E6%8D%AE%E5%BA%93%E5%8E%9F%E7%90%86%E4%B8%8E%E5%BA%94%E7%94%A8%EF%BC%88%E5%A4%96%E6%95%99%E7%89%88%EF%BC%89/image-20250422103948934.png" alt="image-20250422103948934"></p>
<p><img src="/%E6%95%B0%E6%8D%AE%E5%BA%93%E5%8E%9F%E7%90%86%E4%B8%8E%E5%BA%94%E7%94%A8%EF%BC%88%E5%A4%96%E6%95%99%E7%89%88%EF%BC%89/image-20250422103959905.png" alt="image-20250422103959905"></p>
<p>（2）where操作对应有and/or/not，like，is null/is not null等operator操作（is for filtering records）</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> Employees <span class="keyword">where</span> Salary<span class="operator">&gt;</span><span class="number">5000</span> <span class="keyword">and</span> Department<span class="operator">=</span><span class="string">&#x27;IT&#x27;</span>;</span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> Employees <span class="keyword">where</span> Name <span class="keyword">like</span> <span class="string">&#x27;A%&#x27;</span>;</span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> Employees <span class="keyword">where</span> ManagerID <span class="keyword">is</span> <span class="keyword">null</span>;</span><br></pre></td></tr></table></figure>
<p><code>select * from Employees where Name like 'A%';</code></p>
<p>这条语句使用了 <code>LIKE</code> 操作符，用于从 <code>Employees</code> 表中筛选出 <code>Name</code> 列以字母 <code>A</code> 开头的所有记录。<code>LIKE</code> 操作符是用于模糊匹配的，<code>%</code> 是通配符，表示任意数量（包括零个）的任意字符。</p>
<p><img src="/%E6%95%B0%E6%8D%AE%E5%BA%93%E5%8E%9F%E7%90%86%E4%B8%8E%E5%BA%94%E7%94%A8%EF%BC%88%E5%A4%96%E6%95%99%E7%89%88%EF%BC%89/image-20250422104145155.png" alt="image-20250422104145155"></p>
<p><code>SELECT * FROM Employees WHERE ManagerID IS NULL;</code></p>
<p>这条语句使用了 <code>IS NULL</code> 操作符，用于从 <code>Employees</code> 表中筛选出 <code>ManagerID</code> 列为 <code>NULL</code> 的所有记录。<code>IS NULL</code> 用于判断某列的值是否为 <code>NULL</code>。</p>
<p><img src="/%E6%95%B0%E6%8D%AE%E5%BA%93%E5%8E%9F%E7%90%86%E4%B8%8E%E5%BA%94%E7%94%A8%EF%BC%88%E5%A4%96%E6%95%99%E7%89%88%EF%BC%89/image-20250422104233490.png" alt="image-20250422104233490"></p>
<p>（3）分组group by</p>
<p><code>GROUP BY</code> 子句用于对查询结果进行分组，通常与聚合函数（如 <code>SUM</code>、<code>AVG</code>、<code>COUNT</code> 等）一起使用。</p>
<p><code>select Department,count(*) from Employees group by Department;</code></p>
<p>（4）having(is for filtering aggregated results)</p>
<p><code>HAVING</code> 子句用于过滤分组后的结果，与 <code>WHERE</code> 子句不同的是，<code>HAVING</code> 子句可以使用聚合函数。</p>
<p><code>select Department,AVG(Salary) from Employees group by Department having AVG(Salary)&gt;5000</code></p>
<p>（5）order by</p>
<p><code>ORDER BY</code> 子句用于对查询结果进行排序，可以按升序（<code>ASC</code>）或降序（<code>DESC</code>）排列。</p>
<p><code>select * from Employees order by Salary desc;</code></p>
<p>（6）limit（select top）</p>
<p><code>LIMIT</code> 关键字（在 MySQL 中）或 <code>SELECT TOP</code> 关键字（在 SQL Server 中）用于限制查询结果的行数。</p>
<p><code>select * from Employees limit 10;</code></p>
<p>（7）Alias（AS）</p>
<p><code>AS</code> 关键字用于为列或表指定别名，使查询结果更易读。</p>
<p><code>select Name as EmployName,Salary as AnnualSalary from Employees;</code></p>
<p>（8）join：</p>
<p>（inner）join（also a inner join）：returns records that have matching values in both tables，left（outer）join，right（outer）join，full（outer）join，cross join</p>
<p>①inner join</p>
<p><code>INNER JOIN</code> 也被称为简单的 <code>JOIN</code>，它返回两个表中在连接条件上具有匹配值的记录。只有当两个表中指定列的值相等时，对应的行才会被包含在结果集中。</p>
<p><img src="/%E6%95%B0%E6%8D%AE%E5%BA%93%E5%8E%9F%E7%90%86%E4%B8%8E%E5%BA%94%E7%94%A8%EF%BC%88%E5%A4%96%E6%95%99%E7%89%88%EF%BC%89/image-20250423142752778.png" alt="image-20250423142752778"></p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 执行 INNER JOIN 查询</span></span><br><span class="line"><span class="keyword">SELECT</span> Employees.EmployeeName, Departments.DepartmentName</span><br><span class="line"><span class="keyword">FROM</span> Employees</span><br><span class="line"><span class="keyword">INNER</span> <span class="keyword">JOIN</span> Departments <span class="keyword">ON</span> Employees.DepartmentID <span class="operator">=</span> Departments.DepartmentID;</span><br></pre></td></tr></table></figure>
<p><img src="/%E6%95%B0%E6%8D%AE%E5%BA%93%E5%8E%9F%E7%90%86%E4%B8%8E%E5%BA%94%E7%94%A8%EF%BC%88%E5%A4%96%E6%95%99%E7%89%88%EF%BC%89/image-20250423142907232-1745389748192-1.png" alt="image-20250423142907232"></p>
<p>②left（outer） join（就是保证左表信息全部出来）</p>
<p><code>LEFT JOIN</code> 会返回左表（<code>FROM</code> 子句中第一个指定的表）中的所有记录，以及右表中匹配的记录。如果右表中没有与左表记录匹配的行，则右表的列值将显示为 <code>NULL</code>。</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 执行 LEFT JOIN 查询</span></span><br><span class="line"><span class="keyword">SELECT</span> Employees.EmployeeName, Departments.DepartmentName</span><br><span class="line"><span class="keyword">FROM</span> Employees</span><br><span class="line"><span class="keyword">LEFT</span> <span class="keyword">JOIN</span> Departments <span class="keyword">ON</span> Employees.DepartmentID <span class="operator">=</span> Departments.DepartmentID;</span><br></pre></td></tr></table></figure>
<p>③right join</p>
<p>RIGHT JOIN 与 LEFT JOIN 相反，它返回右表中的所有记录，以及左表中匹配的记录。如果左表中没有与右表记录匹配的行，则左表的列值将显示为 NULL。</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 执行 RIGHT JOIN 查询</span></span><br><span class="line"><span class="keyword">SELECT</span> Employees.EmployeeName, Departments.DepartmentName</span><br><span class="line"><span class="keyword">FROM</span> Employees</span><br><span class="line"><span class="keyword">RIGHT</span> <span class="keyword">JOIN</span> Departments <span class="keyword">ON</span> Employees.DepartmentID <span class="operator">=</span> Departments.DepartmentID;</span><br></pre></td></tr></table></figure>
<p><img src="/%E6%95%B0%E6%8D%AE%E5%BA%93%E5%8E%9F%E7%90%86%E4%B8%8E%E5%BA%94%E7%94%A8%EF%BC%88%E5%A4%96%E6%95%99%E7%89%88%EF%BC%89/image-20250423143114397.png" alt="image-20250423143114397"></p>
<p>④full join</p>
<p><code>FULL JOIN</code> 返回两个表中的所有记录。如果某一行在另一个表中没有匹配项，则对应的列将显示为 <code>NULL</code>。在 MySQL 中不直接支持 <code>FULL JOIN</code>，但可以使用 <code>UNION</code> 操作来模拟。</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- MySQL 模拟 FULL JOIN</span></span><br><span class="line"><span class="keyword">SELECT</span> Employees.EmployeeName, Departments.DepartmentName</span><br><span class="line"><span class="keyword">FROM</span> Employees</span><br><span class="line"><span class="keyword">LEFT</span> <span class="keyword">JOIN</span> Departments <span class="keyword">ON</span> Employees.DepartmentID <span class="operator">=</span> Departments.DepartmentID</span><br><span class="line"><span class="keyword">UNION</span></span><br><span class="line"><span class="keyword">SELECT</span> Employees.EmployeeName, Departments.DepartmentName</span><br><span class="line"><span class="keyword">FROM</span> Employees</span><br><span class="line"><span class="keyword">RIGHT</span> <span class="keyword">JOIN</span> Departments <span class="keyword">ON</span> Employees.DepartmentID <span class="operator">=</span> Departments.DepartmentID;</span><br></pre></td></tr></table></figure>
<p><img src="/%E6%95%B0%E6%8D%AE%E5%BA%93%E5%8E%9F%E7%90%86%E4%B8%8E%E5%BA%94%E7%94%A8%EF%BC%88%E5%A4%96%E6%95%99%E7%89%88%EF%BC%89/image-20250423143220424.png" alt="image-20250423143220424"></p>
<p>⑤cross join</p>
<p><code>CROSS JOIN</code> 会生成两个表的笛卡尔积，即左表中的每一行都会与右表中的每一行组合，结果集的行数为左表行数乘以右表行数。</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 执行 CROSS JOIN 查询</span></span><br><span class="line"><span class="keyword">SELECT</span> Employees.EmployeeName, Departments.DepartmentName</span><br><span class="line"><span class="keyword">FROM</span> Employees</span><br><span class="line"><span class="keyword">CROSS</span> <span class="keyword">JOIN</span> Departments;</span><br></pre></td></tr></table></figure>
<p><img src="/%E6%95%B0%E6%8D%AE%E5%BA%93%E5%8E%9F%E7%90%86%E4%B8%8E%E5%BA%94%E7%94%A8%EF%BC%88%E5%A4%96%E6%95%99%E7%89%88%EF%BC%89/image-20250423143414571.png" alt="image-20250423143414571"></p>
<blockquote>
<p><mark>不同 JOIN 操作显示信息的说明</mark></p>
<p>在前面的 <code>JOIN</code> 查询示例里，<code>EmployeeID</code> 和 <code>DepartmentID</code> 没有显示，是因为在 <code>SELECT</code> 子句中仅指定了 <code>EmployeeName</code> 和 <code>DepartmentName</code> 这两列。<code>SELECT</code> 子句的作用是明确要从查询结果里获取哪些列，要是没有在 <code>SELECT</code> 子句中列出某列，那该列就不会出现在最终的查询结果中。</p>
<p>不同的 <code>JOIN</code> 操作（如 <code>INNER JOIN</code>、<code>LEFT JOIN</code>、<code>RIGHT JOIN</code>、<code>FULL JOIN</code>、<code>CROSS JOIN</code>）本身并不决定显示哪些信息，显示的信息完全由 <code>SELECT</code> 子句来决定。下面是修改后的示例，把 <code>EmployeeID</code> 和 <code>DepartmentID</code> 也包含在 <code>SELECT</code> 子句中。</p>
</blockquote>
<h2 id="4-23">4.23</h2>
<p>1.procedure（存储过程）</p>
<p>存储过程是一组为了完成特定功能的 SQL 语句集，经编译后存储在数据库中。用户通过指定存储过程的名字并给出参数（如果该存储过程带有参数）来执行它。</p>
<p>2.case（if-else）</p>
<p><code>CASE</code> 语句用于在 SQL 中实现条件逻辑，类似于其他编程语言中的 <code>if - else</code> 语句。</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 根据员工的薪水给出不同的评价</span></span><br><span class="line"><span class="keyword">select</span></span><br><span class="line">	EmployeeName,</span><br><span class="line">	Salary,</span><br><span class="line">	<span class="keyword">case</span></span><br><span class="line">		<span class="keyword">when</span> Salary<span class="operator">&gt;</span><span class="number">5000</span> <span class="keyword">then</span> &quot;High Salary&quot;</span><br><span class="line">		<span class="keyword">when</span> Salary<span class="operator">&gt;</span><span class="number">3000</span> <span class="keyword">then</span> &quot;Medium Salary&quot;</span><br><span class="line">		<span class="keyword">Else</span> &quot;Low Salary&quot;</span><br><span class="line">	<span class="keyword">end</span> <span class="keyword">as</span> SalaryGrade</span><br><span class="line"><span class="keyword">from</span> Employees;</span><br></pre></td></tr></table></figure>
<p>3.nested query（sub query）</p>
<p>子查询是指在一个 SQL 查询中嵌套另一个查询。子查询可以出现在 <code>SELECT</code>、<code>FROM</code>、<code>WHERE</code> 等子句中。</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 查询薪水高于平均薪水的员工</span></span><br><span class="line"><span class="keyword">select</span> EmployeeName,Salary</span><br><span class="line"><span class="keyword">from</span> Employees</span><br><span class="line"><span class="keyword">where</span> Salary<span class="operator">&gt;</span>(<span class="keyword">select</span> <span class="built_in">avg</span>(Salary) <span class="keyword">from</span> Employees);</span><br></pre></td></tr></table></figure>
<p>4.exists</p>
<p><code>EXISTS</code> 是一个布尔运算符，用于检查子查询是否返回任何行。如果子查询返回至少一行，则 <code>EXISTS</code> 返回 <code>TRUE</code>，否则返回 <code>FALSE</code>。</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> CustomerName</span><br><span class="line"><span class="keyword">from</span> Customers</span><br><span class="line"><span class="keyword">where</span> <span class="keyword">exists</span>(<span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> Orders <span class="keyword">where</span> Orders.CustomerID<span class="operator">=</span>Customers.CustomerID);</span><br></pre></td></tr></table></figure>
<p>5.in</p>
<p><code>IN</code> 运算符用于指定多个可能的值，用于在 <code>WHERE</code> 子句中筛选出符合这些值的记录。</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 查询部门 ID 为 1 或 2 的员工</span></span><br><span class="line"><span class="keyword">select</span> EmployeeName</span><br><span class="line"><span class="keyword">from</span> Employees</span><br><span class="line"><span class="keyword">where</span> DepartmentID <span class="keyword">in</span>(<span class="number">1</span>,<span class="number">2</span>);</span><br></pre></td></tr></table></figure>
<p>6.insert into</p>
<p><code>INSERT INTO</code> 语句用于向表中插入新记录。</p>
<p><code>insert into Employees(EmployeeName,DepartmentID) values ('Eve','2');</code></p>
<p>7.update</p>
<p><code>UPDATE</code> 语句用于修改表中的现有记录。</p>
<p><code>update set where</code></p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">update</span> Customers</span><br><span class="line"><span class="keyword">set</span> ContactName<span class="operator">=</span><span class="string">&#x27;Juan&#x27;</span></span><br><span class="line"><span class="keyword">where</span> Country<span class="operator">=</span><span class="string">&#x27;Mexico&#x27;</span>;</span><br></pre></td></tr></table></figure>
<p>8.delete</p>
<p><code>DELETE</code> 语句用于从表中删除记录。</p>
<p><code>delete from Employees where DepartmentID=3;</code></p>
<p>DML has ended</p>
<hr>
<p>9.DDL（数据定义语言） review</p>
<p>DDL 用于定义数据库的结构和对象，常见的 DDL 语句有 <code>CREATE</code>、<code>ALTER</code> 和 <code>DROP</code>。</p>
<p>10.numeric data types（数值数据类型）</p>
<p>（1）int or integer</p>
<p>用于存储整数，通常占用 4 个字节，范围根据数据库系统略有不同。</p>
<p>（2）smallint</p>
<p>用于存储较小的整数，通常占用 2 个字节，范围比 <code>int</code> 小。</p>
<p>（3）decimal（p，s）</p>
<p>用于存储精确的小数，<code>p</code> 表示精度（总位数），<code>s</code> 表示小数位数。</p>
<p>（4）float</p>
<p>用于存储单精度浮点数，通常占用 4 个字节，精度有限。</p>
<p>（5）double</p>
<p>用于存储双精度浮点数，通常占用 8 个字节，精度比 <code>float</code> 高。</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 创建一个包含不同数值类型的表</span></span><br><span class="line"><span class="keyword">CREATE TABLE</span> NumericTable (</span><br><span class="line">    IntColumn <span class="type">INT</span>,</span><br><span class="line">    SmallIntColumn <span class="type">SMALLINT</span>,</span><br><span class="line">    DecimalColumn <span class="type">DECIMAL</span>(<span class="number">5</span>, <span class="number">2</span>),</span><br><span class="line">    FloatColumn <span class="type">FLOAT</span>,</span><br><span class="line">    DoubleColumn <span class="keyword">DOUBLE</span></span><br><span class="line">);</span><br></pre></td></tr></table></figure>
<p>11.text data type（文本数据类型）</p>
<p>（1）char（n）</p>
<p>用于存储固定长度的字符串，<code>n</code> 表示字符串的长度。如果存储的字符串长度小于 <code>n</code>，则会用空格填充。</p>
<p>（2）varchar（n）</p>
<p>用于存储可变长度的字符串，<code>n</code> 表示字符串的最大长度。只占用实际存储的字符串长度的空间。</p>
<p>（3）text</p>
<p>用于存储大量的文本数据，长度没有固定限制。</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">create table</span> TextTable(</span><br><span class="line">    CharColumn <span class="type">char</span>(<span class="number">10</span>),</span><br><span class="line">    VarcharColumn <span class="type">varchar</span>(<span class="number">50</span>),</span><br><span class="line">    TextColumn text</span><br><span class="line">);</span><br></pre></td></tr></table></figure>
<p>12.constraints</p>
<p>（1）not null</p>
<p>确保列中不允许存储 <code>NULL</code> 值。</p>
<p>（2）unique</p>
<p>确保列中的值是唯一的。</p>
<p>（3）default</p>
<p>为列指定默认值，如果插入记录时没有提供该列的值，则使用默认值。</p>
<p>（4）check</p>
<p>用于限制列中的值必须满足指定的条件。</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 创建一个包含约束的表</span></span><br><span class="line"><span class="keyword">create table</span> ConstraintTable(</span><br><span class="line">    ID <span class="type">int</span> <span class="keyword">primary key</span>,</span><br><span class="line">    Name <span class="type">varchar</span>(<span class="number">50</span>) <span class="keyword">not null</span>,</span><br><span class="line">    Email <span class="type">varchar</span>(<span class="number">100</span>)<span class="keyword">unique</span>,</span><br><span class="line">    Age <span class="type">int</span> <span class="keyword">default</span> <span class="number">18</span>,</span><br><span class="line">    Salary <span class="type">decimal</span>(<span class="number">10</span>,<span class="number">2</span>) <span class="keyword">check</span>(Salary<span class="operator">&gt;</span><span class="number">0</span>)</span><br><span class="line">);</span><br></pre></td></tr></table></figure>
<p>13.auto increment</p>
<p><code>AUTO_INCREMENT</code> 用于为表中的某一列自动生成唯一的整数序列，通常用于主键列。</p>
<p><code>AUTO_INCREMENT</code> 是数据库中的一个重要特性，主要用于为表中的某一列自动生成唯一的整数序列，通常与主键列搭配使用。每当向表中插入一条新记录时，该列的值会自动递增。在 MySQL 里，一个表只能有一个 <code>AUTO_INCREMENT</code> 列，并且该列必须被定义为主键或者包含在一个唯一索引里。以下是创建带有 <code>AUTO_INCREMENT</code> 列的表的示例：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">create table</span> users(</span><br><span class="line">    id <span class="type">int</span> auto_increment <span class="keyword">primary key</span>,</span><br><span class="line">    name <span class="type">varchar</span>(<span class="number">50</span>),</span><br><span class="line">    email <span class="type">varchar</span>(<span class="number">100</span>)</span><br><span class="line">);</span><br></pre></td></tr></table></figure>
<p>14.foreign key straint（外键约束）</p>
<p>child table and parent table</p>
<p>外键约束用于在两个表之间建立关联，关联的表分别称为子表（child table）和父表（parent table）。父表包含主键列，子表包含引用父表主键的外键列。外键约束保证了数据的引用完整性，也就是子表中的外键值必须与父表中主键值相匹配，或者为 <code>NULL</code>。以下是创建带有外键约束的表的示例：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">--- 创建父表</span></span><br><span class="line"><span class="keyword">create table</span> departments(</span><br><span class="line">    dept_id <span class="type">int</span> <span class="keyword">primary key</span>,</span><br><span class="line">    dept_name <span class="type">varchar</span>(<span class="number">50</span>)</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"><span class="comment">--- 创建子表</span></span><br><span class="line"><span class="keyword">create table</span> employees(</span><br><span class="line">    emp_id <span class="type">int</span> <span class="keyword">primary key</span>,</span><br><span class="line">    emp_name <span class="type">varchar</span>(<span class="number">50</span>),</span><br><span class="line">    dept_id <span class="type">int</span>,</span><br><span class="line">    <span class="keyword">foreign key</span> (dept_id) <span class="keyword">references</span> departments(dept_id)</span><br><span class="line">);</span><br></pre></td></tr></table></figure>
<p>15.referential action（引用操作）</p>
<p>当父表中的记录被更新或者删除时，引用操作决定了子表中的相关记录要如何处理。常见的引用操作有以下几种：</p>
<p>（1）cascade（级联）</p>
<p>当父表中的记录被更新或者删除时，子表中所有引用该记录的外键值也会被相应地更新或者删除。示例如下：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">create table</span> employees(</span><br><span class="line">    emp_id <span class="type">int</span> <span class="keyword">primary key</span>,</span><br><span class="line">    emp_name <span class="type">varchar</span>(<span class="number">50</span>),</span><br><span class="line">    dept_id <span class="type">int</span>,</span><br><span class="line">    <span class="keyword">foreign key</span> (dept_id) <span class="keyword">references</span> departments(dept_id)</span><br><span class="line">    <span class="keyword">on</span> <span class="keyword">update</span> cascade</span><br><span class="line">    <span class="keyword">on</span> <span class="keyword">delete</span> cascade</span><br><span class="line">);</span><br></pre></td></tr></table></figure>
<p>（2）set null</p>
<p>当父表中的记录被更新或者删除时，子表中所有引用该记录的外键值会被设置为 <code>NULL</code>。不过，这要求外键列允许为 <code>NULL</code>。示例如下：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">create table</span> employees(</span><br><span class="line">    emp_id <span class="type">int</span> <span class="keyword">primary key</span>,</span><br><span class="line">    emp_name <span class="type">varchar</span>(<span class="number">50</span>),</span><br><span class="line">    dept_id <span class="type">int</span> <span class="keyword">null</span>,</span><br><span class="line">    <span class="keyword">foreign key</span>(dept_id) <span class="keyword">references</span> departments(dept_id)</span><br><span class="line">    <span class="keyword">on</span> <span class="keyword">update</span> <span class="keyword">set</span> <span class="keyword">null</span></span><br><span class="line">    <span class="keyword">on</span> <span class="keyword">delete</span> <span class="keyword">set</span> <span class="keyword">null</span></span><br><span class="line">)</span><br></pre></td></tr></table></figure>
<p>（3）restrict</p>
<p>在父表中有相关记录被子表引用时，禁止对父表中的记录进行更新或者删除操作。这是默认的引用操作。示例如下：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">create table</span> employees(</span><br><span class="line">    emp_id <span class="type">int</span> <span class="keyword">primary key</span>,</span><br><span class="line">    emp_name <span class="type">varchar</span>(<span class="number">50</span>),</span><br><span class="line">    dept_id <span class="type">int</span>,</span><br><span class="line">    <span class="keyword">foreign key</span>(dept_id) <span class="keyword">references</span> departments(dept_id)</span><br><span class="line">    <span class="keyword">on</span> <span class="keyword">update</span> restrict</span><br><span class="line">    <span class="keyword">on</span> <span class="keyword">delete</span> restrict</span><br><span class="line">);</span><br></pre></td></tr></table></figure>
<p><mark>16.index</mark>（索引）（节约搜索时间提高搜索效率）</p>
<p><code>create index</code></p>
<p>索引是一种数据结构，它能够加快数据库表中数据的查询速度。通过创建索引，数据库可以更快地定位到满足查询条件的记录，从而节省搜索时间，提高搜索效率。不过，索引并非适用于所有场景：</p>
<ul>
<li><strong>频繁更新</strong>：在对表进行频繁更新操作时，索引也需要相应地更新，这会降低更新操作的性能。</li>
<li><strong>数据量小</strong>：当表中的数据量较小时，专门创建索引的开销可能会超过索引带来的性能提升，因此没必要专门建立索引。</li>
</ul>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">create</span> index idx_name <span class="keyword">on</span> table_name (column1, column2,...);</span><br></pre></td></tr></table></figure>
<p>17.sql view（视图）</p>
<p>视图是一个虚拟表，它并不实际存储数据，而是基于一个或多个表的查询结果。视图可以简化复杂的查询，提高数据的安全性，并且允许用户以不同的方式查看数据。创建视图的语法如下：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">create</span> <span class="keyword">view</span> view_name <span class="keyword">as</span></span><br><span class="line"><span class="keyword">select</span> column1,column2,...</span><br><span class="line"><span class="keyword">from</span> table_name</span><br><span class="line"><span class="keyword">where</span> <span class="keyword">condition</span>;</span><br></pre></td></tr></table></figure>
<p>18.alter value（修改表结构）</p>
<p><code>ALTER TABLE</code> 语句用于修改已存在表的结构，常见的操作有以下几种：</p>
<p>（1）<code>alter table add</code></p>
<p>用于向表中添加新的列。示例如下：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">alter table</span> users <span class="keyword">add</span> <span class="keyword">column</span> phone <span class="type">varchar</span>(<span class="number">20</span>);</span><br></pre></td></tr></table></figure>
<p>（2）<code>alter table modify</code></p>
<p>用于修改表中现有列的定义，例如修改列的数据类型。示例如下：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">alter table</span> users modify <span class="keyword">column</span> phone <span class="type">varchar</span>(<span class="number">30</span>);</span><br></pre></td></tr></table></figure>
<p>（3）<code>alter table drop</code></p>
<p>用于删除表中的列。示例如下：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">alter table</span> users <span class="keyword">drop</span> <span class="keyword">column</span> phone;</span><br></pre></td></tr></table></figure>
<p>19.transaction（事务）</p>
<p>事务是一组不可分割的数据库操作序列，这些操作要么全部执行成功，要么全部不执行。事务具有原子性、一致性、隔离性和持久性（ACID）四个特性。常见的事务操作有以下几种：</p>
<p>（1）commit</p>
<p>用于提交事务，将事务中所做的所有修改永久保存到数据库中。示例如下：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">start</span> transaction;</span><br><span class="line"><span class="comment">--- 执行一系列数据库操作</span></span><br><span class="line">insect <span class="keyword">into</span> users (name,email) <span class="keyword">values</span> (<span class="string">&#x27;join&#x27;</span>,<span class="string">&#x27;join@example.com&#x27;</span>);</span><br><span class="line"><span class="keyword">update</span> accounts <span class="keyword">set</span> balance<span class="operator">=</span>balance<span class="number">-100</span> <span class="keyword">where</span> user_id<span class="operator">=</span><span class="number">1</span>;</span><br><span class="line"><span class="keyword">commit</span>;</span><br></pre></td></tr></table></figure>
<p>（2）rollback</p>
<p>用于回滚事务，撤销事务中所做的所有修改。示例如下：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">start</span> transaction;</span><br><span class="line"><span class="comment">--- 执行一系列数据库操作</span></span><br><span class="line"><span class="keyword">insert into</span> users (name,email) <span class="keyword">values</span> (<span class="string">&#x27;join&#x27;</span>,<span class="string">&#x27;join@example.com&#x27;</span>)</span><br><span class="line"><span class="keyword">update</span> accounts <span class="keyword">set</span> balance<span class="operator">=</span>balance<span class="number">-100</span> <span class="keyword">where</span> user_id<span class="operator">=</span><span class="number">1</span>;</span><br><span class="line"><span class="keyword">rollback</span>;</span><br></pre></td></tr></table></figure>
<p>（3）savepoint</p>
<p>用于在事务中设置保存点，允许在事务执行过程中部分回滚。示例如下：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">start</span> transaction;</span><br><span class="line"><span class="comment">--- 执行一系列数据库操作</span></span><br><span class="line"><span class="keyword">insert into</span> users (name,email) <span class="keyword">values</span> (<span class="string">&#x27;join&#x27;</span>,<span class="string">&#x27;join@example.com&#x27;</span>);</span><br><span class="line"><span class="keyword">savepoint</span> sp1;</span><br><span class="line"><span class="keyword">update</span> account <span class="keyword">set</span> balance<span class="operator">=</span>balance<span class="number">-100</span> <span class="keyword">where</span> user_id<span class="operator">=</span><span class="number">1</span>;</span><br><span class="line"><span class="comment">-- 发现错误，回滚到保存点</span></span><br><span class="line"><span class="keyword">rollback</span> <span class="keyword">to</span> sp1;</span><br><span class="line"><span class="keyword">commit</span>;</span><br></pre></td></tr></table></figure>
<blockquote>
<p>数据库是如何发现错误进行回滚的？</p>
<p>数据库发现错误并触发回滚的机制主要依赖于==<strong>事务控制逻辑</strong><mark>和</mark><strong>错误检测机制</strong>==</p>
<p>数据库通过 <strong>应用层主动检测</strong> 和 <strong>数据库层自动检测</strong> 两种方式发现错误：</p>
<p>一、错误发现的途径</p>
<ol>
<li>
<p><strong>应用层主动检测（业务逻辑层面）</strong></p>
<ul>
<li>应用程序在执行数据库操作前或后，通过业务规则判断是否出现异常（例如：转账时余额不足、数据格式不符合要求等）。</li>
<li>若检测到错误（如代码中通过条件判断、异常捕获等逻辑），应用会主动调用数据库的回滚接口（如 <code>ROLLBACK</code> 或 <code>ROLLBACK TO SAVEPOINT</code>），显式触发回滚。</li>
</ul>
</li>
<li>
<p><strong>数据库层自动检测（约束与系统层面）</strong></p>
</li>
</ol>
<ul>
<li><strong>完整性约束违反</strong>：数据库内置的约束（如主键唯一性、外键引用、CHECK 约束、非空约束等）会在数据操作时自动校验。若违反约束（例如插入重复主键、外键引用不存在的记录），数据库会立即抛出错误（如 SQL 错误码）。</li>
<li><strong>系统错误</strong>：数据库在执行操作时遇到内部错误（如磁盘空间不足、事务超时、锁冲突等），会自动生成错误信号并中断事务。</li>
</ul>
<p>二、回滚机制的核心原理</p>
<p>当错误被检测到后，数据库通过 <strong>事务日志（Transaction Log）</strong> 和 <strong>保存点（Savepoint）</strong> 实现回滚，具体逻辑如下：</p>
<ol>
<li><strong>事务日志的作用</strong>
<ul>
<li>数据库在事务执行过程中，会将每一步操作（如插入、更新、删除）记录到 <strong>撤销日志（Undo Log）</strong> 中，记录数据修改前的原始状态。</li>
<li>回滚时，数据库根据撤销日志逆向执行操作，将数据恢复到错误发生前的状态（例如：对 <code>UPDATE</code> 操作，回滚会将数据恢复为修改前的值）。</li>
</ul>
</li>
<li><strong>完全回滚与部分回滚</strong>
<ul>
<li><strong>完全回滚（<code>ROLLBACK</code>）</strong>：撤销事务开始后所有未提交的操作，将整个事务回退到初始状态（即 <code>START TRANSACTION</code> 之前的状态）。</li>
<li><strong>部分回滚（<code>ROLLBACK TO SAVEPOINT</code>）</strong>：通过 <code>SAVEPOINT</code> 在事务中标记一个中间点，回滚时仅撤销该保存点之后的操作，保存点之前的操作仍保留（需后续通过 <code>COMMIT</code> 提交）。</li>
</ul>
</li>
<li><strong>事务原子性的保证</strong>
<ul>
<li>无论错误是由应用层还是数据库层触发，事务的原子性要求确保：要么所有操作都提交，要么所有未提交的操作都被回滚，避免数据处于中间状态。</li>
</ul>
</li>
</ol>
</blockquote>
<p>20.motivation（动机）</p>
<p>在数据库设计和开发中，运用上述这些特性和技术主要有以下几个动机：</p>
<ul>
<li><strong>数据完整性</strong>：利用 <code>AUTO_INCREMENT</code>、外键约束和引用操作可以保证数据的完整性和一致性，防止出现无效或者不一致的数据。</li>
<li><strong>性能优化</strong>：使用索引能够提高查询性能，尤其是在处理大量数据时，能够显著缩短查询时间。</li>
<li><strong>灵活性和可维护性</strong>：视图和 <code>ALTER TABLE</code> 语句可以让数据库结构更加灵活，便于后续的维护和扩展。</li>
<li><strong>数据安全性</strong>：事务机制可以确保在并发操作时数据的安全性和一致性，避免数据冲突和错误。</li>
</ul>
<p>##　　 4.24</p>
<p>1.sanitize input（输入净化）</p>
<p>输入净化是一种重要的安全措施，主要用于防止恶意用户通过输入特殊字符或代码来攻击数据库，像 SQL 注入攻击。在将用户输入的数据用于数据库查询之前，需要对输入进行处理，过滤掉可能导致安全问题的字符或代码。例如，在使用 Python 的 <code>sqlite3</code> 库时，可以使用参数化查询，它会自动对输入进行净化：</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> sqlite3</span><br><span class="line"></span><br><span class="line"><span class="comment"># 连接数据库</span></span><br><span class="line">conn = sqlite3.connect(<span class="string">&#x27;example.db&#x27;</span>)</span><br><span class="line">cursor = conn.cursor()</span><br><span class="line"></span><br><span class="line"><span class="comment"># 用户输入</span></span><br><span class="line">username = <span class="built_in">input</span>(<span class="string">&quot;请输入用户名: &quot;</span>)</span><br><span class="line">password = <span class="built_in">input</span>(<span class="string">&quot;请输入密码: &quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 使用参数化查询</span></span><br><span class="line">query = <span class="string">&quot;SELECT * FROM users WHERE username =? AND password =?&quot;</span></span><br><span class="line">cursor.execute(query, (username, password))</span><br><span class="line"></span><br><span class="line"><span class="comment"># 获取结果</span></span><br><span class="line">results = cursor.fetchall()</span><br><span class="line"><span class="built_in">print</span>(results)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 关闭连接</span></span><br><span class="line">conn.close()    </span><br></pre></td></tr></table></figure>
<p>2.prevention（预防）</p>
<p>预防在数据库安全和性能优化方面都非常关键。主要包括以下几个方面：</p>
<ul>
<li><strong>安全预防</strong>：通过输入净化、访问控制、加密等手段，防止 SQL 注入、跨站脚本攻击（XSS）、数据泄露等安全问题。</li>
<li><strong>性能预防</strong>：合理设计数据库结构、创建适当的索引、优化查询语句等，避免出现性能瓶颈，如查询缓慢、死锁等问题。</li>
</ul>
<p>3.ORM: Object-Relational Mapping（对象关系映射）</p>
<p>对象关系映射（ORM）是一种编程技术，它允许开发者使用面向对象的方式来操作数据库，而无需编写原生的 SQL 语句。ORM 框架会自动将对象的操作转换为相应的 SQL 语句，从而简化了数据库开发过程。例如，在 Python 中使用 SQLAlchemy 这个 ORM 框架：</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> sqlalchemy <span class="keyword">import</span> Column, Integer, String, create_engine</span><br><span class="line"><span class="keyword">from</span> sqlalchemy.orm <span class="keyword">import</span> sessionmaker</span><br><span class="line"><span class="keyword">from</span> sqlalchemy.ext.declarative <span class="keyword">import</span> declarative_base</span><br><span class="line"></span><br><span class="line"><span class="comment"># 创建基类</span></span><br><span class="line">Base = declarative_base()</span><br><span class="line"></span><br><span class="line"><span class="comment"># 定义模型类</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">User</span>(<span class="title class_ inherited__">Base</span>):</span><br><span class="line">    __tablename__ = <span class="string">&#x27;users&#x27;</span></span><br><span class="line">    <span class="built_in">id</span> = Column(Integer, primary_key=<span class="literal">True</span>)</span><br><span class="line">    name = Column(String)</span><br><span class="line">    email = Column(String)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 创建数据库引擎</span></span><br><span class="line">engine = create_engine(<span class="string">&#x27;sqlite:///example.db&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 创建表</span></span><br><span class="line">Base.metadata.create_all(engine)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 创建会话</span></span><br><span class="line">Session = sessionmaker(bind=engine)</span><br><span class="line">session = Session()</span><br><span class="line"></span><br><span class="line"><span class="comment"># 创建用户对象</span></span><br><span class="line">new_user = User(name=<span class="string">&#x27;John&#x27;</span>, email=<span class="string">&#x27;john@example.com&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 添加到会话</span></span><br><span class="line">session.add(new_user)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 提交会话</span></span><br><span class="line">session.commit()</span><br><span class="line"></span><br><span class="line"><span class="comment"># 查询用户</span></span><br><span class="line">users = session.query(User).<span class="built_in">all</span>()</span><br><span class="line"><span class="keyword">for</span> user <span class="keyword">in</span> users:</span><br><span class="line">    <span class="built_in">print</span>(user.name, user.email)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 关闭会话</span></span><br><span class="line">session.close()    </span><br></pre></td></tr></table></figure>
<p>4.ER Model</p>
<p>实体 - 关系模型是一种用于数据库设计的概念模型，它通过实体、属性、关系等元素来描述现实世界中的数据及其关系。</p>
<p>（1）Entities（实体）</p>
<p>实体是现实世界中可区别的事物或对象，例如学生、课程、员工等。在 ER 图中，实体通常用矩形表示。</p>
<p>（2）Attributes：the details about each thing（属性）</p>
<p>属性是实体的特征或描述信息，例如学生的姓名、年龄、学号等。在 ER 图中，属性通常用椭圆形表示，并与对应的实体相连。</p>
<p>（2）Relations（can also have attributes）（关系）</p>
<p>关系表示实体之间的联系，例如学生和课程之间的选课关系、员工和部门之间的所属关系等。在 ER 图中，关系通常用菱形表示，并与相关的实体相连。关系也可以有自己的属性，例如选课关系可以有成绩这个属性。</p>
<p>（3）Participation（total，partical participation）（参与度）</p>
<p>参与度描述了实体在关系中出现的情况，分为完全参与和部分参与：</p>
<ul>
<li><strong>完全参与（Total Participation）</strong>：表示实体集中的每个实体都必须参与到某个关系中。在 ER 图中，用双线表示。</li>
<li><strong>部分参与（Partial Participation）</strong>：表示实体集中的部分实体参与到某个关系中。在 ER 图中，用单线表示。</li>
</ul>
<p>（4）generalization and specialization（<strong>泛化</strong>与<strong>特化</strong>）</p>
<ul>
<li><strong>Generalization（泛化）</strong>：是从多个具体实体中抽象出共同特征，形成一个更通用的实体。例如，从本科生、研究生中抽象出学生这个通用实体。</li>
<li><strong>Specialization（特化）</strong>：是将一个通用实体根据某些特征细分为多个具体实体。例如，将学生实体细分为本科生、研究生。</li>
</ul>
<p>（5）weak entities（弱实体）</p>
<p>弱实体是依赖于其他实体（称为强实体）而存在的实体，它没有自己的主键，而是通过与强实体的关系来确定其唯一性。例如，订单明细依赖于订单而存在，订单明细就是一个弱实体。在 ER 图中，弱实体用双矩形表示。</p>
<p>（6）ternary relationships（三元关系）</p>
<p>三元关系是指三个实体之间的关系。例如，教师、课程和学生之间的关系，一个教师可以教授多门课程，一门课程可以有多个学生选修，一个学生可以选修多门课程。在 ER 图中，三元关系用菱形表示，并与三个相关的实体相连。</p>
<h2 id="4-29">4.29</h2>
<p>1.Database Design</p>
<p>需求分析-&gt;概念设计-&gt;逻辑设计-&gt;物理设计</p>
<p><img src="/%E6%95%B0%E6%8D%AE%E5%BA%93%E5%8E%9F%E7%90%86%E4%B8%8E%E5%BA%94%E7%94%A8%EF%BC%88%E5%A4%96%E6%95%99%E7%89%88%EF%BC%89/image-20250510210337610.png" alt="image-20250510210337610"></p>
<p>2.ER图常见物象</p>
<p>（1）Entities实体</p>
<p>表示存储有关某个事物的数据的真实对象或概念，表示为矩形</p>
<p><img src="/%E6%95%B0%E6%8D%AE%E5%BA%93%E5%8E%9F%E7%90%86%E4%B8%8E%E5%BA%94%E7%94%A8%EF%BC%88%E5%A4%96%E6%95%99%E7%89%88%EF%BC%89/image-20250510210509270.png" alt="image-20250510210509270"></p>
<p>（2）Attributes属性</p>
<p>是实体的具体特征，如员工实体可能有ID，姓名，薪水等属性；属性可以是简单的，复合的，派生的，多值的（多个东西实际上对应一种名字，只是名头不一样），表示为连接到实体的椭圆</p>
<p>（3）Relationships关系</p>
<p>关系是实体之间的关联，例如员工“works in”部门，分为1：1（一对一，如一个人have一张机票），1：M（一对多，如一个老师teach多个学生），M：N（多对多哦，如一个学生enroll注册多个课程，一个课程有多个学生）</p>
<p><img src="/%E6%95%B0%E6%8D%AE%E5%BA%93%E5%8E%9F%E7%90%86%E4%B8%8E%E5%BA%94%E7%94%A8%EF%BC%88%E5%A4%96%E6%95%99%E7%89%88%EF%BC%89/image-20250510211849132.png" alt="image-20250510211849132"></p>
<p><img src="/%E6%95%B0%E6%8D%AE%E5%BA%93%E5%8E%9F%E7%90%86%E4%B8%8E%E5%BA%94%E7%94%A8%EF%BC%88%E5%A4%96%E6%95%99%E7%89%88%EF%BC%89/image-20250510211855671.png" alt="image-20250510211855671"></p>
<p><img src="/%E6%95%B0%E6%8D%AE%E5%BA%93%E5%8E%9F%E7%90%86%E4%B8%8E%E5%BA%94%E7%94%A8%EF%BC%88%E5%A4%96%E6%95%99%E7%89%88%EF%BC%89/image-20250510211901064.png" alt="image-20250510211901064"></p>
<p><img src="/%E6%95%B0%E6%8D%AE%E5%BA%93%E5%8E%9F%E7%90%86%E4%B8%8E%E5%BA%94%E7%94%A8%EF%BC%88%E5%A4%96%E6%95%99%E7%89%88%EF%BC%89/image-20250510211911012.png" alt="image-20250510211911012"></p>
<p>（4）Participation参与</p>
<p>参与是确认是否所有实体都得有这个关系，表示为不同形式的连线。如果每个实体都需要参与就画double line双实线，有些可能不参与就画single line单实线。例如每位学生必须enroll注册至少一门课程，而不是所有课程都必须被enroll</p>
<p><img src="/%E6%95%B0%E6%8D%AE%E5%BA%93%E5%8E%9F%E7%90%86%E4%B8%8E%E5%BA%94%E7%94%A8%EF%BC%88%E5%A4%96%E6%95%99%E7%89%88%EF%BC%89/image-20250510212232034.png" alt="image-20250510212232034"></p>
<p>（5）Keys键</p>
<p>primary keys主键就在实体的名称下面加下划线（are underlined）</p>
<p><img src="/%E6%95%B0%E6%8D%AE%E5%BA%93%E5%8E%9F%E7%90%86%E4%B8%8E%E5%BA%94%E7%94%A8%EF%BC%88%E5%A4%96%E6%95%99%E7%89%88%EF%BC%89/image-20250510212323974.png" alt="image-20250510212323974"></p>
<p>（5）Generalization&amp;Specialization泛化和专业化：grouping similar things</p>
<p>Generalization泛化：当几个实体相似时，我们可以将它们归类为一个通用类型</p>
<p>Specialization特化：将一般实体拆分为更具体的子实体</p>
<p>Inheritance继承：子实体从通用化实体继承属性和关系</p>
<p>三角形标注ISA表示继承，如学生和老师继承人的属性</p>
<p><img src="/%E6%95%B0%E6%8D%AE%E5%BA%93%E5%8E%9F%E7%90%86%E4%B8%8E%E5%BA%94%E7%94%A8%EF%BC%88%E5%A4%96%E6%95%99%E7%89%88%EF%BC%89/image-20250510213141605.png" alt="image-20250510213141605"></p>
<p>（6）Weak Entities弱实体</p>
<p>弱实体依附于其他实体存在，否则将无意义。表示为双矩形。实体与弱实体间的关系表示为双菱形，又称identity relationship标识关系</p>
<p><img src="/%E6%95%B0%E6%8D%AE%E5%BA%93%E5%8E%9F%E7%90%86%E4%B8%8E%E5%BA%94%E7%94%A8%EF%BC%88%E5%A4%96%E6%95%99%E7%89%88%EF%BC%89/image-20250510213433472.png" alt="image-20250510213433472"></p>
<p>（7）Recursive Relationship递归关系</p>
<p>指实体内部之间有交互动作，用循环箭头表示</p>
<p>如alicebob都是员工，员工bob要向经理（也算employee）的alice汇报工作</p>
<p><img src="/%E6%95%B0%E6%8D%AE%E5%BA%93%E5%8E%9F%E7%90%86%E4%B8%8E%E5%BA%94%E7%94%A8%EF%BC%88%E5%A4%96%E6%95%99%E7%89%88%EF%BC%89/image-20250510213942400.png" alt="image-20250510213942400"></p>
<p>（8）Ternary Relationships三元关系</p>
<p>•同时涉及三个实体的关系。你不能只看两个来完全理解这种关系。</p>
<p>• Example: A member want to reserves some equipment at a certain time frame. who? what? when?</p>
<p><img src="/%E6%95%B0%E6%8D%AE%E5%BA%93%E5%8E%9F%E7%90%86%E4%B8%8E%E5%BA%94%E7%94%A8%EF%BC%88%E5%A4%96%E6%95%99%E7%89%88%EF%BC%89/image-20250510214138658.png" alt="image-20250510214138658"></p>
<p>（9）（Min，Max）大小限制</p>
<p>• （min， max） 表示法告诉我们实体可以参与关系的次数 - 至少 （min） 和最多 （max）。• 任何人都可以注册课程，但最多可容纳 50 人。</p>
<p><img src="/%E6%95%B0%E6%8D%AE%E5%BA%93%E5%8E%9F%E7%90%86%E4%B8%8E%E5%BA%94%E7%94%A8%EF%BC%88%E5%A4%96%E6%95%99%E7%89%88%EF%BC%89/image-20250510214230173.png" alt="image-20250510214230173"></p>
<p><img src="/%E6%95%B0%E6%8D%AE%E5%BA%93%E5%8E%9F%E7%90%86%E4%B8%8E%E5%BA%94%E7%94%A8%EF%BC%88%E5%A4%96%E6%95%99%E7%89%88%EF%BC%89/image-20250510214250575.png" alt="image-20250510214250575"></p>
<p>3.ER图绘制流程</p>
<p>（1）<strong>Mapping of Regular Entity Types（常规实体类型的映射）</strong><br>
将每个常规实体类型转换为一个关系模式，实体的属性成为关系模式的属性，实体的主键作为关系模式的主键。例如，“学生” 实体（属性：学号、姓名、年龄，学号为主键）映射为 “学生表”，包含这些属性且学号为主键。</p>
<p>（2）<strong>Mapping of Weak Entity Types（弱实体类型的映射）</strong><br>
弱实体依赖强实体存在，无独立主键。映射时，弱实体与所依赖强实体的主键共同构成其关系模式的主键。如 “订单明细”（弱实体）依赖 “订单”（强实体），订单号（订单主键） + 明细项编号可作为订单明细表的主键，同时包含弱实体自身属性。</p>
<p>（3）<strong>Mapping of Binary 1:1 Relationship Types（二元一对一关系类型的映射）</strong><br>
可将关系合并到任一端实体的关系模式中（如作为一个属性），或单独创建关系模式（包含两端实体主键及关系自身属性，若有）。例如，“部门” 与 “经理”（1:1），可将经理主键加入部门表，或新建表包含部门与经理主键。</p>
<p>（4）<strong>Mapping of Binary 1:N Relationship Types（二元一对多关系类型的映射）</strong>（对于1：N来说，就是要在动作的接收者那加一个动作发出者的主键作为外键放后面即可）<br>
将一端（1 端）实体的主键加入多端（N 端）实体的关系模式中。如 “部门”（1 端）与 “员工”（N 端），把部门编号（部门主键）加入员工表作为外键，体现一对多关系。</p>
<p>（5）<strong>Mapping of Binary M:N Relationship Types（二元多对多关系类型的映射）</strong>（对于M：N，就是要新建一个表table名字为动作的名字，然后表中让动作发出接受者的主键作为外键，这样就能形成m：n的关系）<br>
需创建新关系模式，包含两端实体主键及关系自身属性（若有）。例如 “学生” 与 “课程”（多对多），创建 “选课表”，包含学生学号、课程编号，还可含成绩等属性。</p>
<p>（6）<strong>Mapping of Multivalued attributes（多值属性的映射）</strong><br>
多值属性（如一个人多个电话号码）不能直接存于关系模式，需新建关系模式。如创建 “电话表”，包含个人主键与电话号码属性。</p>
<p>（7）<strong>Mapping of Ternary Relationship（三元关系的映射）</strong><br>
创建新关系模式，包含三个实体的主键及关系自身属性（若有）。例如 “供应商 - 项目 - 零件” 的供应关系，创建表包含供应商编号、项目编号、零件编号，以及供应数量等属性。</p>
<p><img src="/%E6%95%B0%E6%8D%AE%E5%BA%93%E5%8E%9F%E7%90%86%E4%B8%8E%E5%BA%94%E7%94%A8%EF%BC%88%E5%A4%96%E6%95%99%E7%89%88%EF%BC%89/05cd82aa4503ad50ed57d1976d79780.jpg" alt="05cd82aa4503ad50ed57d1976d79780"></p>
<p><img src="/%E6%95%B0%E6%8D%AE%E5%BA%93%E5%8E%9F%E7%90%86%E4%B8%8E%E5%BA%94%E7%94%A8%EF%BC%88%E5%A4%96%E6%95%99%E7%89%88%EF%BC%89/795b3dc0b26f16d0748643ce504f868.jpg" alt="795b3dc0b26f16d0748643ce504f868"></p>
<blockquote>
<p>如何解读ER图？</p>
<ul>
<li><strong>长方形（实体）</strong></li>
</ul>
<p>（1）<strong>Branch（分行）</strong>：代表银行分行这一实体，具有属性 <code>branch#</code>（分行编号，下划线表示主键，唯一标识分行）和 <code>name</code>（分行名称）。</p>
<p>（2）<strong>Account（账户）</strong>：代表银行账户实体，属性有 <code>acct#</code>（账户编号，主键）和 <code>balance</code>（账户余额）。</p>
<p>（3）<strong>Customer（客户）</strong>：代表银行客户实体，属性包括 <code>cust#</code>（客户编号，主键）、<code>name</code>（客户姓名）和 <code>address</code>（客户地址）。</p>
<ul>
<li><strong>菱形（关系）</strong></li>
</ul>
<p>（1）<strong>HeldAt（开设在）</strong>：表示账户（Account）与分行（Branch）之间的关系，即账户开设在某个分行。</p>
<p>（2）<strong>HomeBranch（归属分行）</strong>：描述客户（Customer）与分行（Branch）的关系，即客户的归属分行。</p>
<p>（3）<strong>Owns（拥有）</strong>：体现客户（Customer）与账户（Account）的关系，即客户拥有账户。</p>
<ul>
<li><strong>椭圆形（属性）</strong></li>
</ul>
<p>椭圆形用于表示实体的特征，如 <code>branch#</code>、<code>name</code> 是 <code>Branch</code> 实体的属性；<code>acct#</code>、<code>balance</code> 是 <code>Account</code> 实体的属性；<code>cust#</code>、<code>name</code>、<code>address</code> 是 <code>Customer</code> 实体的属性。</p>
<ul>
<li><strong>连线粗细与箭头</strong></li>
</ul>
<p>（1）图中 <code>Account</code> 到 <code>HeldAt</code> 的连线较粗，通常在 ER 图中，这种视觉差异可能用于强调关系的重要性或突出显示特定关联，但并非严格的标准规范。</p>
<p>（2）箭头表示关系的方向或参与度。例如，<code>HeldAt</code> 到 <code>Branch</code> 的箭头，表明 <code>Account</code> 通过 <code>HeldAt</code> 关系指向 <code>Branch</code>，即账户开设在分行，一个账户只对应一个分行（从图中关系方向看，体现了一种单向的关联指向）。而 <code>Owns</code> 关系连接 <code>Customer</code> 和 <code>Account</code> 无箭头，暗示这是一种多对多的关系（一个客户可拥有多个账户，一个账户可被多个客户拥有）。</p>
</blockquote>
<blockquote>
<p>如何作答“如何解读ER图”的问题？</p>
<blockquote>
<p>[!success]</p>
<p>解读此 ER 图时，答案应包含以下信息：图中的实体及其属性、实体间的关系、关系的含义、主键标识（下划线）等。</p>
</blockquote>
<p>图中包含三个实体：</p>
<ul>
<li><strong>Branch（分行）</strong>：具有属性 <code>branch#</code>（分行编号，主键，以下划线标识）和 <code>name</code>（分行名称）。</li>
<li><strong>Account（账户）</strong>：具有属性 <code>acct#</code>（账户编号，主键）和 <code>balance</code>（账户余额）。</li>
<li><strong>Customer（客户）</strong>：具有属性 <code>cust#</code>（客户编号，主键）、<code>name</code>（客户姓名）和 <code>address</code>（客户地址）。</li>
</ul>
<p>实体间的关系如下：</p>
<ul>
<li><strong>HeldAt（开设在）</strong>：表示 <code>Account</code>（账户）与 <code>Branch</code>（分行）的关系，即账户开设在某个分行。</li>
<li><strong>Owns（拥有）</strong>：表示 <code>Customer</code>（客户）与 <code>Account</code>（账户）的关系，即客户拥有账户。</li>
<li><strong>HomeBranch（归属分行）</strong>：表示 <code>Customer</code>（客户）与 <code>Branch</code>（分行）的关系，即客户的归属分行。</li>
</ul>
<p>通过这些元素，该 ER 图构建了一个简单的银行相关数据模型，清晰展示了分行、账户、客户及其属性与相互关系，为后续数据库设计（如关系模式转换）提供了概念基础。</p>
</blockquote>
<p>4.Heuristic Guideline（启发式准则）</p>
<p>（1）Heuristic Guideline 1</p>
<ul>
<li><strong>内容</strong>：关系中的每个元组应代表一个实体或关系实例，且仅通过外键引用其他实体。不同实体（如学生、课程）的属性不应混合在同一关系中。</li>
<li><strong>示例</strong>：图中表格将 <code>StudentID</code>（学生编号）、<code>StudentName</code>（学生姓名）、<code>CourseName</code>（课程名称）、<code>Instructor</code>（教师）混合，这种设计不符合准则，被标记为错误（打叉）。</li>
</ul>
<blockquote>
<p>将这些属性放在同一表中，会使关系语义混乱，违背 “一个关系代表一种实体或关系实例” 的原则。例如，该表既想表示学生信息，又想表示课程信息，导致元组含义不清晰，因此被标记为错误。</p>
</blockquote>
<p><img src="/%E6%95%B0%E6%8D%AE%E5%BA%93%E5%8E%9F%E7%90%86%E4%B8%8E%E5%BA%94%E7%94%A8%EF%BC%88%E5%A4%96%E6%95%99%E7%89%88%EF%BC%89/image-20250429103002135.png" alt="image-20250429103002135"></p>
<p>（2）Heuristic Guideline 2</p>
<ul>
<li><strong>内容</strong>：避免冗余信息。冗余信息可能导致更新不一致。</li>
<li><strong>示例</strong>：若数学课程的教师 <code>Prof. A</code> 被 <code>Prof. X</code> 取代，由于教师信息在每个学生 - 课程对中重复存储，若未更新所有相关行，会导致数据冲突或错误。</li>
</ul>
<p><img src="/%E6%95%B0%E6%8D%AE%E5%BA%93%E5%8E%9F%E7%90%86%E4%B8%8E%E5%BA%94%E7%94%A8%EF%BC%88%E5%A4%96%E6%95%99%E7%89%88%EF%BC%89/image-20250429103706006.png" alt="image-20250429103706006"></p>
<p>不能把Prof.A变成Prof.X</p>
<p>（3）Heuristic Guideline 3</p>
<ul>
<li><strong>内容</strong>：设计的模式应避免插入、删除和更新异常。</li>
<li><strong>示例</strong>：对于 <code>EMP_PROJ(Emp#, Proj#, Ename, Pname, No_hours)</code> 表，删除一个项目会误删所有参与该项目的员工；若一个员工是某项目的唯一参与者，删除该员工会误删项目，这就是删除异常。</li>
</ul>
<p>（4）Heuristic Guideline 4</p>
<ul>
<li><strong>内容</strong>：关系设计应使元组的 <code>NULL</code> 值尽可能少。<code>NULL</code> 会导致歧义（未知还是不适用），并使查询复杂易错。</li>
<li><strong>示例</strong>：查询考试不及格的学生时，需添加 <code>grade is not null</code> 条件，因为 <code>grade</code> 为 <code>NULL</code> 不代表不及格，体现了 <code>NULL</code> 对查询的影响。</li>
</ul>
<p>（5）Heuristic Guideline 5</p>
<ul>
<li><strong>内容</strong>：设计关系模式时，应能通过适当相关的属性（主键、外键）对的相等条件进行连接，以抑制虚假元组产生。若表间无匹配键属性或值不一致，连接会出错或产生虚假结果。</li>
<li><strong>核心</strong>：确保表间通过合理的键（如主键 - 外键）关联，避免连接错误或无效结果。</li>
</ul>
<p>5.Database Normalization</p>
<p>数据库规范化通过将大表拆分为更小的相关表，并使用键定义它们之间的清晰关系，以减少数据冗余、消除异常（插入、删除、更新异常）。规范化遵循一系列范式（Normal Forms）：</p>
<p>（1）1NF（First Normal Form）第一范式</p>
<p>表中无重复组或数组，所有列值为原子值（不可再分）。</p>
<ul>
<li>
<p><strong>原子性</strong>：每列值为不可分割的最小单元（如字符串、数字，而非列表 / 集合）。</p>
</li>
<li>
<p><strong>数据类型一致性</strong>：每列仅存储单一类型的值。</p>
</li>
<li></li>
<li>
<p>非 1NF 表</p>
<p>（旧 users 表）：</p>
</li>
<li>
<p>| userid                                   | fullname   |<br>
| ---------------------------------------- | ---------- |<br>
| 1                                        | John Doe   |<br>
| 2                                        | Mary Smith |<br>
| <code>fullname</code>包含空格分隔的姓名，非原子值。 |            |</p>
</li>
<li>
<p>1NF 表</p>
<p>（新 users 表）：</p>
<p>| userid                         | firstname | lastname |<br>
| ------------------------------ | --------- | -------- |<br>
| 1                              | John      | Doe      |<br>
| 2                              | Mary      | Smith    |<br>
| 姓名拆分为独立列，符合原子性。 |           |          |</p>
</li>
</ul>
<blockquote>
<p><strong>每个格子只能装 “单一数据”，不能 “抱团”</strong>：表中的每个 “单元格” 只能存一个 <strong>独立、不可分割</strong> 的值，不能存 “一堆数据”。</p>
<ul>
<li>
<p>比如：“姓名” 列不能存 “张三 李四”（两个人名挤一起），也不能存 “张 / 三”（用斜线分隔），必须拆成 “姓” 和 “名” 两列。</p>
</li>
<li>
<p>再比如：“课程” 列不能写 “数学，物理”（多个课程用逗号隔开），这属于 “重复组”，要么拆成多行（每个课程一行），要么单独建 “选课表”。</p>
</li>
<li>
<p><strong>目的</strong>：让表看起来 “干干净净”，每个格子都规规矩矩只存一个值，方便后续操作。</p>
</li>
<li>
<p>反例</p>
<p>（非 1NF）：</p>
<p>| 学生 ID | 姓名     | 课程       |<br>
| ------- | -------- | ---------- |<br>
| 1       | 张三李四 | 数学，物理 |</p>
</li>
<li>
<p>正例</p>
<p>（1NF）：</p>
<p>| 学生 ID | 姓   | 名   | 课程 |<br>
| ------- | ---- | ---- | ---- |<br>
| 1       | 张   | 三   | 数学 |<br>
| 1       | 张   | 三   | 物理 |</p>
</li>
</ul>
</blockquote>
<p>（2）2NF（Second Normal Form）</p>
<p>满足 1NF，且每个非键列完全函数依赖于主键（无部分依赖）。</p>
<ul>
<li>先满足 1NF。</li>
<li><strong>完全函数依赖</strong>：非主键列依赖于整个主键（若主键为复合键，不能仅依赖部分键）。</li>
</ul>
<p><strong>非 2NF 表</strong>（Students 表）：</p>
<p>| IDSt                                                         | LastName | IDProf | Prof   |<br>
| ------------------------------------------------------------ | -------- | ------ | ------ |<br>
| 1                                                            | Mueller  | 3      | Schmid |<br>
| 主键为<code>(IDSt, IDProf)</code>，但<code>Prof</code>仅依赖<code>IDProf</code>，存在部分依赖。 |          |        |        |</p>
<p><strong>2NF 表</strong>（分解后）：</p>
<ul>
<li>
<p>Students 表：</p>
<p>| IDSt | LastName |<br>
| ---- | -------- |<br>
| 1    | Mueller  |</p>
</li>
<li>
<p>Professors 表：</p>
<p>| IDProf                             | Prof   |<br>
| ---------------------------------- | ------ |<br>
| 3                                  | Schmid |<br>
| 消除部分依赖，非键列完全依赖主键。 |        |</p>
</li>
</ul>
<blockquote>
<p><strong>2NF（第二范式）：非主键列必须 “全靠主键”，不能 “只靠一半”</strong></p>
<ul>
<li>
<p><strong>前提</strong>：先满足 1NF，且表有 <strong>主键</strong>（可能是单个字段，也可能是多个字段的 “复合主键”）。</p>
</li>
<li>
<p>核心规则：表中 “非主键列” 必须完全依赖整个主键，不能只依赖主键的“一部分”。</p>
<ul>
<li>比如：主键是 “学生 ID + 课程 ID”（复合主键，唯一标识一个学生选的一门课），但 “学生姓名” 只依赖 “学生 ID”，“课程名称” 只依赖 “课程 ID”。这时候 “学生姓名” 和 “课程名称” 只依赖主键的 “一半”，属于 “部分依赖”，不符合 2NF。</li>
</ul>
</li>
<li>
<p>解决办法：把 “只依赖一半主键” 的字段拆出去，单独建表。</p>
<ul>
<li>
<p>原表（非 2NF）：</p>
<p>| 学生 ID | 课程 ID | 学生姓名 | 课程名称 | 成绩 |<br>
| ------- | ------- | -------- | -------- | ---- |<br>
| 1       | 101     | 张三     | 数学     | 90   |</p>
</li>
<li>
<p>拆分成三张表（2NF）：</p>
<ul>
<li>
<p>学生表（主键：学生 ID）：</p>
<p>| 学生 ID | 学生姓名 |<br>
| ------- | -------- |<br>
| 1       | 张三     |</p>
</li>
<li>
<p>课程表（主键：课程 ID）：</p>
<p>| 课程 ID | 课程名称 |<br>
| ------- | -------- |<br>
| 101     | 数学     |</p>
</li>
<li>
<p>选课表（主键：学生 ID + 课程 ID）：</p>
<p>| 学生 ID | 课程 ID | 成绩 |<br>
| ------- | ------- | ---- |<br>
| 1       | 101     | 90   |</p>
</li>
</ul>
</li>
</ul>
</li>
<li>
<p><strong>目的</strong>：避免 “部分依赖” 导致的数据冗余（比如同一个学生姓名在多个课程记录中重复出现）。</p>
</li>
</ul>
</blockquote>
<p>（3）3NF（Third Normal Form）</p>
<p>满足 2NF，且无非主属性对主键的传递依赖。</p>
<ul>
<li>先满足 2NF。</li>
<li><strong>无传递依赖</strong>：非主属性仅依赖于候选键，不依赖于其他非主属性。</li>
</ul>
<p><strong>非 3NF 表</strong>（Vendor 表）：</p>
<p>| ID                                                           | Name    | Account No | Bank Code No | Bank   |<br>
| ------------------------------------------------------------ | ------- | ---------- | ------------ | ------ |<br>
| 1                                                            | Vendor1 | 12345      | B001         | Bank A |<br>
| <code>Bank</code>依赖于<code>Bank Code No</code>，而<code>Bank Code No</code>依赖于<code>ID</code>，存在传递依赖。 |         |            |              |        |</p>
<p><strong>3NF 表</strong>（分解后）：</p>
<ul>
<li>
<p>Vendor 表：</p>
<p>| ID   | Name    | Account No | Bank Code No |<br>
| ---- | ------- | ---------- | ------------ |<br>
| 1    | Vendor1 | 12345      | B001         |</p>
</li>
<li>
<p>Bank 表：</p>
<p>| Bank Code No                         | Bank   |<br>
| ------------------------------------ | ------ |<br>
| B001                                 | Bank A |<br>
| 消除传递依赖，非主属性仅依赖候选键。 |        |</p>
</li>
</ul>
<blockquote>
<h3 id="3NF（第三范式）：非主键列之间不能-“间接依赖”，只能-“直接靠主键”"><strong>3NF（第三范式）：非主键列之间不能 “间接依赖”，只能 “直接靠主键”</strong></h3>
<ul>
<li>
<p><strong>前提</strong>：先满足 2NF。</p>
</li>
<li>
<p>核心规则</p>
<p>：表中 “非主键列” 之间不能存在</p>
<p>传递依赖</p>
<p>，即不能有 “字段 A → 字段 B → 字段 C” 这种间接依赖关系，字段 C 必须直接依赖主键，而不是依赖另一个非主键字段。</p>
<ul>
<li>比如：员工表中有 “员工 ID（主键）、部门 ID、部门名称”，“部门名称” 依赖 “部门 ID”，而 “部门 ID” 依赖 “员工 ID”，形成 “员工 ID → 部门 ID → 部门名称” 的传递依赖，不符合 3NF。</li>
</ul>
</li>
<li>
<p>解决办法</p>
<p>：把 “传递依赖” 的字段拆出去，单独建表。</p>
<ul>
<li>
<p>原表（非 3NF）：</p>
<p>| 员工 ID | 部门 ID | 部门名称 | 员工姓名 |<br>
| ------- | ------- | -------- | -------- |<br>
| 1       | D01     | 人事部   | 张三     |</p>
</li>
<li>
<p>拆分成两张表（3NF）：</p>
<ul>
<li>
<p>员工表（主键：员工 ID）：</p>
<p>| 员工 ID | 部门 ID | 员工姓名 |<br>
| ------- | ------- | -------- |<br>
| 1       | D01     | 张三     |</p>
</li>
<li>
<p>部门表（主键：部门 ID）：</p>
</li>
<li>
<p>| 部门 ID | 部门名称 |<br>
| ------- | -------- |<br>
| D01     | 人事部   |</p>
</li>
</ul>
</li>
</ul>
</li>
<li>
<p><strong>目的</strong>：避免 “传递依赖” 导致的更新异常（比如修改部门名称时，需要更新所有相关员工记录，容易漏改）。</p>
</li>
</ul>
</blockquote>
<blockquote>
<p>[!success]</p>
<p><strong>一句话总结三个范式的关系</strong></p>
<ul>
<li><strong>1NF</strong>：先让每个格子 “单身”（只存一个值）。</li>
<li><strong>2NF</strong>：再让非主键列 “全靠主键”（不能只依赖主键的一部分）。</li>
<li><strong>3NF</strong>：最后让非主键列 “直接靠主键”（不能绕弯子依赖其他非主键列）。</li>
</ul>
</blockquote>
<p>（4）BCNF（Boyce-Codd Normal Form）（<strong>Boyce</strong> 和 <strong>Codd</strong> 是两个人的姓氏，分别是 <strong>Raymond F. Boyce</strong> 和 <strong>Edgar F. Codd</strong>（数据库领域的大佬，Codd 还是关系型数据库的创始人，提出了关系模型和前三范式）</p>
<p>3NF 的严格版本，每个决定因素（Determinant）均为候选键。</p>
<ul>
<li><strong>BCNF</strong>：<strong>所有 “决定因素” 都必须是候选键</strong>，包括主键和其他候选键，杜绝任何非候选键决定其他字段的情况（哪怕是主属性之间的依赖）。</li>
</ul>
<p>若存在函数依赖$X \rightarrow Y$，则X必须是候选键（包括单键或复合键）。</p>
<p>解决 3NF 中可能存在的主属性之间的依赖问题（如候选键之间的依赖）。</p>
<ul>
<li>若表中存在依赖$AB \rightarrow C$和$A \rightarrow C$，且A不是候选键，则违反 BCNF，需进一步分解。</li>
</ul>
<p>4.Functional Dependency（函数依赖）</p>
<p>若表中属性X的值唯一决定属性Y的值$X \rightarrow Y$，则称Y函数依赖于X。<br>
<strong>类型</strong>：</p>
<ul>
<li>
<p><strong>完全函数依赖</strong>：Y依赖于整个主键（如复合主键((StudentID, CourseID) \rightarrow Grade)）。</p>
</li>
<li>
<p><strong>部分函数依赖</strong>：Y仅依赖于主键的一部分（如(StudentID \rightarrow StudentName)，在复合主键中违反 2NF）。</p>
</li>
<li>
<p><strong>传递依赖</strong>：Y依赖于非主属性（如(ID \rightarrow Bank Code No \rightarrow Bank)，违反 3NF）。</p>
</li>
</ul>
<p>函数依赖判断范式的核心依据，通过分析函数依赖消除冗余和异常，指导表的分解。</p>
<h2 id="4-30">4.30</h2>
<p>1.Storage Management（存储管理）</p>
<p>（1）数据库存储基本结构</p>
<ul>
<li><strong>存储形式</strong>：数据库以文件形式存放在磁盘上，文件由多个 <strong>“页面（Page）”</strong> 组成（页面是磁盘与内存交互的最小单位，类似 “数据块”）。</li>
<li><strong>页面作用</strong>：每个页面存储多个 <strong>元组（Tuple，即表中的一行数据）</strong>，页面大小固定（如 256 字节、4KB 等）。</li>
<li><strong>存储介质分类</strong></li>
</ul>
<blockquote>
<ul>
<li><strong>易失性存储</strong>（Volatile）：断电数据丢失，如 DRAM（内存）。</li>
<li><strong>非易失性存储</strong>（Non-Volatile）：持久化存储，如硬盘（HDD）、固态硬盘（SSD）。</li>
</ul>
<p>SSD：固态硬盘（Solid State Drive）。HDD：混合硬盘（hybrid harddrive，HHD）</p>
</blockquote>
<ul>
<li>存储层次结构</li>
</ul>
<blockquote>
<p>访问速度（从快到慢）：寄存器 → L1/L2缓存 → 主内存 → SSD → HDD → 磁带/光盘</p>
<p>容量（从小到大）：寄存器（几字节）→ 缓存（KB/MB）→ 主存（GB）→ SSD/HDD（TB）→ 磁带（PB级）</p>
<p>特性：越上层越贵、速度越快、容量越小；越下层越便宜、速度越慢、容量越大。</p>
<p><img src="/%E6%95%B0%E6%8D%AE%E5%BA%93%E5%8E%9F%E7%90%86%E4%B8%8E%E5%BA%94%E7%94%A8%EF%BC%88%E5%A4%96%E6%95%99%E7%89%88%EF%BC%89/image-20250506083447472.png" alt="image-20250506083447472"></p>
</blockquote>
<ul>
<li><strong>HDD vs SSD 物理结构对比</strong></li>
</ul>
<blockquote>
<ul>
<li><strong>HDD</strong>：依赖磁头臂移动和盘片旋转，顺序访问快（因磁头无需频繁寻道），随机访问慢（寻道时间长），抗震性低（工作时抗 55g 冲击）。</li>
<li><strong>SSD</strong>：基于 NAND 闪存，无机械部件，顺序 / 随机访问均快于 HDD，抗震性强（抗 1500g 冲击），但写入寿命有限（约 10³-10⁵次擦写循环）。</li>
</ul>
</blockquote>
<p>（2）页面管理（Page Management）</p>
<ul>
<li><strong>页头元数据</strong>：每个页面包含 <strong>页 ID（唯一标识）、校验和（数据完整性检查）、版本号（并发控制）、元组状态数组（标记元组是否有效 / 删除）</strong>。</li>
<li><strong>槽式页面（Slotted Page）核心机制</strong></li>
</ul>
<blockquote>
<ul>
<li><strong>槽数组（Slot Array）</strong>：存储每个元组的起始偏移量和状态（如是否被删除），页头记录 “已用槽数”，方便快速定位元组。</li>
<li><strong>可变长度元组处理</strong>：元组数据区需额外存储长度信息，删除元组后通过槽数组标记空闲槽位，新元组可复用任意空闲槽（非仅页尾，区别于固定长度元组）。</li>
</ul>
</blockquote>
<ul>
<li><strong>NULL 值与大值存储</strong></li>
</ul>
<blockquote>
<ol>
<li><strong>NULL 表示</strong></li>
</ol>
<ul>
<li>
<p><strong>全局位图</strong>：页头设一个位图，每一位对应一个元组的某个属性是否为 NULL（节省空间，适合多 NULL 场景）。</p>
</li>
<li>
<p><strong>占位符值</strong>：为数据类型定义特殊值（如 INT 类型用 - 9999 表示 NULL，需业务层约定）。</p>
</li>
<li>
<p><strong>属性级标记</strong>：每个属性前加 1 位标记位（1 = 有效，0=NULL），简单但增加存储开销。</p>
</li>
</ul>
<ol start="2">
<li><strong>大值处理</strong></li>
</ol>
<p>当元组超过页面大小时，DBMS 会：</p>
<ol>
<li>使用<strong>溢出页</strong>（Overflow Page）：主页面存指针，大值数据分块存在后续页面（如 PostgreSQL 的 TOAST 技术）。</li>
<li>存储到<strong>外部文件</strong>：元组仅存文件路径，适用于超大对象（如二进制文件、长文本）。</li>
</ol>
</blockquote>
<ul>
<li>存储方式
<ul>
<li><strong>页头（Page Header）</strong>：记录页面基本信息（如已存元组数量、空闲空间等）。</li>
<li><strong>槽位（Slot Entries）</strong>：每个槽位记录一个元组在页面中的位置，类似 “索引标签”，方便快速定位元组。</li>
<li><strong>元组存储</strong>：元组按顺序写入页面，固定长度元组直接连续存放，可变长度元组需额外记录长度信息。</li>
</ul>
</li>
<li>操作逻辑
<ul>
<li><strong>追加元组</strong>：直接在页面末尾写入新元组，页头更新元组数量（类似在笔记本新页末尾写新内容）。</li>
<li><strong>删除元组</strong>：标记元组空间为 “可用”，后续新元组可复用该空间（类似划掉笔记本上的旧内容，留空位置写新内容）。</li>
</ul>
</li>
</ul>
<p>（3）页面存储效率</p>
<ul>
<li>顺序访问 vs 随机访问</li>
</ul>
<p>磁盘读取连续存储的页面（顺序访问）比分散存储的页面（随机访问）快得多（类比：在书架上按顺序找书 vs 随机翻找，前者更快）。</p>
<ul>
<li>固定长度元组优势</li>
</ul>
<p>固定长度元组（如每个元组占 20 字节）的存储和查询效率更高，无需额外处理长度信息（可变长度元组需多一步 “量尺寸”）。</p>
<ul>
<li>对齐访问</li>
</ul>
<blockquote>
<ul>
<li>数据在内存中需按数据类型长度对齐（如 8 字节数据存放在 8 的倍数地址），否则：ARM/RISC-V 等 CPU 会触发<strong>访问异常</strong>，X86 虽允许但会导致<strong>性能骤降</strong>（需多次非对齐读写）。</li>
<li>解决方案</li>
</ul>
<p><strong>填充（Padding）</strong>：在属性间补空字节，强制对齐（如 16 位属性后补 2 字节，占 4 字节）。</p>
<p><strong>字段重排序</strong>：按数据类型长度降序排列属性（长字段优先，减少填充开销）。</p>
</blockquote>
<ul>
<li><strong>记录标识符（RID，Row Identifier）</strong></li>
</ul>
<blockquote>
<p>DBMS 自动为每个元组生成唯一物理地址，用于快速定位：</p>
<ul>
<li>PostgreSQL：<code>CTID</code>（6 字节，包含页号和槽位号）。</li>
<li>SQLite：<code>ROWID</code>（8 字节，隐含表的物理存储位置）。</li>
<li>应用场景：索引底层常依赖 RID 加速数据定位，但业务层不应依赖（物理位置可能变更）。</li>
</ul>
</blockquote>
<p>（4）典型计算示例（页面容量计算）</p>
<p><strong>问题1</strong>：若页面大小 256 字节，页头占 16 字节，每个槽位占 4 字节，每个元组占 20 字节（固定长度），最多存多少元组？</p>
<p>$页头＋(槽位+元组数据)\times元组数≤页面大小$</p>
<p>$16+(4+20)\times n\le240$，$n\le 10$</p>
<p><strong>问题2</strong>：<br>
页面大小 512 字节，页头 20 字节，槽位 4 字节 / 个，记录大小依次为 [32, 28, 50, 40, 64, 45, 36]（可变长度），按顺序插入，能存多少条？</p>
<p>计算公式还是$页头＋(槽位+元组数据)\times元组数≤页面大小$</p>
<p>可以发现$20+7\times (4+\sum元组_i)=343&lt;512$，因此能插入7条。</p>
<blockquote>
<p><mark>通俗解释：数据库如何在磁盘上 “存东西”？</mark></p>
<p>想象数据库是一个大账本，磁盘是账本的存储抽屉，每个 <strong>“页面” 就是账本中的一页纸</strong>：</p>
<ol>
<li><strong>每页纸的结构</strong>：
<ul>
<li>页头（纸的顶部）：写着 “这页有 3 条记录”“还剩 50 字节空白”。</li>
<li>槽位（纸的边缘标签）：每个标签标着 “第 1 条记录从第 10 字节开始，占 20 字节”，方便快速翻到对应位置。</li>
<li>记录（纸上的内容）：每条记录像一行字，固定长度的记录（如 “姓名 20 字”）整齐排列，可变长度的记录（如 “备注”）需要额外标记长度。</li>
</ul>
</li>
<li><strong>往纸上写东西</strong>：
<ul>
<li><strong>新增记录</strong>：直接在纸的末尾空白处写新内容，页头更新 “现在有 4 条记录”（类似在笔记本新行写东西）。</li>
<li><strong>删除记录</strong>：划掉某条记录，标记这块空白可以写新内容，下次写记录时优先用空出来的位置（避免浪费纸张）。</li>
</ul>
</li>
<li><strong>找东西的效率</strong>：
<ul>
<li>如果记录按顺序写在纸上（如按学号排序），找起来很快（顺序访问）；如果记录乱序分布（随机访问），就像在笔记本里乱翻，效率低。</li>
</ul>
</li>
</ol>
<p>通过这种 “分页管理”，数据库能高效地在磁盘上存储、查询和修改数据，就像用账本有条理地记录信息一样。</p>
</blockquote>
<h2 id="5-6">5.6</h2>
<p>1.Clock</p>
<blockquote>
<ul>
<li><strong>数据结构</strong>：环形队列 + 参考位（1 位），指针循环扫描，替代 LRU 的时间戳数组，空间效率更高。</li>
<li>优化点
<ul>
<li>避免 LRU 的 “Belady 异常”（容量增大时命中率可能下降）。</li>
<li>比 LRU 更易实现，适合内存受限场景（如嵌入式 DBMS）。</li>
</ul>
</li>
<li><strong>变种：Second Chance 算法</strong>（等价于 Clock）：<br>
若首次扫描到参考位 1，清 0 并跳过；再次扫描到 0 时才淘汰（给近期访问过的页面第二次机会）。</li>
</ul>
</blockquote>
<p>2.Localization（缓冲区本地化）</p>
<blockquote>
<ul>
<li>
<p><strong>核心目标</strong>：防止单个查询（如全表扫描）占用过多缓冲池资源，导致高频访问页面被挤出。</p>
</li>
<li>
<p>实现方式</p>
<p>（以 PostgreSQL 为例）：</p>
<ol>
<li><strong>查询级缓冲区配额</strong>：为每个查询分配固定数量的缓冲区帧（如最多使用 100 个页面），超出后强制释放。</li>
<li><strong>局部性感知替换</strong>：将缓冲区分为 “全局区” 和 “局部区”，前者存储高频共享页面，后者临时存储查询专属页面（查询结束后释放）。</li>
</ol>
</li>
<li>
<p>优势</p>
<ul>
<li><strong>隔离资源竞争</strong>：OLTP 查询（高频小数据量）和 OLAP 查询（低频大数据量）的缓冲区使用互不干扰。</li>
<li><strong>减少 “缓冲区污染”</strong>：全表扫描加载的页面仅在查询生命周期内存在，不会长期占用缓冲区。</li>
</ul>
</li>
<li>
<p><strong>与 LRU-K 对比</strong>：<br>
LRU-K 通过历史访问次数优化淘汰策略，Localization 则从<strong>查询粒度</strong>控制资源分配，二者可结合使用（如 PostgreSQL 同时支持本地化和 LRU 变种）。</p>
</li>
</ul>
</blockquote>
<p>3.缓冲区管理其他技术</p>
<ul>
<li>
<p>Buffer Pool 组成</p>
<ul>
<li><strong>帧（Frame）</strong>：缓冲区中的固定大小存储单元，与磁盘页面一一对应。</li>
<li>页表（Page Table）：记录页面是否在内存中，包含元数据：
<ul>
<li><strong>脏标志（Dirty Flag）</strong>：页面被修改后标记为脏，淘汰前需写回磁盘（写回策略比写通更高效，减少 I/O 次数）。</li>
<li><strong>固定标志（Pin Flag）</strong>：防止重要页面被淘汰（如索引根节点），查询使用时 “固定” 页面，用完释放。</li>
</ul>
</li>
</ul>
</li>
<li>
<p><strong>替换策略对比</strong>：</p>
</li>
</ul>
<p>| 策略           | 核心逻辑                                      | 优势               | 缺点                 |<br>
| -------------- | --------------------------------------------- | ------------------ | -------------------- |<br>
| LRU            | 淘汰最久未访问的页面                          | 简单有效           | 对顺序扫描不友好     |<br>
| Clock          | 基于 1 位参考位，扫描淘汰未访问页面           | 省内存，易实现     | 精度低于 LRU         |<br>
| LRU-K          | 记录最近 K 次访问时间，淘汰最不可能访问的页面 | 平衡频率和近期访问 | 复杂度高，内存开销大 |<br>
| MySQL 两段 LRU | 新页面先放 “旧列表”，再次访问移到 “新列表”    | 避免短期热点       |                      |</p>
<ul>
<li><strong>预取优化（Prefetching）</strong><br>
DBMS 根据查询模式提前加载相邻页面（如顺序扫描时预取下一页面），减少 I/O 等待时间，尤其适合 HDD（机械寻道时间长）。</li>
</ul>
<blockquote>
<p>在数据库和多线程编程中，锁是一种非常重要的机制，用于解决多个进程或线程同时访问共享资源时可能出现的数据不一致问题。下面通俗地介绍一下锁和乐观锁，并举例分析：</p>
<ul>
<li><strong>锁的基本概念</strong>：可以把锁想象成一个房间的钥匙。当一个人（线程或进程）想要进入房间（访问共享资源）并对房间里的东西进行操作时，他需要先拿到钥匙。在他拿着钥匙的期间，其他人就不能进入房间，直到他把钥匙还回来。在编程里，锁就是用来控制对共享资源的访问顺序的工具，确保同一时间只有一个 “人” 能访问和修改共享资源，避免出现混乱。</li>
<li><strong>悲观锁</strong>：悲观锁就像一个非常谨慎的人，他总是觉得别人会跟他抢东西。在数据库操作中，悲观锁认为在自己使用共享资源的过程中，一定会有其他线程来修改这个资源。所以，在访问资源前，它就会先把资源锁起来，其他线程只能等待锁被释放后才能访问。例如，在银行转账的场景中，A 向 B 转账 100 元。假设数据库里记录 A 账户余额的这一行数据就是共享资源，使用悲观锁时，当系统要读取 A 的余额时，就会马上给这行数据加上锁。在整个转账操作（读取 A 余额、扣除 100 元、写入新余额、读取 B 余额、增加 100 元、写入 B 新余额）过程中，其他任何操作都不能修改 A 和 B 的余额数据。只有等转账操作全部完成，锁被释放后，其他线程才能对这些数据进行操作。这样能保证数据的一致性，但缺点是如果有很多线程都要访问这些数据，就会有很多线程处于等待状态，性能会受到影响。</li>
<li><strong>乐观锁</strong>：乐观锁则像一个乐观的人，他总是觉得在自己操作共享资源的时候，别人不会来抢。乐观锁假设在大多数情况下，多个线程不会同时修改共享资源。所以，它不会在一开始就锁定资源，而是在更新资源的时候，检查一下在自己读取资源之后，有没有其他线程修改过这个资源。如果没有，就正常更新；如果有，就采取一些措施，比如重新读取数据再尝试更新。还是以银行转账为例，系统读取 A 的余额时，不会加锁。在准备更新 A 的余额时，会检查 A 的余额在读取之后有没有被其他线程修改过。可以通过版本号或者时间戳来实现这种检查。假设给 A 的账户数据添加一个版本号，初始值是 1。系统读取 A 余额时，同时获取版本号 1。当要更新 A 余额时，再次检查版本号，如果还是 1，就说明没有其他线程修改过，允许更新，并把版本号更新为 2；如果版本号已经不是 1 了，就说明有其他线程修改过，那么就重新读取 A 的余额和最新版本号，然后再尝试更新。乐观锁的优点是并发性能好，因为大多数时候不需要等待锁的释放。但缺点是如果并发冲突比较频繁，就会导致很多次更新失败，需要不断重试，也会影响性能。</li>
</ul>
</blockquote>
<p><strong>问题 1</strong>（LRU缓存算法）</p>
<p>你有一个容量为 3 的 LRU 缓存，在执行以下操作后，缓存的内容是什么？<br>
操作步骤：</p>
<ol>
<li>Get(1)</li>
<li>Put(1)</li>
<li>Get(2)</li>
<li>Get(3)</li>
<li>Put(3)</li>
<li>Get(2)</li>
<li>Get(4)</li>
<li>Get(1)</li>
<li>Put(1)</li>
<li>Get(5)</li>
</ol>
<blockquote>
<p>问题1使用的是 LRU 算法，LRU 关注的是数据的访问顺序，通过将最近访问的数据置于缓存靠前位置（最近使用），最久未访问的数据置于靠后位置（最久未使用），来决定淘汰策略。当有新数据插入时，若缓存未满，新数据直接插入到最近使用的位置（也就是最前面）；若缓存已满，则淘汰最久未使用的数据（最末尾的数据） ，然后将新数据插入到最前面。</p>
<p>在 “put (1)” 和 “put (2)” 时，因为缓存未满，所以直接按访问顺序从前到后插入，先插入 1，再插入 2，就变成了 [2, 1]，这里的顺序是基于最近使用的顺序，2 是最新使用的，所以在前面，1 在后面。</p>
<p>1.知识点讲解</p>
<p>LRU（Least Recently Used）缓存算法即最近最少使用算法。它的核心思想是，当缓存容量已满，需要淘汰数据时，优先淘汰最久未被使用的数据。就好比你有一个小书架，空间有限，新的书放不下了，你就会把很久都没看过的书拿走，给新书腾地方。在缓存中，每次访问一个数据，就相当于这本书被你拿出来看了，它就变成了最近使用的，会被放到更靠前的位置；而一直没被访问的数据，就会逐渐往后移，当缓存满了，最靠后的那个（最久未使用的）就会被淘汰。</p>
<p>2.答案解析</p>
<ol>
<li><strong>Get(1)</strong>：缓存中原本没有 1，所以未命中，从别处获取 1 放入缓存。此时缓存只有 1，所以缓存内容是 [1] ，也没有数据被淘汰。</li>
<li><strong>Put(1)</strong>：1 已经在缓存中，对其进行更新，更新后它依然是最近使用的，所以缓存内容还是 [1] ，没有淘汰数据。</li>
<li><strong>Get(2)</strong>：缓存中没有 2，未命中，获取 2 放入缓存。因为 2 是新访问的，所以放在最前面，此时缓存内容变为 [2, 1] ，无淘汰数据。</li>
<li><strong>Get(3)</strong>：缓存中没有 3，未命中，获取 3 放入缓存。3 成为最近使用的，所以缓存内容变为 [3, 2, 1] ，没有数据被淘汰。</li>
<li><strong>Put(3)</strong>：3 已经在缓存中，更新 3 后它还是最近使用的，缓存内容保持 [3, 2, 1] ，无淘汰。</li>
<li><strong>Get(2)</strong>：缓存中有 2，命中。将 2 提升到最近使用的位置，也就是放到最前面，缓存内容变为 [2, 3, 1] ，没有数据被淘汰。</li>
<li><strong>Get(4)</strong>：缓存中没有 4，未命中。但缓存容量已满，需要淘汰数据。根据 LRU 算法，最久未使用的是 1，所以淘汰 1，放入 4，缓存内容变为 [4, 2, 3] 。</li>
<li><strong>Get(1)</strong>：缓存中没有 1，未命中。缓存容量还是满的，此时最久未使用的是 3，淘汰 3，放入 1，缓存内容变为 [1, 4, 2] 。</li>
<li><strong>Put(1)</strong>：1 已经在缓存中，更新后缓存内容不变，还是 [1, 4, 2] ，无淘汰。</li>
<li><strong>Get(5)</strong>：缓存中没有 5，未命中。缓存满了，淘汰最久未使用的 2，放入 5，缓存内容变为 [5, 1, 4] 。</li>
</ol>
</blockquote>
<p>| 步骤 | 操作   | 动作                        | 缓存内容（最近使用 -&gt; 最久未使用） | 是否淘汰   |<br>
| ---- | ------ | --------------------------- | ---------------------------------- | ---------- |<br>
| 1    | Get(1) | 未命中：获取 1              | [1]                                | 否         |<br>
| 2    | Put(1) | 更新 1（已在最近使用位置）  | [1]                                | 否         |<br>
| 3    | Get(2) | 未命中：获取 2              | [2, 1]                             | 否         |<br>
| 4    | Get(3) | 未命中：获取 3              | [3, 2, 1]                          | 否         |<br>
| 5    | Put(3) | 更新 3（已在最近使用位置）  | [3, 2, 1]                          | 否         |<br>
| 6    | Get(2) | 命中：提升 2 到最近使用位置 | [2, 3, 1]                          | 否         |<br>
| 7    | Get(4) | 未命中：获取 4（淘汰 1）    | [4, 2, 3]                          | 是，淘汰 1 |<br>
| 8    | Get(1) | 未命中：获取 1（淘汰 3）    | [1, 4, 2]                          | 是，淘汰 3 |<br>
| 9    | Put(1) | 更新 1（已在最近使用位置）  | [1, 4, 2]                          | 否         |<br>
| 10   | Get(5) | 未命中：获取 5（淘汰 2）    | [5, 1, 4]                          | 是，淘汰 2 |</p>
<p><strong>问题 2</strong>（时钟手LRU算法）</p>
<p>给定一个容量为 4 页的缓存，使用时钟手 LRU 算法进行管理。在执行以下操作后，缓存中存在哪些页面，它们的参考位是什么？<br>
操作步骤：</p>
<ol>
<li>Get(1)</li>
<li>Get(2)</li>
<li>Get(3)</li>
<li>Get(4)</li>
<li>Get(2)</li>
<li>Get(5)</li>
</ol>
<blockquote>
<p>问题2采用时钟手 LRU 算法，它以环形缓冲区的形式组织页面，主要依据页面的参考位（是否被访问过）来决定淘汰页面，对页面插入顺序没有像 LRU 那样严格按照最近使用顺序来排列。</p>
<p>“Get (2)” 时插入 2 并设参考位为 1，缓存变为 [1:1, 2:1]，这只是简单地将新插入的页面添加到缓存中，没有涉及到按照特定顺序调整位置的操作 。这里只是单纯记录每个页面的参考位状态，在需要淘汰页面时，才会根据时钟手扫描参考位的结果进行操作，与第一题 LRU 算法中时刻维护严格的最近使用顺序不同。</p>
<p>1.知识点讲解</p>
<p>时钟手 LRU 算法是 LRU 算法的一种优化。每个页面都有一个参考位（1 位二进制数），当页面被访问时，参考位设为 1。页面组织在一个环形缓冲区中，有一个类似时钟指针的东西按顺序扫描这些页面。当需要淘汰页面时，指针开始扫描，遇到参考位为 1 的页面，就把参考位清 0 并跳过它；遇到参考位为 0 的页面，就淘汰该页面。这就像你在一个环形书架上整理书，每个书有个小标签（参考位），你拿着一个标记棒（时钟指针）依次检查。如果书的标签是 1（被看过），你就把标签擦掉（清 0）继续检查下一本；如果标签是 0（没被看过），就把这本书拿走（淘汰）。</p>
<p>2.答案解析</p>
<ol>
<li><strong>Get(1)</strong>：插入 1 并把 1 的参考位设为 1，此时缓存只有 1:1，没有淘汰数据。</li>
<li>c</li>
<li><strong>Get(3)</strong>：插入 3 并把 3 的参考位设为 1，缓存变为 [1:1, 2:1, 3:1] ，无淘汰。</li>
<li><strong>Get(4)</strong>：插入 4 并把 4 的参考位设为 1，缓存变为 [1:1, 2:1, 3:1, 4:1] ，无淘汰。</li>
<li><strong>Get(2)</strong>：命中 2，将 2 的参考位设为 1 ，缓存内容不变还是 [1:1, 2:1, 3:1, 4:1] ，无淘汰。</li>
<li><strong>Get(5)</strong>：缓存已满，需要淘汰。时钟手从 1 开始扫描，1 的参考位是 1，清 0 后移动到 2；2 的参考位是 1，清 0 后移动到 3；3 的参考位是 1，清 0 后移动到 4；4 的参考位是 1，清 0 后又回到 1，此时 1 的参考位已经是 0 了，所以淘汰 1，插入 5 并把 5 的参考位设为 1，最终缓存内容是 [5:1, 2:0, 3:0, 4:0] 。</li>
</ol>
<blockquote>
<p>[!success]</p>
<p>在时钟手 LRU 算法的情境下，写成 [2:1, 1:1] 从存储内容的角度来说是可以的。因为该算法重点在于通过参考位和时钟手扫描来管理页面淘汰，对页面在缓存中的排列顺序并没有严格的 “最近使用 - 最久未使用” 顺序要求 。</p>
<p>在这个算法里，只要缓存未满，新插入页面时，你可以将其放在缓存中的任意位置（当然，一般习惯上会添加在末尾等位置，但这并非强制规定）。当缓存满了需要淘汰页面时，时钟手会按顺序扫描页面的参考位来决定淘汰对象，而不是依据页面在缓存中的排列顺序。所以 [2:1, 1:1] 和 [1:1, 2:1] 在表示缓存内容上是等效的，都记录了页面 1 和页面 2 已被访问（参考位为 1）且在缓存中的状态 。</p>
<p>不过，在实际应用和分析问题时，为了保持一致性和便于理解，通常会按照一定的顺序（如插入顺序或某种约定顺序）来书写缓存内容，但这并不影响算法的本质逻辑。</p>
</blockquote>
</blockquote>
<p>| 步骤 | 操作   | 动作                        | 缓存内容（带参考位）                                         | 是否淘汰   | 时钟手移动                                |<br>
| ---- | ------ | --------------------------- | ------------------------------------------------------------ | ---------- | ----------------------------------------- |<br>
| 1    | Get(1) | 插入 1（参考位设为 1）      | [1:1]                                                        | 否         | -                                         |<br>
| 2    | Get(2) | 插入 2（参考位设为 1）      | [1:1, 2:1]                                                   | 否         | -                                         |<br>
| 3    | Get(3) | 插入 3（参考位设为 1）      | [1:1, 2:1, 3:1]                                              | 否         | -                                         |<br>
| 4    | Get(4) | 插入 4（参考位设为 1）      | [1:1, 2:1, 3:1, 4:1]                                         | 否         | -                                         |<br>
| 5    | Get(2) | 命中（将 2 的参考位设为 1） | [1:1, 2:1, 3:1, 4:1]                                         | 否         | -                                         |<br>
| 6    | Get(5) | 未命中：需要淘汰            | 缓存已满，时钟手从 1 开始。1:R=1→清 0，移动；2:R=1→清 0，移动；3:R=1→清 0，移动；4:R=1→清 0，移动；1:R=0（之前已清 0）→淘汰页面 1，插入 5 并设参考位为 1。最终缓存内容：[5:1, 2:0, 3:0, 4:0] | 是，淘汰 1 | 依次检查 1、2、3、4 页后，淘汰 1 并插入 5 |</p>
<p><strong>问题 3</strong>（分代缓存策略）</p>
<p>假设年轻代容量为 2，老年代容量为 2，在执行以下操作后，年轻代和老年代列表中的页面情况如何？<br>
操作步骤：</p>
<ol>
<li>get(1)</li>
<li>get(2)</li>
<li>get(1)</li>
<li>get(3)</li>
<li>get(2)</li>
<li>get(4)</li>
<li>get(5)</li>
</ol>
<blockquote>
<p>问题3的分代缓存策略将缓存分为年轻代和老年代。新数据默认插入老年代，老年代中的数据若再次被访问则移动到年轻代。</p>
<p>在 “put (1)” 和 “put (2)” 时，数据都是新插入老年代，老年代的数据顺序按照插入顺序排列（从新到旧），所以是 [2, 1] ，2 是后插入的，相对较新，在前面，1 在后面。这种顺序和 LRU 算法中按照最近使用排序的逻辑不同，它是基于插入和访问的特定规则来管理数据在不同代缓存中的位置。</p>
<p>1.知识点讲解</p>
<p>这种缓存策略把缓存分为年轻代和老年代。新数据一开始会插入到老年代，如果老年代满了，就淘汰最老的数据。当老年代中的数据再次被访问时，会被移动到年轻代。年轻代也有容量限制，满了之后也会淘汰数据。这就像把书架分成了新书架（年轻代）和旧书架（老年代），新书先放旧书架，如果旧书架满了就扔掉最旧的书。旧书架上的书被重新翻看了，就把它放到新书架上，新书架满了也会扔掉最旧的书。</p>
<p>2.答案解析</p>
<ol>
<li><strong>put(1)</strong>：1 插入到老年代，年轻代没有数据，老年代是 [1] 。</li>
<li><strong>put(2)</strong>：2 插入到老年代，老年代变为 [2, 1] ，年轻代还是空的。</li>
<li><strong>get(1)</strong>：1 在老年代，被访问后移动到年轻代，年轻代变为 [1] ，老年代变为 [2] 。</li>
<li><strong>put(3)</strong>：3 插入到老年代，年轻代是 [1] ，老年代变为 [3, 2] 。</li>
<li><strong>get(2)</strong>：2 在老年代，被访问后移动到年轻代，由于年轻代容量为 2，放入 2 后满了，年轻代变为 [2, 1] ，老年代变为 [3] 。</li>
<li><strong>put(4)</strong>：4 插入到老年代，老年代满了，淘汰最老的 2，老年代变为 [4, 3] ，年轻代还是 [2, 1] 。</li>
<li><strong>put(5)</strong>：5 插入到老年代，老年代又满了，淘汰最老的 3，老年代变为 [5, 4] ，年轻代保持 [2, 1] 。</li>
</ol>
</blockquote>
<p>| 步骤 | 操作   | 年轻代列表（最近 -&gt; 最久） | 老年代列表（最近 -&gt; 最久） | 备注                                   |<br>
| ---- | ------ | -------------------------- | -------------------------- | -------------------------------------- |<br>
| 1    | put(1) | []                         | [1]                        | 1 插入到老年代                         |<br>
| 2    | put(2) | []                         | [2, 1]                     | 2 插入到老年代                         |<br>
| 3    | get(1) | [1]                        | [2]                        | 1 移动到年轻代                         |<br>
| 4    | put(3) | [1]                        | [3, 2]                     | 3 插入到老年代                         |<br>
| 5    | get(2) | [2, 1]                     | [3]                        | 2 移动到年轻代（年轻代已满）           |<br>
| 6    | put(4) | [2, 1]                     | [4, 3]                     | 4 插入到老年代（老年代淘汰最老的页面） |<br>
| 7    | put(5) | [2, 1]                     | [5, 4]                     | 5 插入到老年代（老年代淘汰 3）         |</p>
<p>4.B、B+树</p>
<p>（1）B树基础概念</p>
<p>B树是一种自平衡树数据结构，支持高效的搜索、插入、删除操作，时间复杂度均为 <strong>O(log n)</strong>。每个节点可包含多个键（分隔符）和子节点，适用于磁盘等外存设备，减少 I/O 次数。</p>
<p>核心特性</p>
<ul>
<li><strong>平衡特性</strong>：所有叶子节点位于同一深度，保证树高均衡。</li>
<li><strong>节点填充</strong>：除根节点外，每个节点至少包含 <strong>⌈m/2⌉-1</strong> 个键（m 为节点最大键数），至多 <strong>m-1</strong> 个键，确保节点 “半满”，减少分裂 / 合并频率。</li>
<li><strong>键有序性</strong>：节点内键按升序排列，子节点键范围由父节点键划分（左子树键 &lt; 分隔符键 ≤ 右子树键）。</li>
</ul>
<p>（2）节点结构与树型特征</p>
<p>①节点组成</p>
<ul>
<li><strong>根节点</strong>：至少 1 个键，至多 m-1 个键（m 为节点最大容量）。</li>
<li><strong>内部节点</strong>：含 k 个键，对应 k+1 个子节点，键作为子节点范围的分隔符。</li>
<li><strong>叶子节点</strong>：无子女，存储键及对应值（B 树）或仅键（B + 树，值存于叶子）。</li>
</ul>
<blockquote>
<p>根节点：[20]</p>
<p>内部节点：[10, 35]（左子树&lt;10，中间10≤键&lt;35，右子树≥35）</p>
<p>叶子节点：[6, 10, 20, 31, 38, 44]（键有序排列）</p>
</blockquote>
<p>②与二叉搜索树（BST）的区别</p>
<ul>
<li>BST 每个节点至多 2 个子节点，B 树可含多个子节点，树高更低（降低 I/O 次数）。</li>
<li>BST 无节点填充限制，B 树通过 “半满” 规则减少树高波动，保证性能稳定。</li>
</ul>
<p>（3）B + 树（数据库常用变种）</p>
<p>①与B树核心区别</p>
<ul>
<li><strong>值存储位置</strong>：B 树所有节点存储键和值；B + 树仅叶子节点存储值，内部节点仅存键（用于索引导航），空间利用率更高，查询更稳定（必达叶子节点）。</li>
<li><strong>叶子节点连接</strong>：B + 树叶子节点通过双向指针串联（如<code>Prev</code>/<code>Next</code>），支持高效范围查询（如<code>SELECT * FROM table WHERE id BETWEEN 10 AND 20</code>），无需回溯父节点。</li>
</ul>
<p>②插入与删除算法</p>
<blockquote>
<p>1.<strong>插入流程</strong>（以最大键数 3 为例，插入 6 到节点 [4,12]）</p>
<p>（1）找到目标叶子节点，插入键并排序（如 [4,12]→[4,6,12]，未溢出则完成）。</p>
<p>（2）若节点满（如插入 30 到 [15,25,35]，变为 4 个键）：</p>
<ul>
<li>分裂为左右节点（左 [15,25]，右 [30,35]）。</li>
<li>中间键（30）上移至父节点，若无父节点则创建新根（形成分层结构）。</li>
</ul>
<p>2.<strong>删除流程</strong>（如删除叶子节点 [5,10] 中的 5，导致下溢）</p>
<ul>
<li>
<p>若删除后节点键数 &lt;⌈m/2⌉-1，尝试向 “富裕” 的兄弟节点借键（如从右兄弟 [25,30,35] 借 25，合并到左节点 [10,25]）。</p>
</li>
<li>
<p>借键失败则合并节点（如左兄弟 [10] 与右兄弟 [25,30,35] 合并，父节点删除分隔符 20，可能触发递归调整）。</p>
</li>
</ul>
</blockquote>
<p><strong>例题 1：插入操作（最大节点容量m=3）</strong></p>
<p><strong>初始树结构</strong>：单个叶子节点 <code>[15, 25, 35]</code><br>
<strong>操作</strong>：插入 30</p>
<p><strong>知识点讲解：B + 树的插入与删除规则</strong></p>
<p>B + 树是数据库中常用的索引结构，具有以下核心特性：</p>
<ol>
<li><strong>节点容量</strong>：每个节点最多存储 m 个键（m 为节点最大容量），最少存储$\lceil m/2 \rceil$个键（根节点除外）。</li>
<li><strong>插入规则:</strong>
<ul>
<li>找到目标叶子节点，插入键值对。</li>
<li>若节点已满（键数超过m），则<strong>分裂</strong>为左右两个节点，中间键上移到父节点，递归处理父节点。</li>
</ul>
</li>
<li><strong>删除规则:</strong>
<ul>
<li>找到目标叶子节点，删除键值对。</li>
<li>若节点键数不足（少于$\lceil m/2 \rceil - 1$），尝试向<strong>兄弟节点借键</strong>或与兄弟节点<strong>合并</strong>，递归处理父节点。</li>
</ul>
</li>
</ol>
<p><strong>答案解析</strong></p>
<ol>
<li><strong>插入前检查</strong>：
<ul>
<li>叶子节点当前键：<code>[15, 25, 35]</code>，容量 (m=3)，已满。</li>
<li>插入 30 后，键变为 <code>[15, 25, 30, 35]</code>，超过容量，触发<strong>分裂</strong>。</li>
</ul>
</li>
<li><strong>分裂节点</strong>：
<ul>
<li>按中间位置（第2个键，索引从 1 开始）将键分为左右两部分：
<ul>
<li>左节点：前 2 个键 <code>[15, 25]</code>（保留较小的一半）</li>
<li>右节点：后 2 个键 <code>[30, 35]</code>（保留较大的一半）</li>
</ul>
</li>
<li>中间键 30 上移到父节点。由于原节点是根节点，分裂后<strong>创建新的根节点</strong> <code>[30]</code>，左右子节点分别为左、右分裂节点。</li>
</ul>
</li>
</ol>
<p><img src="/%E6%95%B0%E6%8D%AE%E5%BA%93%E5%8E%9F%E7%90%86%E4%B8%8E%E5%BA%94%E7%94%A8%EF%BC%88%E5%A4%96%E6%95%99%E7%89%88%EF%BC%89/image-20250507144701216.png" alt="image-20250507144701216"></p>
<p><strong>例题 2：删除操作（最大节点容量 m=3）</strong></p>
<p><strong>初始树结构</strong>：</p>
<ul>
<li>根节点：<code>[20]</code></li>
<li>左子节点（叶子）：<code>[5, 10]</code></li>
<li>右子节点（叶子）：<code>[25, 30, 35]</code> <strong>操作</strong>：依次删除 5 和 10</li>
</ul>
<p><strong>答案解析</strong></p>
<ol>
<li><strong>删除 5</strong>：
<ul>
<li>左子节点 <code>[5, 10]</code> 删除 5 后，剩余键 <code>[10]</code>。</li>
<li>节点容量 (m=3)，最小允许键数为$\lceil 3/2 \rceil - 1 = 1$，当前键数为 1，<strong>未触发不足</strong>，暂不处理。</li>
</ul>
</li>
<li><strong>删除 10</strong>：
<ul>
<li>左子节点 <code>[10]</code> 删除 10 后，变为空节点，触发<strong>节点不足</strong>。</li>
<li>尝试向兄弟节点（右子节点 <code>[25, 30, 35]</code>）借键，或与兄弟节点合并。</li>
<li>由于左子节点已空，选择<strong>合并</strong>：将父节点的键 <code>20</code> 下移到左子节点，与右子节点合并为 <code>[20, 25, 30, 35]</code>，超过容量，需再次分裂？</li>
<li>从父节点下移键 <code>20</code>，与右子节点的键合并后重新分配，最终左子节点为 <code>[20, 25]</code>，右子节点为 <code>[30, 35]</code>，父节点更新为 <code>[25]</code></li>
</ul>
</li>
</ol>
<h2 id="5-7">5.7</h2>
<p>1.哈希表（Hash Table）</p>
<p>（1）定义与特性</p>
<ul>
<li><strong>本质</strong>：通过哈希函数将键映射到数组索引，实现快速键值对查找的数据结构。</li>
<li><strong>核心操作</strong>：插入、删除、查询的平均时间复杂度为O(1)，空间复杂度为O(n)。</li>
<li><strong>内部结构</strong>：基于无序数组，通过哈希函数$h(key)$计算索引，例如$h(key) = key\mod N$（N 为数组大小）。</li>
</ul>
<p>（2）与B+树对比</p>
<p>| <strong>特性</strong>       | <strong>哈希表</strong>                           | <strong>B + 树</strong>                     |<br>
| -------------- | ------------------------------------ | ------------------------------ |<br>
| <strong>有序性</strong>     | 无序（仅支持精确匹配）               | 有序（支持范围查询、排序）     |<br>
| <strong>查询复杂度</strong> | 平均 O(1)                            | O($\log n$)                    |<br>
| <strong>适用场景</strong>   | 高频精确查询（如 Redis、PostgreSQL） | 范围查询、排序（如数据库索引） |</p>
<p>（3）<strong>核心问题与解决方案</strong></p>
<p><strong>核心挑战</strong></p>
<ul>
<li><strong>问题 1</strong>：键空间大，无法预先分配足够内存。</li>
<li><strong>问题 2</strong>：哈希冲突（不同键映射到相同索引）。</li>
</ul>
<p><strong>解决方案</strong></p>
<ul>
<li><strong>哈希函数</strong>：设计快速、低冲突的函数（如 xxhash），将任意长度的键映射为固定长度整数。</li>
<li><strong>冲突处理策略</strong>：线性探测（Linear Probing）、链地址法（Separate Chaining）、布谷鸟哈希（Cuckoo Hashing）等。</li>
</ul>
<p>（4）<strong>冲突处理策略</strong></p>
<p><strong>线性探测（Linear Probing）</strong></p>
<ul>
<li><strong>原理</strong>：冲突时顺序查找下一个空闲槽位插入，删除时标记 “墓碑”（Tombstone）以避免查找中断。</li>
</ul>
<p><strong>链地址法（Separate Chaining）</strong></p>
<ul>
<li><strong>原理</strong>：每个槽位维护一个链表，冲突时将键值对添加到链表末尾。</li>
</ul>
<p><strong>布谷鸟哈希（Cuckoo Hashing）</strong></p>
<ul>
<li><strong>原理</strong>：使用多个哈希函数（如$h_1, h_2$）生成多个候选槽位，插入时选择空闲槽位，若冲突则驱逐现有元素并重新哈希。</li>
</ul>
<p>（5）核心公式与算法</p>
<p><strong>哈希函数</strong>：$h(key) = key \mod N$（简单示例）。</p>
<p><strong>线性探测插入</strong>：若槽$h(key)$被占，依次探测$h(key)+1, h(key)+2, \dots$直至找到空闲槽。</p>
<p><strong>布谷鸟哈希插入</strong>：对键$k$，计算$h_1(k)$和$h_2(k)$，优先选择空闲槽，冲突时驱逐旧元素并递归重新哈希。</p>
<p>（6）例题</p>
<p><strong>问题 1：线性探测冲突处理策略例题</strong></p>
<p><strong>知识点讲解</strong><br>
线性探测是哈希表冲突处理的一种策略，当插入键值对时若发生哈希冲突（即目标槽位已被占用），则按顺序探测下一个空闲槽位（如槽位 + 1，+2，…，循环到开头）。删除时需标记 “墓碑”（Tombstone），避免查找时因空洞中断。</p>
<p><strong>核心规则</strong></p>
<ol>
<li>插入：计算哈希值，若槽位空闲则插入；否则顺序探测下一个槽位，直到找到空闲位置。</li>
<li>删除：标记槽位为 “已删除”（墓碑），插入时可重用该槽位，但查找时需跳过墓碑继续探测。</li>
</ol>
<p><strong>例题</strong></p>
<p><strong>哈希函数</strong>：(h(x) = x \mod 7) <strong>表大小</strong>：7 个槽位（索引 0-6） <strong>操作序列</strong>：</p>
<ol>
<li>插入：10, 20, 15, 7, 32, 24</li>
<li>删除：15, 7</li>
</ol>
<p><strong>答案解析</strong></p>
<ol>
<li><strong>插入 10</strong>：
<ul>
<li>(h(10) = 10 \mod 7 = 3)，槽 3 空闲，插入。</li>
<li>表状态：<code>[N, N, N, 10, N, N, N]</code></li>
</ul>
</li>
<li><strong>插入 20</strong>：
<ul>
<li>(h(20) = 20 \mod 7 = 6)，槽 6 空闲，插入。</li>
<li>表状态：<code>[N, N, N, 10, N, N, 20]</code></li>
</ul>
</li>
<li><strong>插入 15</strong>：
<ul>
<li>(h(15) = 15 \mod 7 = 1)，槽 1 空闲，插入。</li>
<li>表状态：<code>[N, 15, N, 10, N, N, 20]</code></li>
</ul>
</li>
<li><strong>插入 7</strong>：
<ul>
<li>(h(7) = 7 \mod 7 = 0)，槽 0 空闲，插入。</li>
<li>表状态：<code>[7, 15, N, 10, N, N, 20]</code></li>
</ul>
</li>
<li><strong>插入 32</strong>：
<ul>
<li>(h(32) = 32 \mod 7 = 4)，槽 4 空闲，插入。</li>
<li>表状态：<code>[7, 15, N, 10, 32, N, 20]</code></li>
</ul>
</li>
<li><strong>插入 24</strong>：
<ul>
<li>(h(24) = 24 \mod 7 = 3)，槽 3 被 10 占用，探测槽 4（被 32 占用），槽 5 空闲，插入槽 5。</li>
<li>表状态：<code>[7, 15, N, 10, 32, 24, 20]</code></li>
</ul>
</li>
<li><strong>删除 15</strong>：
<ul>
<li>槽 1 标记为 “Deleted”（墓碑），表状态：<code>[7, Deleted, N, 10, 32, 24, 20]</code></li>
</ul>
</li>
<li><strong>删除 7</strong>：
<ul>
<li>槽 0 标记为 “Deleted”（墓碑），表状态：<code>[Deleted, Deleted, N, 10, 32, 24, 20]</code></li>
</ul>
</li>
</ol>
<p>| 步骤 | 操作    | 哈希值计算        | 槽位状态（0-6）                         | 冲突处理 / 备注            |<br>
| ---- | ------- | ----------------- | --------------------------------------- | -------------------------- |<br>
| 1    | 插入 10 | (10 \mod 7 = 3) | <code>[N, N, N, 10, N, N, N]</code>                | 无冲突，直接插入           |<br>
| 2    | 插入 20 | (20 \mod 7 = 6) | <code>[N, N, N, 10, N, N, 20]</code>               | 无冲突，直接插入           |<br>
| 3    | 插入 15 | (15 \mod 7 = 1) | <code>[N, 15, N, 10, N, N, 20]</code>              | 无冲突，直接插入           |<br>
| 4    | 插入 7  | (7 \mod 7 = 0)  | <code>[7, 15, N, 10, N, N, 20]</code>              | 无冲突，直接插入           |<br>
| 5    | 插入 32 | (32 \mod 7 = 4) | <code>[7, 15, N, 10, 32, N, 20]</code>             | 无冲突，直接插入           |<br>
| 6    | 插入 24 | (24 \mod 7 = 3) | <code>[7, 15, N, 10, 32, 24, 20]</code>            | 槽 3 冲突，探测到槽 5 插入 |<br>
| 7    | 删除 15 | -                 | <code>[7, Deleted, N, 10, 32, 24, 20]</code>       | 标记墓碑，不影响探测       |<br>
| 8    | 删除 7  | -                 | <code>[Deleted, Deleted, N, 10, 32, 24, 20]</code> | 标记墓碑，槽位可被重用     |</p>
<p><strong>问题 2：链地址法（分离链接）冲突处理策略例题</strong></p>
<p><strong>知识点讲解</strong><br>
链地址法为每个哈希槽维护一个链表，冲突时将键值对添加到链表末尾。查询时遍历链表，删除时从链表中移除节点。</p>
<ul>
<li><strong>核心规则</strong>
<ol>
<li>插入：计算哈希值，将键值对添加到对应槽位的链表末尾。</li>
<li>查询 / 删除：计算哈希值，遍历链表查找目标键，删除时断开节点链接。</li>
</ol>
</li>
</ul>
<p><strong>例题</strong></p>
<p><strong>哈希函数</strong>：(h(x) = x \mod 7) <strong>表大小</strong>：7 个桶（0-6） <strong>操作序列</strong>：</p>
<ol>
<li>插入：15, 11, 27, 8, 3</li>
<li>查询：8（命中）</li>
<li>删除：11</li>
</ol>
<p><strong>答案解析</strong></p>
<ol>
<li><strong>插入 15</strong>：
<ul>
<li>(h(15) = 15 \mod 7 = 1)，桶 1 链表为空，插入链表：<code>[15]</code>。</li>
<li>表状态：桶 1: <code>15</code>，其余桶为空。</li>
</ul>
</li>
<li><strong>插入 11</strong>：
<ul>
<li>(h(11) = 11 \mod 7 = 4)，桶 4 链表为空，插入链表：<code>[11]</code>。</li>
<li>表状态：桶 1: <code>15</code>，桶 4: <code>11</code>，其余桶为空。</li>
</ul>
</li>
<li><strong>插入 27</strong>：
<ul>
<li>(h(27) = 27 \mod 7 = 6)，桶 6 链表为空，插入链表：<code>[27]</code>。</li>
<li>表状态：桶 1: <code>15</code>，桶 4: <code>11</code>，桶 6: <code>27</code>，其余桶为空。</li>
</ul>
</li>
<li><strong>插入 8</strong>：
<ul>
<li>(h(8) = 8 \mod 7 = 1)，桶 1 已有 15，冲突，添加到链表末尾：<code>[15 → 8]</code>。</li>
<li>表状态：桶 1: <code>15 → 8</code>，桶 4: <code>11</code>，桶 6: <code>27</code>，其余桶为空。</li>
</ul>
</li>
<li><strong>插入 3</strong>：
<ul>
<li>(h(3) = 3 \mod 7 = 3)，桶 3 链表为空，插入链表：<code>[3]</code>。</li>
<li>表状态：桶 1: <code>15 → 8</code>，桶 3: <code>3</code>，桶 4: <code>11</code>，桶 6: <code>27</code>，其余桶为空。</li>
</ul>
</li>
<li><strong>查询 8</strong>：
<ul>
<li>(h(8) = 1)，遍历桶 1 链表，找到 8，命中。</li>
</ul>
</li>
<li><strong>删除 11</strong>：
<ul>
<li>(h(11) = 4)，遍历桶 4 链表，移除 11，链表为空。</li>
<li>表状态：桶 1: <code>15 → 8</code>，桶 3: <code>3</code>，桶 6: <code>27</code>，其余桶为空。</li>
</ul>
</li>
</ol>
<p><strong>步骤表格</strong></p>
<p>| 步骤 | 操作    | 哈希值计算        | 桶状态（链表）               | 冲突处理 / 备注            |<br>
| ---- | ------- | ----------------- | ---------------------------- | -------------------------- |<br>
| 1    | 插入 15 | (15 \mod 7 = 1) | 桶 1: <code>[15]</code>                 | 无冲突，新建链表           |<br>
| 2    | 插入 11 | (11 \mod 7 = 4) | 桶 4: <code>[11]</code>                 | 无冲突，新建链表           |<br>
| 3    | 插入 27 | (27 \mod 7 = 6) | 桶 6: <code>[27]</code>                 | 无冲突，新建链表           |<br>
| 4    | 插入 8  | (8 \mod 7 = 1)  | 桶 1: <code>[15 → 8]</code>             | 冲突，添加到链表末尾       |<br>
| 5    | 插入 3  | (3 \mod 7 = 3)  | 桶 3: <code>[3]</code>                  | 无冲突，新建链表           |<br>
| 6    | 查询 8  | -                 | 桶 1 链表命中 8              | 遍历链表找到目标键         |<br>
| 7    | 删除 11 | -                 | 桶 4 链表移除 11，变为空链表 | 断开节点链接，不影响其他键 |</p>
<p><strong>问题 3：布谷鸟哈希冲突处理策略例题</strong></p>
<p><strong>知识点讲解</strong><br>
布谷鸟哈希使用多个哈希函数（如 2 个）生成候选槽位，插入时优先选择空闲槽位，若冲突则驱逐现有元素并重新哈希。</p>
<ul>
<li><strong>核心规则</strong>
<ol>
<li>每个键有 2 个候选槽位：(h_1(key)) 和 (h_2(key))。</li>
<li>插入时，若两个槽位均被占，驱逐其中一个元素，递归重新哈希被驱逐的元素。</li>
</ol>
</li>
</ul>
<p><strong>例题</strong></p>
<p><strong>哈希函数</strong>：</p>
<ul>
<li>(h_1(x) = x \mod 7)</li>
<li>(h_2(x) = (x \div 7) \mod 7)（整数除法取商再模 7） <strong>表大小</strong>：7 个槽位（0-6） <strong>操作序列</strong>：插入 5, 12, 26, 19, 13, 48</li>
</ul>
<p><strong>答案解析（本质就是占了坑的就全部驱逐重新选坑）</strong></p>
<ol>
<li><strong>插入 5</strong>：
<ul>
<li>(h_1(5)=5)，(h_2(5)=0)（5÷7=0），槽 5 空闲，插入槽 5。</li>
<li>表状态：<code>[N, N, N, N, N, 5, N]</code></li>
</ul>
</li>
<li><strong>插入 12</strong>：
<ul>
<li>(h_1(12)=5)（冲突），(h_2(12)=1)（12÷7=1），槽 1 空闲，插入槽 1。</li>
<li>表状态：<code>[N, 12, N, N, N, 5, N]</code></li>
</ul>
</li>
<li><strong>插入 26</strong>：
<ul>
<li>(h_1(26)=26 \mod 7=5)（冲突），(h_2(26)=3)（26÷7=3），槽 3 空闲，插入槽 3。</li>
<li>表状态：<code>[N, 12, N, 26, N, 5, N]</code></li>
</ul>
</li>
<li><strong>插入 19</strong>：
<ul>
<li>(h_1(19)=19 \mod 7=5)（冲突），(h_2(19)=2)（19÷7=2），槽 2 空闲，插入槽 2。</li>
<li>表状态：<code>[N, 12, 19, 26, N, 5, N]</code></li>
</ul>
</li>
<li><strong>插入 13</strong>：
<ul>
<li>(h_1(13)=13 \mod 7=6)，(h_2(13)=1)（13÷7=1），槽 6 空闲，插入槽 6。</li>
<li>表状态：<code>[N, 12, 19, 26, N, 5, 13]</code></li>
</ul>
</li>
<li><strong>插入 48</strong>：
<ul>
<li>(h_1(48)=48 \mod 7=6)（冲突，槽 6 有 13），(h_2(48)=6)（48÷7=6），两个候选槽位均为 6，冲突。</li>
<li>驱逐 13，重新哈希 13：(h_1(13)=6)（冲突），(h_2(13)=1)（槽 1 有 12），驱逐 12，重新哈希 12：(h_1(12)=5)（槽 5 有 5），(h_2(12)=1)（冲突），继续驱逐 5，重新哈希 5：(h_1(5)=5)（冲突），(h_2(5)=0)，槽 0 空闲，插入 5 到槽 0。</li>
<li>最终表状态：<code>[5, 13, 19, 26, N, 12, 48]</code></li>
</ul>
</li>
</ol>
<p><strong>步骤表格</strong></p>
<p>| 步骤 | 操作    | 候选槽位         | 表状态（0-6）                | 冲突处理 / 备注                                              |<br>
| ---- | ------- | ---------------- | ---------------------------- | ------------------------------------------------------------ |<br>
| 1    | 插入 5  | (h_1=5, h_2=0) | <code>[N, N, N, N, N, 5, N]</code>      | 槽 5 空闲，直接插入                                          |<br>
| 2    | 插入 12 | (h_1=5, h_2=1) | <code>[N, 12, N, N, N, 5, N]</code>     | 槽 5 冲突，插入 h₂=1（空闲）                                 |<br>
| 3    | 插入 26 | (h_1=5, h_2=3) | <code>[N, 12, N, 26, N, 5, N]</code>    | 槽 5 冲突，插入 h₂=3（空闲）                                 |<br>
| 4    | 插入 19 | (h_1=5, h_2=2) | <code>[N, 12, 19, 26, N, 5, N]</code>   | 槽 5 冲突，插入 h₂=2（空闲）                                 |<br>
| 5    | 插入 13 | (h_1=6, h_2=1) | <code>[N, 12, 19, 26, N, 5, 13]</code>  | 槽 6 空闲，直接插入 h₁=6                                     |<br>
| 6    | 插入 48 | (h_1=6, h_2=6) | <code>[5, 13, 19, 26, N, 12, 48]</code> | 槽 6 冲突，驱逐 13→h₂=1（冲突 12），驱逐 12→h₁=5（冲突 5），驱 |</p>
<p><strong>总结对比</strong></p>
<p>| <strong>策略</strong>   | <strong>核心机制</strong>           | <strong>优点</strong>             | <strong>缺点</strong>               | <strong>典型场景</strong>         |<br>
| ---------- | ---------------------- | -------------------- | ---------------------- | -------------------- |<br>
| 线性探测   | 顺序查找下一个空闲槽位 | 实现简单，空间紧凑   | 聚集现象，墓碑管理     | 小规模、低冲突场景   |<br>
| 链地址法   | 每个槽位维护链表       | 冲突处理简单，无聚集 | 链表过长影响性能       | 高冲突、动态数据场景 |<br>
| 布谷鸟哈希 | 多哈希函数 + 驱逐机制  | 高空间利用率，查询快 | 实现复杂，可能无限循环 | 内存敏感、高负载场景 |</p>
<h2 id="5-13">5.13</h2>
<p>| 存储过程名称           | 参数                                        | 功能描述                                                     |<br>
| ---------------------- | ------------------------------------------- | ------------------------------------------------------------ |<br>
| BackupCriticalData     | 无                                          | 备份关键数据表 (user, booking, customizeditinerary)，并记录备份日志 |<br>
| ConfirmBooking         | p_booking_id                                | 确认预订，将状态从 &quot;pending&quot; 改为 &quot;confirmed&quot;，支付状态改为 &quot;paid&quot; |<br>
| CopyItinerary          | p_itinerary_id, p_user_id                   | 为用户复制已有行程，包括基本信息和所有行程项目               |<br>
| GenerateItinerary      | p_user_id, p_city, p_start_date, p_end_date | 创建简单行程，根据城市和日期自动添加热门景点和酒店           |<br>
| generate_itinerary     | p_user_id, p_city, p_start_date, p_end_date | 创建个性化行程，根据用户偏好 (旅行风格、预算) 推荐景点和酒店 |<br>
| recommend_scenic_spots | p_user_id, p_city                           | 根据用户兴趣和旅行风格推荐特定城市的景点                     |<br>
| RecordStrategyView     | p_strategy_id                               | 记录攻略查看，增加攻略查看次数，提升相关城市景点热度         |<br>
| RecoverData            | p_recovery_point                            | 从备份恢复数据到指定时间点，恢复 user、booking 和 customizeditinerary 表 |<br>
| SearchScenic           | p_city, p_keyword                           | 搜索特定城市的景点，基于关键词匹配名称、描述或标签           |<br>
| UpdateScenicHotScore   | 无                                          | 更新所有景点的热度评分，基于评论、预订和收藏情况             |</p>
<p>| 触发器名称                  | 作用时机       | 目标表格     | 功能描述                 |<br>
| --------------------------- | -------------- | ------------ | ------------------------ |<br>
| after_booking_status_update | 修改预订状态后 | booking      | 自动发送状态更新通知     |<br>
| after_review_insert         | 添加新评论后   | review       | 根据评分自动调整景点热度 |<br>
| after_strategylike_insert   | 添加新点赞后   | strategylike | 自动增加攻略的点赞计数   |<br>
| after_strategylike_delete   | 删除点赞后     | strategylike | 自动减少攻略的点赞计数   |</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 触发器</span></span><br><span class="line">use <span class="number">016</span>_yhy;</span><br><span class="line"><span class="keyword">SHOW</span> <span class="keyword">CREATE</span> <span class="keyword">TRIGGER</span> after_strategylike_insert;</span><br><span class="line"><span class="keyword">SHOW</span> <span class="keyword">CREATE</span> <span class="keyword">TRIGGER</span> after_strategylike_delete;</span><br><span class="line"><span class="keyword">SELECT</span> strategy_id, title, like_count <span class="keyword">FROM</span> strategy;</span><br></pre></td></tr></table></figure>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 存储过程</span></span><br><span class="line">use <span class="number">016</span>_yhy;</span><br><span class="line"><span class="keyword">SELECT</span> scenic_id, name, hot_score <span class="keyword">FROM</span> scenic <span class="keyword">ORDER</span> <span class="keyword">BY</span> hot_score <span class="keyword">DESC</span> LIMIT <span class="number">10</span>;</span><br><span class="line"><span class="keyword">CALL</span> UpdateScenicHotScore();</span><br><span class="line"><span class="keyword">SELECT</span> scenic_id, name, hot_score <span class="keyword">FROM</span> scenic <span class="keyword">ORDER</span> <span class="keyword">BY</span> hot_score <span class="keyword">DESC</span> LIMIT <span class="number">10</span>;</span><br></pre></td></tr></table></figure>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 并发控制:乐观锁</span></span><br><span class="line"><span class="comment">-- 重置房间状态</span></span><br><span class="line"><span class="keyword">UPDATE</span> room <span class="keyword">SET</span> available_count <span class="operator">=</span> <span class="number">5</span>, version <span class="operator">=</span> <span class="number">0</span> <span class="keyword">WHERE</span> room_id <span class="operator">=</span> <span class="number">1</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 连接1</span></span><br><span class="line"><span class="keyword">START</span> TRANSACTION;</span><br><span class="line"><span class="keyword">UPDATE</span> room </span><br><span class="line"><span class="keyword">SET</span> available_count <span class="operator">=</span> available_count <span class="operator">-</span> <span class="number">2</span>,</span><br><span class="line">    version <span class="operator">=</span> version <span class="operator">+</span> <span class="number">1</span></span><br><span class="line"><span class="keyword">WHERE</span> room_id <span class="operator">=</span> <span class="number">1</span> </span><br><span class="line"><span class="keyword">AND</span> version <span class="operator">=</span> <span class="number">0</span>;  </span><br><span class="line"><span class="keyword">COMMIT</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 连接2</span></span><br><span class="line"><span class="keyword">START</span> TRANSACTION;</span><br><span class="line"><span class="keyword">UPDATE</span> room </span><br><span class="line"><span class="keyword">SET</span> available_count <span class="operator">=</span> available_count <span class="operator">-</span> <span class="number">1</span>,</span><br><span class="line">    version <span class="operator">=</span> version <span class="operator">+</span> <span class="number">1</span></span><br><span class="line"><span class="keyword">WHERE</span> room_id <span class="operator">=</span> <span class="number">1</span> </span><br><span class="line"><span class="keyword">AND</span> version <span class="operator">=</span> <span class="number">0</span>;  </span><br><span class="line"><span class="keyword">COMMIT</span>;</span><br></pre></td></tr></table></figure>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 1. 备份用户数据</span></span><br><span class="line"><span class="keyword">CREATE TABLE</span> IF <span class="keyword">NOT</span> <span class="keyword">EXISTS</span> backup_user <span class="keyword">LIKE</span> <span class="keyword">user</span>;</span><br><span class="line"><span class="keyword">TRUNCATE</span> backup_user;</span><br><span class="line"><span class="keyword">INSERT INTO</span> backup_user <span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> <span class="keyword">user</span> <span class="keyword">WHERE</span> user_id <span class="operator">=</span> <span class="number">1</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 2. 记录操作前数据状态 </span></span><br><span class="line"><span class="keyword">SELECT</span> status <span class="keyword">INTO</span> <span class="variable">@old_status</span> <span class="keyword">FROM</span> <span class="keyword">user</span> <span class="keyword">WHERE</span> user_id <span class="operator">=</span> <span class="number">1</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 3. 模拟错误操作</span></span><br><span class="line"><span class="keyword">UPDATE</span> <span class="keyword">user</span> <span class="keyword">SET</span> status <span class="operator">=</span> <span class="string">&#x27;banned&#x27;</span> <span class="keyword">WHERE</span> user_id <span class="operator">=</span> <span class="number">1</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 4. 记录操作日志</span></span><br><span class="line"><span class="keyword">INSERT INTO</span> transactionlog (</span><br><span class="line">    operation_type, table_name, record_id, </span><br><span class="line">    old_data, new_data, user_id, operation_time</span><br><span class="line">) <span class="keyword">VALUES</span> (</span><br><span class="line">    <span class="string">&#x27;UPDATE&#x27;</span>, <span class="string">&#x27;user&#x27;</span>, <span class="number">1</span>, </span><br><span class="line">    <span class="built_in">JSON_OBJECT</span>(<span class="string">&#x27;status&#x27;</span>, <span class="variable">@old_status</span>), </span><br><span class="line">    <span class="built_in">JSON_OBJECT</span>(<span class="string">&#x27;status&#x27;</span>, <span class="string">&#x27;banned&#x27;</span>), </span><br><span class="line">    <span class="number">1</span>, NOW()</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 5. 从备份恢复 </span></span><br><span class="line"><span class="keyword">UPDATE</span> <span class="keyword">user</span> u </span><br><span class="line"><span class="keyword">JOIN</span> backup_user bu <span class="keyword">ON</span> u.user_id <span class="operator">=</span> bu.user_id</span><br><span class="line"><span class="keyword">SET</span> u.status <span class="operator">=</span> bu.status</span><br><span class="line"><span class="keyword">WHERE</span> u.user_id <span class="operator">=</span> <span class="number">1</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 6. 验证恢复结果</span></span><br><span class="line"><span class="keyword">SELECT</span> user_id, username, status <span class="keyword">FROM</span> <span class="keyword">user</span> <span class="keyword">WHERE</span> user_id <span class="operator">=</span> <span class="number">1</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 7. 记录恢复操作</span></span><br><span class="line"><span class="keyword">INSERT INTO</span> recoverylog (</span><br><span class="line">    recovery_time, table_name, recovery_point, status</span><br><span class="line">) <span class="keyword">VALUES</span> (</span><br><span class="line">    NOW(), <span class="string">&#x27;user&#x27;</span>, NOW(), <span class="string">&#x27;success&#x27;</span></span><br><span class="line">);</span><br></pre></td></tr></table></figure>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line">查看当前用户数据</span><br><span class="line">Apply <span class="keyword">to</span> whole.sql</span><br><span class="line">USE <span class="number">016</span>_yhy;</span><br><span class="line"><span class="keyword">SELECT</span> user_id, username, email, status <span class="keyword">FROM</span> <span class="keyword">user</span> LIMIT <span class="number">5</span>;</span><br><span class="line">执行关键数据备份</span><br><span class="line">Apply <span class="keyword">to</span> whole.sql</span><br><span class="line"><span class="comment">-- 执行备份存储过程</span></span><br><span class="line"><span class="keyword">CALL</span> BackupCriticalData();</span><br><span class="line">查看备份日志</span><br><span class="line">Apply <span class="keyword">to</span> whole.sql</span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> backuplog <span class="keyword">ORDER</span> <span class="keyword">BY</span> backup_id <span class="keyword">DESC</span> LIMIT <span class="number">1</span>;</span><br><span class="line">模拟数据损坏（例如误删用户）</span><br><span class="line">Apply <span class="keyword">to</span> whole.sql</span><br><span class="line"><span class="comment">-- 记录当前时间用于恢复点</span></span><br><span class="line"><span class="keyword">SELECT</span> NOW() <span class="keyword">INTO</span> <span class="variable">@recovery_point</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 删除一个用户(请替换为实际存在的用户ID)</span></span><br><span class="line"><span class="keyword">DELETE</span> <span class="keyword">FROM</span> <span class="keyword">user</span> <span class="keyword">WHERE</span> user_id <span class="operator">=</span> <span class="number">1</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 确认用户已删除</span></span><br><span class="line"><span class="keyword">SELECT</span> user_id, username, email, status <span class="keyword">FROM</span> <span class="keyword">user</span> <span class="keyword">WHERE</span> user_id <span class="operator">=</span> <span class="number">1</span>;</span><br><span class="line">执行数据恢复</span><br><span class="line">Apply <span class="keyword">to</span> whole.sql</span><br><span class="line"><span class="comment">-- 使用之前记录的时间点恢复数据</span></span><br><span class="line"><span class="keyword">CALL</span> RecoverData(<span class="variable">@recovery_point</span>);</span><br><span class="line">查看恢复日志</span><br><span class="line">Apply <span class="keyword">to</span> whole.sql</span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> recoverylog <span class="keyword">ORDER</span> <span class="keyword">BY</span> recovery_id <span class="keyword">DESC</span> LIMIT <span class="number">1</span>;</span><br><span class="line">验证数据已恢复</span><br><span class="line">Apply <span class="keyword">to</span> whole.sql</span><br><span class="line"><span class="comment">-- 确认用户数据已恢复</span></span><br><span class="line"><span class="keyword">SELECT</span> user_id, username, email, status <span class="keyword">FROM</span> <span class="keyword">user</span> <span class="keyword">WHERE</span> user_id <span class="operator">=</span> <span class="number">1</span>;</span><br><span class="line">检查恢复操作效果</span><br><span class="line">Apply <span class="keyword">to</span> whole.sql</span><br><span class="line"><span class="comment">-- 查看是否有新的通知生成</span></span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> notification </span><br><span class="line"><span class="keyword">WHERE</span> user_id <span class="operator">=</span> <span class="number">1</span> <span class="keyword">AND</span> created_at <span class="operator">&gt;</span> <span class="variable">@recovery_point</span> </span><br><span class="line"><span class="keyword">ORDER</span> <span class="keyword">BY</span> notification_id <span class="keyword">DESC</span> LIMIT <span class="number">5</span>;</span><br></pre></td></tr></table></figure>
<p>| 表名 | 锁类型 | 实现字段 | 实现方式       | 触发条件                                                 |<br>
| ---- | ------ | -------- | -------------- | -------------------------------------------------------- |<br>
| room | 乐观锁 | version  | 整数版本号自增 | 在预订房间后通过 after_booking_room 触发器自动增加版本号 |</p>
<p>| 视图名称                  | 功能描述                               | 基础表                                       | 主要字段                                               |<br>
| ------------------------- | -------------------------------------- | -------------------------------------------- | ------------------------------------------------------ |<br>
| view_bookingdetails       | 预订详情信息，包括用户、景点和酒店信息 | booking, user, scenic, hotel                 | 预订信息、用户信息、景点信息、酒店信息                 |<br>
| view_cityscenicstats      | 各城市景点统计数据                     | scenic                                       | 城市、景点数量、平均价格、最低价格、最高价格、平均热度 |<br>
| view_hotstrategies        | 热门攻略列表，按热度排序               | strategy, user                               | 攻略信息、作者信息、点赞和浏览量                       |<br>
| view_itineraryitemdetails | 行程项目详细信息                       | itineraryitem, scenic, hotel, transport      | 行程项目信息、景点信息、酒店信息、交通信息             |<br>
| view_personalizedscenic   | 个性化景点推荐                         | user, userpreference, scenic                 | 用户信息、偏好城市内的景点信息                         |<br>
| view_useractivity         | 用户活动统计                           | user, strategy, booking, customizeditinerary | 用户信息、攻略数量、预订数量、行程数量、活跃度评分     |<br>
| view_useritineraries      | 用户行程统计信息                       | customizeditinerary, itineraryitem           | 行程信息、项目总数、景点数、酒店数、交通数、活动数     |</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">&lt;</span>svg width<span class="operator">=</span>&quot;480&quot; height<span class="operator">=</span>&quot;840&quot; xmlns<span class="operator">=</span>&quot;http://www.w3.org/2000/svg&quot;<span class="operator">&gt;</span></span><br><span class="line">  <span class="operator">&lt;</span><span class="operator">!</span><span class="comment">-- 整体大框 --&gt;</span></span><br><span class="line">  <span class="operator">&lt;</span>rect x<span class="operator">=</span>&quot;20&quot; y<span class="operator">=</span>&quot;20&quot; width<span class="operator">=</span>&quot;440&quot; height<span class="operator">=</span>&quot;820&quot; rx<span class="operator">=</span>&quot;15&quot; ry<span class="operator">=</span>&quot;15&quot; fill<span class="operator">=</span>&quot;none&quot; stroke<span class="operator">=</span>&quot;#333366&quot; stroke<span class="operator">-</span>width<span class="operator">=</span>&quot;2&quot; stroke<span class="operator">-</span>dasharray<span class="operator">=</span>&quot;5,5&quot; <span class="operator">/</span><span class="operator">&gt;</span></span><br><span class="line">  </span><br><span class="line">  <span class="operator">&lt;</span><span class="operator">!</span><span class="comment">-- 标题 --&gt;</span></span><br><span class="line">  <span class="operator">&lt;</span>text x<span class="operator">=</span>&quot;240&quot; y<span class="operator">=</span>&quot;50&quot; font<span class="operator">-</span>family<span class="operator">=</span>&quot;&#x27;Microsoft YaHei&#x27;, sans-serif&quot; font<span class="operator">-</span>size<span class="operator">=</span>&quot;24&quot; text<span class="operator">-</span>anchor<span class="operator">=</span>&quot;middle&quot; fill<span class="operator">=</span>&quot;#333366&quot; font<span class="operator">-</span>weight<span class="operator">=</span>&quot;bold&quot;<span class="operator">&gt;</span>旅游系统前台功能架构<span class="operator">&lt;</span><span class="operator">/</span>text<span class="operator">&gt;</span></span><br><span class="line">  </span><br><span class="line">  <span class="operator">&lt;</span><span class="operator">!</span><span class="comment">-- 核心功能标题 --&gt;</span></span><br><span class="line">  <span class="operator">&lt;</span>rect x<span class="operator">=</span>&quot;40&quot; y<span class="operator">=</span>&quot;70&quot; width<span class="operator">=</span>&quot;400&quot; height<span class="operator">=</span>&quot;60&quot; rx<span class="operator">=</span>&quot;10&quot; ry<span class="operator">=</span>&quot;10&quot; fill<span class="operator">=</span>&quot;#5B6BBF&quot; <span class="operator">/</span><span class="operator">&gt;</span></span><br><span class="line">  <span class="operator">&lt;</span>text x<span class="operator">=</span>&quot;240&quot; y<span class="operator">=</span>&quot;110&quot; font<span class="operator">-</span>family<span class="operator">=</span>&quot;&#x27;Microsoft YaHei&#x27;, sans-serif&quot; font<span class="operator">-</span>size<span class="operator">=</span>&quot;20&quot; text<span class="operator">-</span>anchor<span class="operator">=</span>&quot;middle&quot; fill<span class="operator">=</span>&quot;white&quot;<span class="operator">&gt;</span>用户旅游服务中心<span class="operator">&lt;</span><span class="operator">/</span>text<span class="operator">&gt;</span></span><br><span class="line">  </span><br><span class="line">  <span class="operator">&lt;</span><span class="operator">!</span><span class="comment">-- 第一功能模块虚线框 --&gt;</span></span><br><span class="line">  <span class="operator">&lt;</span>rect x<span class="operator">=</span>&quot;35&quot; y<span class="operator">=</span>&quot;145&quot; width<span class="operator">=</span>&quot;410&quot; height<span class="operator">=</span>&quot;180&quot; rx<span class="operator">=</span>&quot;10&quot; ry<span class="operator">=</span>&quot;10&quot; fill<span class="operator">=</span>&quot;none&quot; stroke<span class="operator">=</span>&quot;#4A9BDC&quot; stroke<span class="operator">-</span>width<span class="operator">=</span>&quot;2&quot; stroke<span class="operator">-</span>dasharray<span class="operator">=</span>&quot;5,3&quot; <span class="operator">/</span><span class="operator">&gt;</span></span><br><span class="line">  </span><br><span class="line">  <span class="operator">&lt;</span><span class="operator">!</span><span class="comment">-- 第一功能模块 --&gt;</span></span><br><span class="line">  <span class="operator">&lt;</span>rect x<span class="operator">=</span>&quot;40&quot; y<span class="operator">=</span>&quot;150&quot; width<span class="operator">=</span>&quot;400&quot; height<span class="operator">=</span>&quot;50&quot; rx<span class="operator">=</span>&quot;10&quot; ry<span class="operator">=</span>&quot;10&quot; fill<span class="operator">=</span>&quot;#4A9BDC&quot; <span class="operator">/</span><span class="operator">&gt;</span></span><br><span class="line">  <span class="operator">&lt;</span>text x<span class="operator">=</span>&quot;240&quot; y<span class="operator">=</span>&quot;183&quot; font<span class="operator">-</span>family<span class="operator">=</span>&quot;&#x27;Microsoft YaHei&#x27;, sans-serif&quot; font<span class="operator">-</span>size<span class="operator">=</span>&quot;18&quot; text<span class="operator">-</span>anchor<span class="operator">=</span>&quot;middle&quot; fill<span class="operator">=</span>&quot;white&quot;<span class="operator">&gt;</span>景点与酒店管理<span class="operator">&lt;</span><span class="operator">/</span>text<span class="operator">&gt;</span></span><br><span class="line">  </span><br><span class="line">  <span class="operator">&lt;</span><span class="operator">!</span><span class="comment">-- 第一模块子功能 --&gt;</span></span><br><span class="line">  <span class="operator">&lt;</span>rect x<span class="operator">=</span>&quot;40&quot; y<span class="operator">=</span>&quot;210&quot; width<span class="operator">=</span>&quot;190&quot; height<span class="operator">=</span>&quot;50&quot; rx<span class="operator">=</span>&quot;5&quot; ry<span class="operator">=</span>&quot;5&quot; fill<span class="operator">=</span>&quot;#3A7CA5&quot; <span class="operator">/</span><span class="operator">&gt;</span></span><br><span class="line">  <span class="operator">&lt;</span>text x<span class="operator">=</span>&quot;135&quot; y<span class="operator">=</span>&quot;240&quot; font<span class="operator">-</span>family<span class="operator">=</span>&quot;&#x27;Microsoft YaHei&#x27;, sans-serif&quot; font<span class="operator">-</span>size<span class="operator">=</span>&quot;14&quot; text<span class="operator">-</span>anchor<span class="operator">=</span>&quot;middle&quot; fill<span class="operator">=</span>&quot;white&quot;<span class="operator">&gt;</span>景点浏览与搜索<span class="operator">&lt;</span><span class="operator">/</span>text<span class="operator">&gt;</span></span><br><span class="line">  </span><br><span class="line">  <span class="operator">&lt;</span>rect x<span class="operator">=</span>&quot;250&quot; y<span class="operator">=</span>&quot;210&quot; width<span class="operator">=</span>&quot;190&quot; height<span class="operator">=</span>&quot;50&quot; rx<span class="operator">=</span>&quot;5&quot; ry<span class="operator">=</span>&quot;5&quot; fill<span class="operator">=</span>&quot;#3A7CA5&quot; <span class="operator">/</span><span class="operator">&gt;</span></span><br><span class="line">  <span class="operator">&lt;</span>text x<span class="operator">=</span>&quot;345&quot; y<span class="operator">=</span>&quot;240&quot; font<span class="operator">-</span>family<span class="operator">=</span>&quot;&#x27;Microsoft YaHei&#x27;, sans-serif&quot; font<span class="operator">-</span>size<span class="operator">=</span>&quot;14&quot; text<span class="operator">-</span>anchor<span class="operator">=</span>&quot;middle&quot; fill<span class="operator">=</span>&quot;white&quot;<span class="operator">&gt;</span>景点详情查看<span class="operator">&lt;</span><span class="operator">/</span>text<span class="operator">&gt;</span></span><br><span class="line">  </span><br><span class="line">  <span class="operator">&lt;</span>rect x<span class="operator">=</span>&quot;40&quot; y<span class="operator">=</span>&quot;270&quot; width<span class="operator">=</span>&quot;190&quot; height<span class="operator">=</span>&quot;50&quot; rx<span class="operator">=</span>&quot;5&quot; ry<span class="operator">=</span>&quot;5&quot; fill<span class="operator">=</span>&quot;#3A7CA5&quot; <span class="operator">/</span><span class="operator">&gt;</span></span><br><span class="line">  <span class="operator">&lt;</span>text x<span class="operator">=</span>&quot;135&quot; y<span class="operator">=</span>&quot;300&quot; font<span class="operator">-</span>family<span class="operator">=</span>&quot;&#x27;Microsoft YaHei&#x27;, sans-serif&quot; font<span class="operator">-</span>size<span class="operator">=</span>&quot;14&quot; text<span class="operator">-</span>anchor<span class="operator">=</span>&quot;middle&quot; fill<span class="operator">=</span>&quot;white&quot;<span class="operator">&gt;</span>酒店房型查询<span class="operator">&lt;</span><span class="operator">/</span>text<span class="operator">&gt;</span></span><br><span class="line">  </span><br><span class="line">  <span class="operator">&lt;</span>rect x<span class="operator">=</span>&quot;250&quot; y<span class="operator">=</span>&quot;270&quot; width<span class="operator">=</span>&quot;190&quot; height<span class="operator">=</span>&quot;50&quot; rx<span class="operator">=</span>&quot;5&quot; ry<span class="operator">=</span>&quot;5&quot; fill<span class="operator">=</span>&quot;#3A7CA5&quot; <span class="operator">/</span><span class="operator">&gt;</span></span><br><span class="line">  <span class="operator">&lt;</span>text x<span class="operator">=</span>&quot;345&quot; y<span class="operator">=</span>&quot;300&quot; font<span class="operator">-</span>family<span class="operator">=</span>&quot;&#x27;Microsoft YaHei&#x27;, sans-serif&quot; font<span class="operator">-</span>size<span class="operator">=</span>&quot;14&quot; text<span class="operator">-</span>anchor<span class="operator">=</span>&quot;middle&quot; fill<span class="operator">=</span>&quot;white&quot;<span class="operator">&gt;</span>酒店筛选与比较<span class="operator">&lt;</span><span class="operator">/</span>text<span class="operator">&gt;</span></span><br><span class="line">  </span><br><span class="line">  <span class="operator">&lt;</span><span class="operator">!</span><span class="comment">-- 第二功能模块虚线框 --&gt;</span></span><br><span class="line">  <span class="operator">&lt;</span>rect x<span class="operator">=</span>&quot;35&quot; y<span class="operator">=</span>&quot;335&quot; width<span class="operator">=</span>&quot;410&quot; height<span class="operator">=</span>&quot;180&quot; rx<span class="operator">=</span>&quot;10&quot; ry<span class="operator">=</span>&quot;10&quot; fill<span class="operator">=</span>&quot;none&quot; stroke<span class="operator">=</span>&quot;#4CAF50&quot; stroke<span class="operator">-</span>width<span class="operator">=</span>&quot;2&quot; stroke<span class="operator">-</span>dasharray<span class="operator">=</span>&quot;5,3&quot; <span class="operator">/</span><span class="operator">&gt;</span></span><br><span class="line">  </span><br><span class="line">  <span class="operator">&lt;</span><span class="operator">!</span><span class="comment">-- 第二功能模块 --&gt;</span></span><br><span class="line">  <span class="operator">&lt;</span>rect x<span class="operator">=</span>&quot;40&quot; y<span class="operator">=</span>&quot;340&quot; width<span class="operator">=</span>&quot;400&quot; height<span class="operator">=</span>&quot;50&quot; rx<span class="operator">=</span>&quot;10&quot; ry<span class="operator">=</span>&quot;10&quot; fill<span class="operator">=</span>&quot;#4CAF50&quot; <span class="operator">/</span><span class="operator">&gt;</span></span><br><span class="line">  <span class="operator">&lt;</span>text x<span class="operator">=</span>&quot;240&quot; y<span class="operator">=</span>&quot;373&quot; font<span class="operator">-</span>family<span class="operator">=</span>&quot;&#x27;Microsoft YaHei&#x27;, sans-serif&quot; font<span class="operator">-</span>size<span class="operator">=</span>&quot;18&quot; text<span class="operator">-</span>anchor<span class="operator">=</span>&quot;middle&quot; fill<span class="operator">=</span>&quot;white&quot;<span class="operator">&gt;</span>个性化行程系统<span class="operator">&lt;</span><span class="operator">/</span>text<span class="operator">&gt;</span></span><br><span class="line">  </span><br><span class="line">  <span class="operator">&lt;</span><span class="operator">!</span><span class="comment">-- 第二模块子功能 --&gt;</span></span><br><span class="line">  <span class="operator">&lt;</span>rect x<span class="operator">=</span>&quot;40&quot; y<span class="operator">=</span>&quot;400&quot; width<span class="operator">=</span>&quot;190&quot; height<span class="operator">=</span>&quot;50&quot; rx<span class="operator">=</span>&quot;5&quot; ry<span class="operator">=</span>&quot;5&quot; fill<span class="operator">=</span>&quot;#3E9641&quot; <span class="operator">/</span><span class="operator">&gt;</span></span><br><span class="line">  <span class="operator">&lt;</span>text x<span class="operator">=</span>&quot;135&quot; y<span class="operator">=</span>&quot;430&quot; font<span class="operator">-</span>family<span class="operator">=</span>&quot;&#x27;Microsoft YaHei&#x27;, sans-serif&quot; font<span class="operator">-</span>size<span class="operator">=</span>&quot;14&quot; text<span class="operator">-</span>anchor<span class="operator">=</span>&quot;middle&quot; fill<span class="operator">=</span>&quot;white&quot;<span class="operator">&gt;</span>行程创建与编辑<span class="operator">&lt;</span><span class="operator">/</span>text<span class="operator">&gt;</span></span><br><span class="line">  </span><br><span class="line">  <span class="operator">&lt;</span>rect x<span class="operator">=</span>&quot;250&quot; y<span class="operator">=</span>&quot;400&quot; width<span class="operator">=</span>&quot;190&quot; height<span class="operator">=</span>&quot;50&quot; rx<span class="operator">=</span>&quot;5&quot; ry<span class="operator">=</span>&quot;5&quot; fill<span class="operator">=</span>&quot;#3E9641&quot; <span class="operator">/</span><span class="operator">&gt;</span></span><br><span class="line">  <span class="operator">&lt;</span>text x<span class="operator">=</span>&quot;345&quot; y<span class="operator">=</span>&quot;430&quot; font<span class="operator">-</span>family<span class="operator">=</span>&quot;&#x27;Microsoft YaHei&#x27;, sans-serif&quot; font<span class="operator">-</span>size<span class="operator">=</span>&quot;14&quot; text<span class="operator">-</span>anchor<span class="operator">=</span>&quot;middle&quot; fill<span class="operator">=</span>&quot;white&quot;<span class="operator">&gt;</span>拖拽式规划<span class="operator">&lt;</span><span class="operator">/</span>text<span class="operator">&gt;</span></span><br><span class="line">  </span><br><span class="line">  <span class="operator">&lt;</span>rect x<span class="operator">=</span>&quot;40&quot; y<span class="operator">=</span>&quot;460&quot; width<span class="operator">=</span>&quot;190&quot; height<span class="operator">=</span>&quot;50&quot; rx<span class="operator">=</span>&quot;5&quot; ry<span class="operator">=</span>&quot;5&quot; fill<span class="operator">=</span>&quot;#3E9641&quot; <span class="operator">/</span><span class="operator">&gt;</span></span><br><span class="line">  <span class="operator">&lt;</span>text x<span class="operator">=</span>&quot;135&quot; y<span class="operator">=</span>&quot;490&quot; font<span class="operator">-</span>family<span class="operator">=</span>&quot;&#x27;Microsoft YaHei&#x27;, sans-serif&quot; font<span class="operator">-</span>size<span class="operator">=</span>&quot;14&quot; text<span class="operator">-</span>anchor<span class="operator">=</span>&quot;middle&quot; fill<span class="operator">=</span>&quot;white&quot;<span class="operator">&gt;</span>地图路线可视化<span class="operator">&lt;</span><span class="operator">/</span>text<span class="operator">&gt;</span></span><br><span class="line">  </span><br><span class="line">  <span class="operator">&lt;</span>rect x<span class="operator">=</span>&quot;250&quot; y<span class="operator">=</span>&quot;460&quot; width<span class="operator">=</span>&quot;190&quot; height<span class="operator">=</span>&quot;50&quot; rx<span class="operator">=</span>&quot;5&quot; ry<span class="operator">=</span>&quot;5&quot; fill<span class="operator">=</span>&quot;#3E9641&quot; <span class="operator">/</span><span class="operator">&gt;</span></span><br><span class="line">  <span class="operator">&lt;</span>text x<span class="operator">=</span>&quot;345&quot; y<span class="operator">=</span>&quot;490&quot; font<span class="operator">-</span>family<span class="operator">=</span>&quot;&#x27;Microsoft YaHei&#x27;, sans-serif&quot; font<span class="operator">-</span>size<span class="operator">=</span>&quot;14&quot; text<span class="operator">-</span>anchor<span class="operator">=</span>&quot;middle&quot; fill<span class="operator">=</span>&quot;white&quot;<span class="operator">&gt;</span>行程分享与保存<span class="operator">&lt;</span><span class="operator">/</span>text<span class="operator">&gt;</span></span><br><span class="line">  </span><br><span class="line">  <span class="operator">&lt;</span><span class="operator">!</span><span class="comment">-- 第三功能模块虚线框 --&gt;</span></span><br><span class="line">  <span class="operator">&lt;</span>rect x<span class="operator">=</span>&quot;35&quot; y<span class="operator">=</span>&quot;525&quot; width<span class="operator">=</span>&quot;410&quot; height<span class="operator">=</span>&quot;180&quot; rx<span class="operator">=</span>&quot;10&quot; ry<span class="operator">=</span>&quot;10&quot; fill<span class="operator">=</span>&quot;none&quot; stroke<span class="operator">=</span>&quot;#FF9966&quot; stroke<span class="operator">-</span>width<span class="operator">=</span>&quot;2&quot; stroke<span class="operator">-</span>dasharray<span class="operator">=</span>&quot;5,3&quot; <span class="operator">/</span><span class="operator">&gt;</span></span><br><span class="line">  </span><br><span class="line">  <span class="operator">&lt;</span><span class="operator">!</span><span class="comment">-- 第三功能模块 --&gt;</span></span><br><span class="line">  <span class="operator">&lt;</span>rect x<span class="operator">=</span>&quot;40&quot; y<span class="operator">=</span>&quot;530&quot; width<span class="operator">=</span>&quot;400&quot; height<span class="operator">=</span>&quot;50&quot; rx<span class="operator">=</span>&quot;10&quot; ry<span class="operator">=</span>&quot;10&quot; fill<span class="operator">=</span>&quot;#FF9966&quot; <span class="operator">/</span><span class="operator">&gt;</span></span><br><span class="line">  <span class="operator">&lt;</span>text x<span class="operator">=</span>&quot;240&quot; y<span class="operator">=</span>&quot;563&quot; font<span class="operator">-</span>family<span class="operator">=</span>&quot;&#x27;Microsoft YaHei&#x27;, sans-serif&quot; font<span class="operator">-</span>size<span class="operator">=</span>&quot;18&quot; text<span class="operator">-</span>anchor<span class="operator">=</span>&quot;middle&quot; fill<span class="operator">=</span>&quot;white&quot;<span class="operator">&gt;</span>预订与支付系统<span class="operator">&lt;</span><span class="operator">/</span>text<span class="operator">&gt;</span></span><br><span class="line">  </span><br><span class="line">  <span class="operator">&lt;</span><span class="operator">!</span><span class="comment">-- 第三模块子功能 --&gt;</span></span><br><span class="line">  <span class="operator">&lt;</span>rect x<span class="operator">=</span>&quot;40&quot; y<span class="operator">=</span>&quot;590&quot; width<span class="operator">=</span>&quot;190&quot; height<span class="operator">=</span>&quot;50&quot; rx<span class="operator">=</span>&quot;5&quot; ry<span class="operator">=</span>&quot;5&quot; fill<span class="operator">=</span>&quot;#E67E22&quot; <span class="operator">/</span><span class="operator">&gt;</span></span><br><span class="line">  <span class="operator">&lt;</span>text x<span class="operator">=</span>&quot;135&quot; y<span class="operator">=</span>&quot;620&quot; font<span class="operator">-</span>family<span class="operator">=</span>&quot;&#x27;Microsoft YaHei&#x27;, sans-serif&quot; font<span class="operator">-</span>size<span class="operator">=</span>&quot;14&quot; text<span class="operator">-</span>anchor<span class="operator">=</span>&quot;middle&quot; fill<span class="operator">=</span>&quot;white&quot;<span class="operator">&gt;</span>景点门票预订<span class="operator">&lt;</span><span class="operator">/</span>text<span class="operator">&gt;</span></span><br><span class="line">  </span><br><span class="line">  <span class="operator">&lt;</span>rect x<span class="operator">=</span>&quot;250&quot; y<span class="operator">=</span>&quot;590&quot; width<span class="operator">=</span>&quot;190&quot; height<span class="operator">=</span>&quot;50&quot; rx<span class="operator">=</span>&quot;5&quot; ry<span class="operator">=</span>&quot;5&quot; fill<span class="operator">=</span>&quot;#E67E22&quot; <span class="operator">/</span><span class="operator">&gt;</span></span><br><span class="line">  <span class="operator">&lt;</span>text x<span class="operator">=</span>&quot;345&quot; y<span class="operator">=</span>&quot;620&quot; font<span class="operator">-</span>family<span class="operator">=</span>&quot;&#x27;Microsoft YaHei&#x27;, sans-serif&quot; font<span class="operator">-</span>size<span class="operator">=</span>&quot;14&quot; text<span class="operator">-</span>anchor<span class="operator">=</span>&quot;middle&quot; fill<span class="operator">=</span>&quot;white&quot;<span class="operator">&gt;</span>酒店房间预订<span class="operator">&lt;</span><span class="operator">/</span>text<span class="operator">&gt;</span></span><br><span class="line">  </span><br><span class="line">  <span class="operator">&lt;</span>rect x<span class="operator">=</span>&quot;40&quot; y<span class="operator">=</span>&quot;650&quot; width<span class="operator">=</span>&quot;190&quot; height<span class="operator">=</span>&quot;50&quot; rx<span class="operator">=</span>&quot;5&quot; ry<span class="operator">=</span>&quot;5&quot; fill<span class="operator">=</span>&quot;#E67E22&quot; <span class="operator">/</span><span class="operator">&gt;</span></span><br><span class="line">  <span class="operator">&lt;</span>text x<span class="operator">=</span>&quot;135&quot; y<span class="operator">=</span>&quot;680&quot; font<span class="operator">-</span>family<span class="operator">=</span>&quot;&#x27;Microsoft YaHei&#x27;, sans-serif&quot; font<span class="operator">-</span>size<span class="operator">=</span>&quot;14&quot; text<span class="operator">-</span>anchor<span class="operator">=</span>&quot;middle&quot; fill<span class="operator">=</span>&quot;white&quot;<span class="operator">&gt;</span>在线支付处理<span class="operator">&lt;</span><span class="operator">/</span>text<span class="operator">&gt;</span></span><br><span class="line">  </span><br><span class="line">  <span class="operator">&lt;</span>rect x<span class="operator">=</span>&quot;250&quot; y<span class="operator">=</span>&quot;650&quot; width<span class="operator">=</span>&quot;190&quot; height<span class="operator">=</span>&quot;50&quot; rx<span class="operator">=</span>&quot;5&quot; ry<span class="operator">=</span>&quot;5&quot; fill<span class="operator">=</span>&quot;#E67E22&quot; <span class="operator">/</span><span class="operator">&gt;</span></span><br><span class="line">  <span class="operator">&lt;</span>text x<span class="operator">=</span>&quot;345&quot; y<span class="operator">=</span>&quot;680&quot; font<span class="operator">-</span>family<span class="operator">=</span>&quot;&#x27;Microsoft YaHei&#x27;, sans-serif&quot; font<span class="operator">-</span>size<span class="operator">=</span>&quot;14&quot; text<span class="operator">-</span>anchor<span class="operator">=</span>&quot;middle&quot; fill<span class="operator">=</span>&quot;white&quot;<span class="operator">&gt;</span>订单管理与跟踪<span class="operator">&lt;</span><span class="operator">/</span>text<span class="operator">&gt;</span></span><br><span class="line">  </span><br><span class="line">  <span class="operator">&lt;</span><span class="operator">!</span><span class="comment">-- 第四功能模块虚线框 --&gt;</span></span><br><span class="line">  <span class="operator">&lt;</span>rect x<span class="operator">=</span>&quot;35&quot; y<span class="operator">=</span>&quot;715&quot; width<span class="operator">=</span>&quot;410&quot; height<span class="operator">=</span>&quot;120&quot; rx<span class="operator">=</span>&quot;10&quot; ry<span class="operator">=</span>&quot;10&quot; fill<span class="operator">=</span>&quot;none&quot; stroke<span class="operator">=</span>&quot;#9C27B0&quot; stroke<span class="operator">-</span>width<span class="operator">=</span>&quot;2&quot; stroke<span class="operator">-</span>dasharray<span class="operator">=</span>&quot;5,3&quot; <span class="operator">/</span><span class="operator">&gt;</span></span><br><span class="line">  </span><br><span class="line">  <span class="operator">&lt;</span><span class="operator">!</span><span class="comment">-- 第四功能模块 --&gt;</span></span><br><span class="line">  <span class="operator">&lt;</span>rect x<span class="operator">=</span>&quot;40&quot; y<span class="operator">=</span>&quot;720&quot; width<span class="operator">=</span>&quot;400&quot; height<span class="operator">=</span>&quot;50&quot; rx<span class="operator">=</span>&quot;10&quot; ry<span class="operator">=</span>&quot;10&quot; fill<span class="operator">=</span>&quot;#9C27B0&quot; <span class="operator">/</span><span class="operator">&gt;</span></span><br><span class="line">  <span class="operator">&lt;</span>text x<span class="operator">=</span>&quot;240&quot; y<span class="operator">=</span>&quot;753&quot; font<span class="operator">-</span>family<span class="operator">=</span>&quot;&#x27;Microsoft YaHei&#x27;, sans-serif&quot; font<span class="operator">-</span>size<span class="operator">=</span>&quot;18&quot; text<span class="operator">-</span>anchor<span class="operator">=</span>&quot;middle&quot; fill<span class="operator">=</span>&quot;white&quot;<span class="operator">&gt;</span>社区互动平台<span class="operator">&lt;</span><span class="operator">/</span>text<span class="operator">&gt;</span></span><br><span class="line">  </span><br><span class="line">  <span class="operator">&lt;</span><span class="operator">!</span><span class="comment">-- 第四模块子功能 --&gt;</span></span><br><span class="line">  <span class="operator">&lt;</span>rect x<span class="operator">=</span>&quot;40&quot; y<span class="operator">=</span>&quot;780&quot; width<span class="operator">=</span>&quot;190&quot; height<span class="operator">=</span>&quot;50&quot; rx<span class="operator">=</span>&quot;5&quot; ry<span class="operator">=</span>&quot;5&quot; fill<span class="operator">=</span>&quot;#8E24AA&quot; <span class="operator">/</span><span class="operator">&gt;</span></span><br><span class="line">  <span class="operator">&lt;</span>text x<span class="operator">=</span>&quot;135&quot; y<span class="operator">=</span>&quot;810&quot; font<span class="operator">-</span>family<span class="operator">=</span>&quot;&#x27;Microsoft YaHei&#x27;, sans-serif&quot; font<span class="operator">-</span>size<span class="operator">=</span>&quot;14&quot; text<span class="operator">-</span>anchor<span class="operator">=</span>&quot;middle&quot; fill<span class="operator">=</span>&quot;white&quot;<span class="operator">&gt;</span>攻略浏览与发布<span class="operator">&lt;</span><span class="operator">/</span>text<span class="operator">&gt;</span></span><br><span class="line">  </span><br><span class="line">  <span class="operator">&lt;</span>rect x<span class="operator">=</span>&quot;250&quot; y<span class="operator">=</span>&quot;780&quot; width<span class="operator">=</span>&quot;190&quot; height<span class="operator">=</span>&quot;50&quot; rx<span class="operator">=</span>&quot;5&quot; ry<span class="operator">=</span>&quot;5&quot; fill<span class="operator">=</span>&quot;#8E24AA&quot; <span class="operator">/</span><span class="operator">&gt;</span></span><br><span class="line">  <span class="operator">&lt;</span>text x<span class="operator">=</span>&quot;345&quot; y<span class="operator">=</span>&quot;810&quot; font<span class="operator">-</span>family<span class="operator">=</span>&quot;&#x27;Microsoft YaHei&#x27;, sans-serif&quot; font<span class="operator">-</span>size<span class="operator">=</span>&quot;14&quot; text<span class="operator">-</span>anchor<span class="operator">=</span>&quot;middle&quot; fill<span class="operator">=</span>&quot;white&quot;<span class="operator">&gt;</span>评论与点赞功能<span class="operator">&lt;</span><span class="operator">/</span>text<span class="operator">&gt;</span></span><br><span class="line"><span class="operator">&lt;</span><span class="operator">/</span>svg<span class="operator">&gt;</span></span><br></pre></td></tr></table></figure>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">&lt;</span>svg width<span class="operator">=</span>&quot;480&quot; height<span class="operator">=</span>&quot;840&quot; xmlns<span class="operator">=</span>&quot;http://www.w3.org/2000/svg&quot;<span class="operator">&gt;</span></span><br><span class="line">  <span class="operator">&lt;</span><span class="operator">!</span><span class="comment">-- 整体大框 --&gt;</span></span><br><span class="line">  <span class="operator">&lt;</span>rect x<span class="operator">=</span>&quot;20&quot; y<span class="operator">=</span>&quot;20&quot; width<span class="operator">=</span>&quot;440&quot; height<span class="operator">=</span>&quot;820&quot; rx<span class="operator">=</span>&quot;15&quot; ry<span class="operator">=</span>&quot;15&quot; fill<span class="operator">=</span>&quot;none&quot; stroke<span class="operator">=</span>&quot;#333366&quot; stroke<span class="operator">-</span>width<span class="operator">=</span>&quot;2&quot; stroke<span class="operator">-</span>dasharray<span class="operator">=</span>&quot;5,5&quot; <span class="operator">/</span><span class="operator">&gt;</span></span><br><span class="line">  </span><br><span class="line">  <span class="operator">&lt;</span><span class="operator">!</span><span class="comment">-- 标题 --&gt;</span></span><br><span class="line">  <span class="operator">&lt;</span>text x<span class="operator">=</span>&quot;240&quot; y<span class="operator">=</span>&quot;50&quot; font<span class="operator">-</span>family<span class="operator">=</span>&quot;&#x27;Microsoft YaHei&#x27;, sans-serif&quot; font<span class="operator">-</span>size<span class="operator">=</span>&quot;24&quot; text<span class="operator">-</span>anchor<span class="operator">=</span>&quot;middle&quot; fill<span class="operator">=</span>&quot;#333366&quot; font<span class="operator">-</span>weight<span class="operator">=</span>&quot;bold&quot;<span class="operator">&gt;</span>旅游系统后台管理架构<span class="operator">&lt;</span><span class="operator">/</span>text<span class="operator">&gt;</span></span><br><span class="line">  </span><br><span class="line">  <span class="operator">&lt;</span><span class="operator">!</span><span class="comment">-- 核心功能标题 --&gt;</span></span><br><span class="line">  <span class="operator">&lt;</span>rect x<span class="operator">=</span>&quot;40&quot; y<span class="operator">=</span>&quot;70&quot; width<span class="operator">=</span>&quot;400&quot; height<span class="operator">=</span>&quot;60&quot; rx<span class="operator">=</span>&quot;10&quot; ry<span class="operator">=</span>&quot;10&quot; fill<span class="operator">=</span>&quot;#5B6BBF&quot; <span class="operator">/</span><span class="operator">&gt;</span></span><br><span class="line">  <span class="operator">&lt;</span>text x<span class="operator">=</span>&quot;240&quot; y<span class="operator">=</span>&quot;110&quot; font<span class="operator">-</span>family<span class="operator">=</span>&quot;&#x27;Microsoft YaHei&#x27;, sans-serif&quot; font<span class="operator">-</span>size<span class="operator">=</span>&quot;20&quot; text<span class="operator">-</span>anchor<span class="operator">=</span>&quot;middle&quot; fill<span class="operator">=</span>&quot;white&quot;<span class="operator">&gt;</span>综合管理控制中心<span class="operator">&lt;</span><span class="operator">/</span>text<span class="operator">&gt;</span></span><br><span class="line">  </span><br><span class="line">  <span class="operator">&lt;</span><span class="operator">!</span><span class="comment">-- 第一功能模块虚线框 --&gt;</span></span><br><span class="line">  <span class="operator">&lt;</span>rect x<span class="operator">=</span>&quot;35&quot; y<span class="operator">=</span>&quot;145&quot; width<span class="operator">=</span>&quot;410&quot; height<span class="operator">=</span>&quot;180&quot; rx<span class="operator">=</span>&quot;10&quot; ry<span class="operator">=</span>&quot;10&quot; fill<span class="operator">=</span>&quot;none&quot; stroke<span class="operator">=</span>&quot;#4A9BDC&quot; stroke<span class="operator">-</span>width<span class="operator">=</span>&quot;2&quot; stroke<span class="operator">-</span>dasharray<span class="operator">=</span>&quot;5,3&quot; <span class="operator">/</span><span class="operator">&gt;</span></span><br><span class="line">  </span><br><span class="line">  <span class="operator">&lt;</span><span class="operator">!</span><span class="comment">-- 第一功能模块 --&gt;</span></span><br><span class="line">  <span class="operator">&lt;</span>rect x<span class="operator">=</span>&quot;40&quot; y<span class="operator">=</span>&quot;150&quot; width<span class="operator">=</span>&quot;400&quot; height<span class="operator">=</span>&quot;50&quot; rx<span class="operator">=</span>&quot;10&quot; ry<span class="operator">=</span>&quot;10&quot; fill<span class="operator">=</span>&quot;#4A9BDC&quot; <span class="operator">/</span><span class="operator">&gt;</span></span><br><span class="line">  <span class="operator">&lt;</span>text x<span class="operator">=</span>&quot;240&quot; y<span class="operator">=</span>&quot;183&quot; font<span class="operator">-</span>family<span class="operator">=</span>&quot;&#x27;Microsoft YaHei&#x27;, sans-serif&quot; font<span class="operator">-</span>size<span class="operator">=</span>&quot;18&quot; text<span class="operator">-</span>anchor<span class="operator">=</span>&quot;middle&quot; fill<span class="operator">=</span>&quot;white&quot;<span class="operator">&gt;</span>数据仪表盘<span class="operator">&lt;</span><span class="operator">/</span>text<span class="operator">&gt;</span></span><br><span class="line">  </span><br><span class="line">  <span class="operator">&lt;</span><span class="operator">!</span><span class="comment">-- 第一模块子功能 --&gt;</span></span><br><span class="line">  <span class="operator">&lt;</span>rect x<span class="operator">=</span>&quot;40&quot; y<span class="operator">=</span>&quot;210&quot; width<span class="operator">=</span>&quot;190&quot; height<span class="operator">=</span>&quot;50&quot; rx<span class="operator">=</span>&quot;5&quot; ry<span class="operator">=</span>&quot;5&quot; fill<span class="operator">=</span>&quot;#3A7CA5&quot; <span class="operator">/</span><span class="operator">&gt;</span></span><br><span class="line">  <span class="operator">&lt;</span>text x<span class="operator">=</span>&quot;135&quot; y<span class="operator">=</span>&quot;240&quot; font<span class="operator">-</span>family<span class="operator">=</span>&quot;&#x27;Microsoft YaHei&#x27;, sans-serif&quot; font<span class="operator">-</span>size<span class="operator">=</span>&quot;14&quot; text<span class="operator">-</span>anchor<span class="operator">=</span>&quot;middle&quot; fill<span class="operator">=</span>&quot;white&quot;<span class="operator">&gt;</span>运营数据统计<span class="operator">&lt;</span><span class="operator">/</span>text<span class="operator">&gt;</span></span><br><span class="line">  </span><br><span class="line">  <span class="operator">&lt;</span>rect x<span class="operator">=</span>&quot;250&quot; y<span class="operator">=</span>&quot;210&quot; width<span class="operator">=</span>&quot;190&quot; height<span class="operator">=</span>&quot;50&quot; rx<span class="operator">=</span>&quot;5&quot; ry<span class="operator">=</span>&quot;5&quot; fill<span class="operator">=</span>&quot;#3A7CA5&quot; <span class="operator">/</span><span class="operator">&gt;</span></span><br><span class="line">  <span class="operator">&lt;</span>text x<span class="operator">=</span>&quot;345&quot; y<span class="operator">=</span>&quot;240&quot; font<span class="operator">-</span>family<span class="operator">=</span>&quot;&#x27;Microsoft YaHei&#x27;, sans-serif&quot; font<span class="operator">-</span>size<span class="operator">=</span>&quot;14&quot; text<span class="operator">-</span>anchor<span class="operator">=</span>&quot;middle&quot; fill<span class="operator">=</span>&quot;white&quot;<span class="operator">&gt;</span>预订转化分析<span class="operator">&lt;</span><span class="operator">/</span>text<span class="operator">&gt;</span></span><br><span class="line">  </span><br><span class="line">  <span class="operator">&lt;</span>rect x<span class="operator">=</span>&quot;40&quot; y<span class="operator">=</span>&quot;270&quot; width<span class="operator">=</span>&quot;190&quot; height<span class="operator">=</span>&quot;50&quot; rx<span class="operator">=</span>&quot;5&quot; ry<span class="operator">=</span>&quot;5&quot; fill<span class="operator">=</span>&quot;#3A7CA5&quot; <span class="operator">/</span><span class="operator">&gt;</span></span><br><span class="line">  <span class="operator">&lt;</span>text x<span class="operator">=</span>&quot;135&quot; y<span class="operator">=</span>&quot;300&quot; font<span class="operator">-</span>family<span class="operator">=</span>&quot;&#x27;Microsoft YaHei&#x27;, sans-serif&quot; font<span class="operator">-</span>size<span class="operator">=</span>&quot;14&quot; text<span class="operator">-</span>anchor<span class="operator">=</span>&quot;middle&quot; fill<span class="operator">=</span>&quot;white&quot;<span class="operator">&gt;</span>热门景点统计<span class="operator">&lt;</span><span class="operator">/</span>text<span class="operator">&gt;</span></span><br><span class="line">  </span><br><span class="line">  <span class="operator">&lt;</span>rect x<span class="operator">=</span>&quot;250&quot; y<span class="operator">=</span>&quot;270&quot; width<span class="operator">=</span>&quot;190&quot; height<span class="operator">=</span>&quot;50&quot; rx<span class="operator">=</span>&quot;5&quot; ry<span class="operator">=</span>&quot;5&quot; fill<span class="operator">=</span>&quot;#3A7CA5&quot; <span class="operator">/</span><span class="operator">&gt;</span></span><br><span class="line">  <span class="operator">&lt;</span>text x<span class="operator">=</span>&quot;345&quot; y<span class="operator">=</span>&quot;300&quot; font<span class="operator">-</span>family<span class="operator">=</span>&quot;&#x27;Microsoft YaHei&#x27;, sans-serif&quot; font<span class="operator">-</span>size<span class="operator">=</span>&quot;14&quot; text<span class="operator">-</span>anchor<span class="operator">=</span>&quot;middle&quot; fill<span class="operator">=</span>&quot;white&quot;<span class="operator">&gt;</span>收入报表分析<span class="operator">&lt;</span><span class="operator">/</span>text<span class="operator">&gt;</span></span><br><span class="line">  </span><br><span class="line">  <span class="operator">&lt;</span><span class="operator">!</span><span class="comment">-- 第二功能模块虚线框 --&gt;</span></span><br><span class="line">  <span class="operator">&lt;</span>rect x<span class="operator">=</span>&quot;35&quot; y<span class="operator">=</span>&quot;335&quot; width<span class="operator">=</span>&quot;410&quot; height<span class="operator">=</span>&quot;180&quot; rx<span class="operator">=</span>&quot;10&quot; ry<span class="operator">=</span>&quot;10&quot; fill<span class="operator">=</span>&quot;none&quot; stroke<span class="operator">=</span>&quot;#4CAF50&quot; stroke<span class="operator">-</span>width<span class="operator">=</span>&quot;2&quot; stroke<span class="operator">-</span>dasharray<span class="operator">=</span>&quot;5,3&quot; <span class="operator">/</span><span class="operator">&gt;</span></span><br><span class="line">  </span><br><span class="line">  <span class="operator">&lt;</span><span class="operator">!</span><span class="comment">-- 第二功能模块 --&gt;</span></span><br><span class="line">  <span class="operator">&lt;</span>rect x<span class="operator">=</span>&quot;40&quot; y<span class="operator">=</span>&quot;340&quot; width<span class="operator">=</span>&quot;400&quot; height<span class="operator">=</span>&quot;50&quot; rx<span class="operator">=</span>&quot;10&quot; ry<span class="operator">=</span>&quot;10&quot; fill<span class="operator">=</span>&quot;#4CAF50&quot; <span class="operator">/</span><span class="operator">&gt;</span></span><br><span class="line">  <span class="operator">&lt;</span>text x<span class="operator">=</span>&quot;240&quot; y<span class="operator">=</span>&quot;373&quot; font<span class="operator">-</span>family<span class="operator">=</span>&quot;&#x27;Microsoft YaHei&#x27;, sans-serif&quot; font<span class="operator">-</span>size<span class="operator">=</span>&quot;18&quot; text<span class="operator">-</span>anchor<span class="operator">=</span>&quot;middle&quot; fill<span class="operator">=</span>&quot;white&quot;<span class="operator">&gt;</span>内容管理系统<span class="operator">&lt;</span><span class="operator">/</span>text<span class="operator">&gt;</span></span><br><span class="line">  </span><br><span class="line">  <span class="operator">&lt;</span><span class="operator">!</span><span class="comment">-- 第二模块子功能 --&gt;</span></span><br><span class="line">  <span class="operator">&lt;</span>rect x<span class="operator">=</span>&quot;40&quot; y<span class="operator">=</span>&quot;400&quot; width<span class="operator">=</span>&quot;190&quot; height<span class="operator">=</span>&quot;50&quot; rx<span class="operator">=</span>&quot;5&quot; ry<span class="operator">=</span>&quot;5&quot; fill<span class="operator">=</span>&quot;#3E9641&quot; <span class="operator">/</span><span class="operator">&gt;</span></span><br><span class="line">  <span class="operator">&lt;</span>text x<span class="operator">=</span>&quot;135&quot; y<span class="operator">=</span>&quot;430&quot; font<span class="operator">-</span>family<span class="operator">=</span>&quot;&#x27;Microsoft YaHei&#x27;, sans-serif&quot; font<span class="operator">-</span>size<span class="operator">=</span>&quot;14&quot; text<span class="operator">-</span>anchor<span class="operator">=</span>&quot;middle&quot; fill<span class="operator">=</span>&quot;white&quot;<span class="operator">&gt;</span>景点信息管理<span class="operator">&lt;</span><span class="operator">/</span>text<span class="operator">&gt;</span></span><br><span class="line">  </span><br><span class="line">  <span class="operator">&lt;</span>rect x<span class="operator">=</span>&quot;250&quot; y<span class="operator">=</span>&quot;400&quot; width<span class="operator">=</span>&quot;190&quot; height<span class="operator">=</span>&quot;50&quot; rx<span class="operator">=</span>&quot;5&quot; ry<span class="operator">=</span>&quot;5&quot; fill<span class="operator">=</span>&quot;#3E9641&quot; <span class="operator">/</span><span class="operator">&gt;</span></span><br><span class="line">  <span class="operator">&lt;</span>text x<span class="operator">=</span>&quot;345&quot; y<span class="operator">=</span>&quot;430&quot; font<span class="operator">-</span>family<span class="operator">=</span>&quot;&#x27;Microsoft YaHei&#x27;, sans-serif&quot; font<span class="operator">-</span>size<span class="operator">=</span>&quot;14&quot; text<span class="operator">-</span>anchor<span class="operator">=</span>&quot;middle&quot; fill<span class="operator">=</span>&quot;white&quot;<span class="operator">&gt;</span>酒店信息管理<span class="operator">&lt;</span><span class="operator">/</span>text<span class="operator">&gt;</span></span><br><span class="line">  </span><br><span class="line">  <span class="operator">&lt;</span>rect x<span class="operator">=</span>&quot;40&quot; y<span class="operator">=</span>&quot;460&quot; width<span class="operator">=</span>&quot;190&quot; height<span class="operator">=</span>&quot;50&quot; rx<span class="operator">=</span>&quot;5&quot; ry<span class="operator">=</span>&quot;5&quot; fill<span class="operator">=</span>&quot;#3E9641&quot; <span class="operator">/</span><span class="operator">&gt;</span></span><br><span class="line">  <span class="operator">&lt;</span>text x<span class="operator">=</span>&quot;135&quot; y<span class="operator">=</span>&quot;490&quot; font<span class="operator">-</span>family<span class="operator">=</span>&quot;&#x27;Microsoft YaHei&#x27;, sans-serif&quot; font<span class="operator">-</span>size<span class="operator">=</span>&quot;14&quot; text<span class="operator">-</span>anchor<span class="operator">=</span>&quot;middle&quot; fill<span class="operator">=</span>&quot;white&quot;<span class="operator">&gt;</span>攻略内容管理<span class="operator">&lt;</span><span class="operator">/</span>text<span class="operator">&gt;</span></span><br><span class="line">  </span><br><span class="line">  <span class="operator">&lt;</span>rect x<span class="operator">=</span>&quot;250&quot; y<span class="operator">=</span>&quot;460&quot; width<span class="operator">=</span>&quot;190&quot; height<span class="operator">=</span>&quot;50&quot; rx<span class="operator">=</span>&quot;5&quot; ry<span class="operator">=</span>&quot;5&quot; fill<span class="operator">=</span>&quot;#3E9641&quot; <span class="operator">/</span><span class="operator">&gt;</span></span><br><span class="line">  <span class="operator">&lt;</span>text x<span class="operator">=</span>&quot;345&quot; y<span class="operator">=</span>&quot;490&quot; font<span class="operator">-</span>family<span class="operator">=</span>&quot;&#x27;Microsoft YaHei&#x27;, sans-serif&quot; font<span class="operator">-</span>size<span class="operator">=</span>&quot;14&quot; text<span class="operator">-</span>anchor<span class="operator">=</span>&quot;middle&quot; fill<span class="operator">=</span>&quot;white&quot;<span class="operator">&gt;</span>行程模板管理<span class="operator">&lt;</span><span class="operator">/</span>text<span class="operator">&gt;</span></span><br><span class="line">  </span><br><span class="line">  <span class="operator">&lt;</span><span class="operator">!</span><span class="comment">-- 第三功能模块虚线框 --&gt;</span></span><br><span class="line">  <span class="operator">&lt;</span>rect x<span class="operator">=</span>&quot;35&quot; y<span class="operator">=</span>&quot;525&quot; width<span class="operator">=</span>&quot;410&quot; height<span class="operator">=</span>&quot;180&quot; rx<span class="operator">=</span>&quot;10&quot; ry<span class="operator">=</span>&quot;10&quot; fill<span class="operator">=</span>&quot;none&quot; stroke<span class="operator">=</span>&quot;#FF9966&quot; stroke<span class="operator">-</span>width<span class="operator">=</span>&quot;2&quot; stroke<span class="operator">-</span>dasharray<span class="operator">=</span>&quot;5,3&quot; <span class="operator">/</span><span class="operator">&gt;</span></span><br><span class="line">  </span><br><span class="line">  <span class="operator">&lt;</span><span class="operator">!</span><span class="comment">-- 第三功能模块 --&gt;</span></span><br><span class="line">  <span class="operator">&lt;</span>rect x<span class="operator">=</span>&quot;40&quot; y<span class="operator">=</span>&quot;530&quot; width<span class="operator">=</span>&quot;400&quot; height<span class="operator">=</span>&quot;50&quot; rx<span class="operator">=</span>&quot;10&quot; ry<span class="operator">=</span>&quot;10&quot; fill<span class="operator">=</span>&quot;#FF9966&quot; <span class="operator">/</span><span class="operator">&gt;</span></span><br><span class="line">  <span class="operator">&lt;</span>text x<span class="operator">=</span>&quot;240&quot; y<span class="operator">=</span>&quot;563&quot; font<span class="operator">-</span>family<span class="operator">=</span>&quot;&#x27;Microsoft YaHei&#x27;, sans-serif&quot; font<span class="operator">-</span>size<span class="operator">=</span>&quot;18&quot; text<span class="operator">-</span>anchor<span class="operator">=</span>&quot;middle&quot; fill<span class="operator">=</span>&quot;white&quot;<span class="operator">&gt;</span>用户与订单管理<span class="operator">&lt;</span><span class="operator">/</span>text<span class="operator">&gt;</span></span><br><span class="line">  </span><br><span class="line">  <span class="operator">&lt;</span><span class="operator">!</span><span class="comment">-- 第三模块子功能 --&gt;</span></span><br><span class="line">  <span class="operator">&lt;</span>rect x<span class="operator">=</span>&quot;40&quot; y<span class="operator">=</span>&quot;590&quot; width<span class="operator">=</span>&quot;190&quot; height<span class="operator">=</span>&quot;50&quot; rx<span class="operator">=</span>&quot;5&quot; ry<span class="operator">=</span>&quot;5&quot; fill<span class="operator">=</span>&quot;#E67E22&quot; <span class="operator">/</span><span class="operator">&gt;</span></span><br><span class="line">  <span class="operator">&lt;</span>text x<span class="operator">=</span>&quot;135&quot; y<span class="operator">=</span>&quot;620&quot; font<span class="operator">-</span>family<span class="operator">=</span>&quot;&#x27;Microsoft YaHei&#x27;, sans-serif&quot; font<span class="operator">-</span>size<span class="operator">=</span>&quot;14&quot; text<span class="operator">-</span>anchor<span class="operator">=</span>&quot;middle&quot; fill<span class="operator">=</span>&quot;white&quot;<span class="operator">&gt;</span>用户账户管理<span class="operator">&lt;</span><span class="operator">/</span>text<span class="operator">&gt;</span></span><br><span class="line">  </span><br><span class="line">  <span class="operator">&lt;</span>rect x<span class="operator">=</span>&quot;250&quot; y<span class="operator">=</span>&quot;590&quot; width<span class="operator">=</span>&quot;190&quot; height<span class="operator">=</span>&quot;50&quot; rx<span class="operator">=</span>&quot;5&quot; ry<span class="operator">=</span>&quot;5&quot; fill<span class="operator">=</span>&quot;#E67E22&quot; <span class="operator">/</span><span class="operator">&gt;</span></span><br><span class="line">  <span class="operator">&lt;</span>text x<span class="operator">=</span>&quot;345&quot; y<span class="operator">=</span>&quot;620&quot; font<span class="operator">-</span>family<span class="operator">=</span>&quot;&#x27;Microsoft YaHei&#x27;, sans-serif&quot; font<span class="operator">-</span>size<span class="operator">=</span>&quot;14&quot; text<span class="operator">-</span>anchor<span class="operator">=</span>&quot;middle&quot; fill<span class="operator">=</span>&quot;white&quot;<span class="operator">&gt;</span>用户权限配置<span class="operator">&lt;</span><span class="operator">/</span>text<span class="operator">&gt;</span></span><br><span class="line">  </span><br><span class="line">  <span class="operator">&lt;</span>rect x<span class="operator">=</span>&quot;40&quot; y<span class="operator">=</span>&quot;650&quot; width<span class="operator">=</span>&quot;190&quot; height<span class="operator">=</span>&quot;50&quot; rx<span class="operator">=</span>&quot;5&quot; ry<span class="operator">=</span>&quot;5&quot; fill<span class="operator">=</span>&quot;#E67E22&quot; <span class="operator">/</span><span class="operator">&gt;</span></span><br><span class="line">  <span class="operator">&lt;</span>text x<span class="operator">=</span>&quot;135&quot; y<span class="operator">=</span>&quot;680&quot; font<span class="operator">-</span>family<span class="operator">=</span>&quot;&#x27;Microsoft YaHei&#x27;, sans-serif&quot; font<span class="operator">-</span>size<span class="operator">=</span>&quot;14&quot; text<span class="operator">-</span>anchor<span class="operator">=</span>&quot;middle&quot; fill<span class="operator">=</span>&quot;white&quot;<span class="operator">&gt;</span>订单处理与跟踪<span class="operator">&lt;</span><span class="operator">/</span>text<span class="operator">&gt;</span></span><br><span class="line">  </span><br><span class="line">  <span class="operator">&lt;</span>rect x<span class="operator">=</span>&quot;250&quot; y<span class="operator">=</span>&quot;650&quot; width<span class="operator">=</span>&quot;190&quot; height<span class="operator">=</span>&quot;50&quot; rx<span class="operator">=</span>&quot;5&quot; ry<span class="operator">=</span>&quot;5&quot; fill<span class="operator">=</span>&quot;#E67E22&quot; <span class="operator">/</span><span class="operator">&gt;</span></span><br><span class="line">  <span class="operator">&lt;</span>text x<span class="operator">=</span>&quot;345&quot; y<span class="operator">=</span>&quot;680&quot; font<span class="operator">-</span>family<span class="operator">=</span>&quot;&#x27;Microsoft YaHei&#x27;, sans-serif&quot; font<span class="operator">-</span>size<span class="operator">=</span>&quot;14&quot; text<span class="operator">-</span>anchor<span class="operator">=</span>&quot;middle&quot; fill<span class="operator">=</span>&quot;white&quot;<span class="operator">&gt;</span>退款与异常处理<span class="operator">&lt;</span><span class="operator">/</span>text<span class="operator">&gt;</span></span><br><span class="line">  </span><br><span class="line">  <span class="operator">&lt;</span><span class="operator">!</span><span class="comment">-- 第四功能模块虚线框 --&gt;</span></span><br><span class="line">  <span class="operator">&lt;</span>rect x<span class="operator">=</span>&quot;35&quot; y<span class="operator">=</span>&quot;715&quot; width<span class="operator">=</span>&quot;410&quot; height<span class="operator">=</span>&quot;120&quot; rx<span class="operator">=</span>&quot;10&quot; ry<span class="operator">=</span>&quot;10&quot; fill<span class="operator">=</span>&quot;none&quot; stroke<span class="operator">=</span>&quot;#9C27B0&quot; stroke<span class="operator">-</span>width<span class="operator">=</span>&quot;2&quot; stroke<span class="operator">-</span>dasharray<span class="operator">=</span>&quot;5,3&quot; <span class="operator">/</span><span class="operator">&gt;</span></span><br><span class="line">  </span><br><span class="line">  <span class="operator">&lt;</span><span class="operator">!</span><span class="comment">-- 第四功能模块 --&gt;</span></span><br><span class="line">  <span class="operator">&lt;</span>rect x<span class="operator">=</span>&quot;40&quot; y<span class="operator">=</span>&quot;720&quot; width<span class="operator">=</span>&quot;400&quot; height<span class="operator">=</span>&quot;50&quot; rx<span class="operator">=</span>&quot;10&quot; ry<span class="operator">=</span>&quot;10&quot; fill<span class="operator">=</span>&quot;#9C27B0&quot; <span class="operator">/</span><span class="operator">&gt;</span></span><br><span class="line">  <span class="operator">&lt;</span>text x<span class="operator">=</span>&quot;240&quot; y<span class="operator">=</span>&quot;753&quot; font<span class="operator">-</span>family<span class="operator">=</span>&quot;&#x27;Microsoft YaHei&#x27;, sans-serif&quot; font<span class="operator">-</span>size<span class="operator">=</span>&quot;18&quot; text<span class="operator">-</span>anchor<span class="operator">=</span>&quot;middle&quot; fill<span class="operator">=</span>&quot;white&quot;<span class="operator">&gt;</span>系统维护与安全<span class="operator">&lt;</span><span class="operator">/</span>text<span class="operator">&gt;</span></span><br><span class="line">  </span><br><span class="line">  <span class="operator">&lt;</span><span class="operator">!</span><span class="comment">-- 第四模块子功能 --&gt;</span></span><br><span class="line">  <span class="operator">&lt;</span>rect x<span class="operator">=</span>&quot;40&quot; y<span class="operator">=</span>&quot;780&quot; width<span class="operator">=</span>&quot;190&quot; height<span class="operator">=</span>&quot;50&quot; rx<span class="operator">=</span>&quot;5&quot; ry<span class="operator">=</span>&quot;5&quot; fill<span class="operator">=</span>&quot;#8E24AA&quot; <span class="operator">/</span><span class="operator">&gt;</span></span><br><span class="line">  <span class="operator">&lt;</span>text x<span class="operator">=</span>&quot;135&quot; y<span class="operator">=</span>&quot;810&quot; font<span class="operator">-</span>family<span class="operator">=</span>&quot;&#x27;Microsoft YaHei&#x27;, sans-serif&quot; font<span class="operator">-</span>size<span class="operator">=</span>&quot;14&quot; text<span class="operator">-</span>anchor<span class="operator">=</span>&quot;middle&quot; fill<span class="operator">=</span>&quot;white&quot;<span class="operator">&gt;</span>数据备份与恢复<span class="operator">&lt;</span><span class="operator">/</span>text<span class="operator">&gt;</span></span><br><span class="line">  </span><br><span class="line">  <span class="operator">&lt;</span>rect x<span class="operator">=</span>&quot;250&quot; y<span class="operator">=</span>&quot;780&quot; width<span class="operator">=</span>&quot;190&quot; height<span class="operator">=</span>&quot;50&quot; rx<span class="operator">=</span>&quot;5&quot; ry<span class="operator">=</span>&quot;5&quot; fill<span class="operator">=</span>&quot;#8E24AA&quot; <span class="operator">/</span><span class="operator">&gt;</span></span><br><span class="line">  <span class="operator">&lt;</span>text x<span class="operator">=</span>&quot;345&quot; y<span class="operator">=</span>&quot;810&quot; font<span class="operator">-</span>family<span class="operator">=</span>&quot;&#x27;Microsoft YaHei&#x27;, sans-serif&quot; font<span class="operator">-</span>size<span class="operator">=</span>&quot;14&quot; text<span class="operator">-</span>anchor<span class="operator">=</span>&quot;middle&quot; fill<span class="operator">=</span>&quot;white&quot;<span class="operator">&gt;</span>系统日志管理<span class="operator">&lt;</span><span class="operator">/</span>text<span class="operator">&gt;</span></span><br><span class="line"><span class="operator">&lt;</span><span class="operator">/</span>svg<span class="operator">&gt;</span></span><br></pre></td></tr></table></figure>
<h2 id="5-14">5.14</h2>
<p>1.布隆过滤器（Bloom Filter）</p>
<p>（1）定义与特性</p>
<ul>
<li>
<p><strong>本质</strong>：一种概率型数据结构，用于高效判断元素是否存在于集合中，基于多个哈希函数和位数组实现。</p>
</li>
<li>
<p>核心特性</p>
<ul>
<li><strong>无假阴性</strong>：若查询返回 “不存在”，则元素必定不在集合中（False Negative Rate = 0）。</li>
<li><strong>可能有假阳性</strong>：若查询返回 “存在”，元素可能不存在（由哈希冲突导致，False Positive Rate &gt; 0）。</li>
</ul>
</li>
<li>
<p>核心操作</p>
<ul>
<li><strong>插入</strong>：通过多个哈希函数计算元素的哈希值，将位数组对应位置置为 1。</li>
<li><strong>查询</strong>：检查所有哈希函数对应位是否全为 1，全为 1 则 “可能存在”，否则 “必定不存在”。</li>
</ul>
</li>
<li>
<p><strong>空间效率</strong>：仅需维护一个位数组，空间复杂度远低于存储完整元素集合。</p>
</li>
</ul>
<p>（2）核心问题与解决方案</p>
<p><strong>核心挑战</strong></p>
<ul>
<li><strong>问题 1</strong>：哈希冲突导致假阳性（False Positive）。</li>
<li><strong>问题 2</strong>：位数组大小和哈希函数数量需平衡，以降低假阳性率。</li>
</ul>
<p><strong>解决方案</strong></p>
<ul>
<li>参数优化</li>
</ul>
<p>设位数组大小为$m$，元素数量为$n$，哈希函数数量为$k$，最优$k = (\ln 2) \cdot (m/n)$，最小假阳性率为$ (1 - e^{-kn/m})^k$。</p>
<ul>
<li><strong>多哈希函数</strong>：使用独立哈希函数减少冲突概率，如$h_1(x), h_2(x), \dots, h_k(x)$</li>
</ul>
<p>（3）工作原理与示例</p>
<p>插入流程：对元素 x，计算k个哈希值$h_i(x)\mod m(i=1,2,\dots,k)$。将位数组中$h_i(x)$对应的位置置为 1。</p>
<p><strong>查询流程</strong></p>
<ol>
<li>对元素 x，计算 k 个哈希值，检查对应位是否全为 1。</li>
<li>若全为 1，返回 “可能存在”；否则返回 “不存在”。</li>
</ol>
<p><strong>示例（文档中的案例）</strong>（内容ai识别有误但可以辅助理解）</p>
<ul>
<li><strong>位数组大小</strong>：8（索引 0-7），<strong>哈希函数</strong>：2 个$(h_1(x) = x%8，h_2(x) = (x//2)%8)$。</li>
<li><strong>插入 “RZA”</strong>：$h_1=2，h_2=4$，置位 2、4 为 1。</li>
<li><strong>插入 “GZA”</strong>：$h_1=3，h_2=1$，置位 3、1 为 1。</li>
<li><strong>查询 “ODB”</strong>：$h_1=3，h_2=6$，对应位 3 为 1、6 为 0，返回 “不存在”（实际未插入，正确）。</li>
<li><strong>查询 “假阳性案例”</strong>：某元素未插入，但所有哈希位被其他元素置 1（也就是置1的这两个位置分别是两个元素1的一部分，1个元素有两个1，组合在一起并没有实际的含义），返回 “存在”（如文档中 “ODB” 示例可能因哈希冲突误判）。</li>
</ul>
<p><img src="/%E6%95%B0%E6%8D%AE%E5%BA%93%E5%8E%9F%E7%90%86%E4%B8%8E%E5%BA%94%E7%94%A8%EF%BC%88%E5%A4%96%E6%95%99%E7%89%88%EF%BC%89/image-20250514144309539.png" alt="image-20250514144309539"></p>
<p><strong>问题：布隆过滤器插入操作例题</strong></p>
<p><strong>知识点讲解</strong></p>
<p>布隆过滤器是一种基于哈希函数和位数组的数据结构，用于高效判断元素是否存在于集合中。其核心思想是通过多个哈希函数将元素映射到位数组的不同位置，并将这些位置置为 1。插入时，所有哈希函数对应的位都会被标记；查询时，只有当所有哈希位均为 1 时，才认为元素 “可能存在”，否则 “必定不存在”。</p>
<p><strong>核心规则</strong></p>
<ol>
<li>插入操作
<ul>
<li>对元素 x，计算每个哈希函数$h_i(x)$的值，将位数组中索引为$h_i(x)$的位置置为 1（即使该位置已为 1，仍保持为 1）。</li>
</ul>
</li>
<li><strong>无假阴性</strong>：若查询时任何一个哈希位为 0，元素必定不存在；若所有哈希位为 1，元素可能存在（可能因哈希冲突导致假阳性）。</li>
</ol>
<p><strong>例题</strong></p>
<p><strong>布隆过滤器设置</strong>：</p>
<ul>
<li><strong>位数组大小</strong>：10 位（索引 0–9）</li>
<li><strong>哈希函数数量</strong>：2 个</li>
<li>哈希函数
<ul>
<li>$h_1(x) = x % 10$</li>
<li>$h_2(x) = (x \times 3) % 10$</li>
</ul>
</li>
<li><strong>操作序列</strong>：插入数字 5、7、12</li>
</ul>
<p><strong>答案解析</strong></p>
<ol>
<li><strong>插入数字 5</strong>：
<ul>
<li>$h_1(5) = 5 % 10 = 5$</li>
<li>$h_2(5) = (5 \times 3) % 10 = 15 % 10 = 5$</li>
<li>置位：索引 5（两个哈希函数均映射到 5，只需置位一次）。</li>
<li>位数组状态：<code>[0, 0, 0, 0, 0, 1, 0, 0, 0, 0]</code></li>
</ul>
</li>
<li><strong>插入数字 7</strong>：
<ul>
<li>(h_1(7) = 7 % 10 = 7)</li>
<li>(h_2(7) = (7 \times 3) % 10 = 21 % 10 = 1)</li>
<li>置位：索引 1 和 7。</li>
<li>位数组状态：<code>[0, 1, 0, 0, 0, 1, 0, 1, 0, 0]</code></li>
</ul>
</li>
<li><strong>插入数字 12</strong>：
<ul>
<li>(h_1(12) = 12 % 10 = 2)</li>
<li>(h_2(12) = (12 \times 3) % 10 = 36 % 10 = 6)</li>
<li>置位：索引 2 和 6。</li>
<li>最终位数组状态：<code>[0, 1, 1, 0, 0, 1, 1, 1, 0, 0]</code>（与答案一致）</li>
</ul>
</li>
</ol>
<p><strong>步骤表格</strong></p>
<p>| 步骤 | 操作    | 哈希值计算       | 置位索引 | 位数组状态（0-9）       | 备注                 |<br>
| ---- | ------- | ---------------- | -------- | ----------------------- | -------------------- |<br>
| 1    | 插入 5  | (h_1=5, h_2=5) | 5        | <code>[0,0,0,0,0,1,0,0,0,0]</code> | 两哈希函数均映射到 5 |<br>
| 2    | 插入 7  | (h_1=7, h_2=1) | 1, 7     | <code>[0,1,0,0,0,1,0,1,0,0]</code> | 无冲突，直接置位     |<br>
| 3    | 插入 12 | (h_1=2, h_2=6) | 2, 6     | <code>[0,1,1,0,0,1,1,1,0,0]</code> | 无冲突               |</p>
<p>2.跳跃列表（Skip List）</p>
<p>（1）定义与特性</p>
<ul>
<li><strong>本质</strong>：基于多层有序链表的索引结构，通过分层指针实现快速搜索，常用于内存数据库索引（如 Redis）。</li>
<li>核心结构
<ul>
<li><strong>多层链表</strong>：每层为有序链表，高层节点稀疏（约为下层的 1/2），底层包含所有节点。</li>
<li><strong>随机层数</strong>：插入时通过 “抛硬币” 随机决定节点层数（概率 1/2 逐层递增，避免手动平衡）。</li>
</ul>
</li>
<li><strong>时间复杂度</strong>：搜索、插入、删除均为 (O(\log n))（近似平衡树效率）。</li>
</ul>
<p>（2）与 B + 树对比</p>
<p>| <strong>特性</strong>        | <strong>跳跃列表</strong>                       | <strong>B + 树</strong>                   |<br>
| --------------- | ---------------------------------- | ---------------------------- |<br>
| <strong>存储结构</strong>    | 内存有序链表（多层索引）           | 磁盘友好的树结构             |<br>
| <strong>插入 / 删除</strong> | 无需全局重新平衡（仅局部指针调整） | 可能触发树的分裂 / 合并      |<br>
| <strong>局部性</strong>      | 差（节点分散，缓存不友好）         | 好（节点按页存储，局部性强） |<br>
| <strong>适用场景</strong>    | 内存型数据库、高频更新场景         | 磁盘数据库、范围查询为主     |</p>
<p>（3）核心操作流程</p>
<p><strong>搜索流程</strong></p>
<ol>
<li>从最高层的头节点开始，沿当前层向右移动，直到下一个节点键值大于目标键。</li>
<li>若无法右移，下降到下一层，重复步骤 1，直到底层。</li>
<li>底层找到目标键则成功，否则不存在。</li>
</ol>
<p><strong>插入流程</strong></p>
<ol>
<li>找到插入位置（同搜索流程，记录各层前驱节点）。</li>
<li>插入底层节点，更新前驱节点的 next 指针。</li>
<li>抛硬币决定是否将节点提升到更高层（概率 1/2，直到达到最大层数），逐层更新指针。</li>
</ol>
<p>（4）例题：插入节点与层数决策</p>
<p><strong>场景</strong>：跳跃列表当前底层节点为 [11, 17, 20]，层数最大为 3 层，插入节点 19。</p>
<ol>
<li><strong>底层搜索</strong>：17 &lt; 19 &lt; 20，插入位置在 17 和 20 之间。</li>
<li><strong>抛硬币结果</strong>：第一次正面（层数提升至 2 层），第二次反面（停止提升）。</li>
<li>更新指针
<ul>
<li>底层：17→19→20。</li>
<li>2 层：若原 2 层节点为 [11, 20]，插入 19 需判断是否在 2 层存在（因 19 未被提升到 2 层，故 2 层无变化）。</li>
</ul>
</li>
</ol>
<p>（5）优缺点</p>
<ul>
<li><strong>优点</strong>：实现简单，插入 / 删除高效（无需平衡），适合动态数据。</li>
<li><strong>缺点</strong>：内存占用较高（每层节点需额外指针），磁盘访问效率低（非本地化存储）。</li>
</ul>
<p>3.倒排索引（Inverted Index）</p>
<p>（1）定义与特性</p>
<ul>
<li><strong>本质</strong>：一种反向映射索引，将 “术语” 映射到 “包含该术语的文档集合”，用于高效文本搜索。</li>
<li>核心结构
<ul>
<li><strong>词典（Dictionary）</strong>：存储所有唯一术语，如 “car”“vehicle”。</li>
<li>** postings 列表（Postings List）**：每个术语对应一个文档列表，记录文档 ID 及出现位置 / 频率。</li>
</ul>
</li>
<li><strong>应用场景</strong>：全文检索（如 SQL 中的<code>LIKE '%关键词%'</code>）、搜索引擎、文档检索系统。</li>
</ul>
<p>（2）核心问题与解决方案</p>
<p><strong>核心挑战</strong></p>
<ul>
<li><strong>问题 1</strong>：术语分词与标准化（如大小写、单复数处理）。</li>
<li><strong>问题 2</strong>：高效处理多术语组合查询（如 “AND”“OR” 操作）。</li>
</ul>
<p><strong>解决方案</strong></p>
<ul>
<li><strong>分词与归一化</strong>：使用分词器（如 Lucene 的 Standard Analyzer）将文本拆分为词元（Token），并转换为小写、去除停用词。</li>
<li>倒排列表合并
<ul>
<li><strong>AND 操作</strong>：取多个 postings 列表的交集（如归并排序遍历）。</li>
<li><strong>OR 操作</strong>：取多个 postings 列表的并集。</li>
</ul>
</li>
</ul>
<p>（3）示例：构建倒排索引</p>
<p><strong>文档集合</strong>：</p>
<ol>
<li>“Winter is coming.”</li>
<li>“Ours is the fury.”</li>
<li>“The choice is yours.”</li>
</ol>
<p><strong>倒排索引表</strong></p>
<p>| 术语   | 文档 ID 列表 | 频率 |<br>
| ------ | ------------ | ---- |<br>
| coming | [1]          | 1    |<br>
| fury   | [2]          | 1    |<br>
| is     | [1, 2, 3]    | 3    |<br>
| the    | [2, 3]       | 2    |<br>
| yours  | [3]          | 1    |</p>
<p><strong>查询 “is the”</strong>：</p>
<ul>
<li>取 “is” 的文档列表 [1,2,3] 和 “the” 的文档列表 [2,3] 的交集，结果为 [2,3]。</li>
</ul>
<p>（4）与正向索引对比</p>
<p>| <strong>特性</strong>     | <strong>倒排索引</strong>                  | <strong>正向索引（如 B + 树）</strong>  |<br>
| ------------ | ----------------------------- | -------------------------- |<br>
| <strong>映射方向</strong> | 术语→文档（反向）             | 文档→术语（正向）          |<br>
| <strong>优势</strong>     | 快速回答 “哪些文档包含某术语” | 快速定位单个文档内容       |<br>
| <strong>适用场景</strong> | 文本搜索、关键词查询          | 文档内容检索、精确主键查询 |</p>
<p>（5）扩展技术</p>
<ul>
<li><strong>同义词处理</strong>：引入同义词词典（如 “car” 映射 “vehicle”），扩展查询匹配范围。</li>
<li><strong>短语查询</strong>：在 postings 列表中记录术语位置，支持 “邻近词” 搜索（如 “New York” 需连续出现）。</li>
</ul>
<p>4.向量数据库（Vector Database）</p>
<h2 id="5-14（2）sort">5.14（2）sort</h2>
<p>1.排序（Sorting）</p>
<p>（1）定义与特性</p>
<ul>
<li>
<p><strong>本质</strong>：将数据集合按升序或降序排列的过程，数据库中通过 <code>ORDER BY</code> 实现，大规模数据需考虑内存限制采用外部排序。</p>
</li>
<li>
<p>核心操作</p>
<ul>
<li><strong>数据库排序</strong>：<code>ORDER BY</code> 排序结果集，<code>LIMIT</code> 限制返回记录数，平均时间复杂度依赖数据规模和算法。</li>
<li><strong>内部排序</strong>：在内存中直接排序（如选择排序、插入排序、快速排序），时间复杂度范围为 (O(n^2)) 到 (O(n \log n))。</li>
<li><strong>外部排序</strong>：处理超出内存的数据，通过分块排序和归并实现（如外部归并排序）。</li>
</ul>
</li>
<li>
<p>内部结构</p>
<ul>
<li>内部排序基于数组或链表操作，外部排序依赖磁盘分块和归并，利用优先队列优化 Top-N 排序。</li>
</ul>
</li>
</ul>
<p>（2）与其他排序方法对比</p>
<p>| <strong>特性</strong>       | <strong>内部排序（如快速排序）</strong> | <strong>Top-N 排序（优先队列）</strong>    | <strong>外部归并排序</strong>                |<br>
| -------------- | -------------------------- | ----------------------------- | ------------------------------- |<br>
| <strong>数据规模</strong>   | 适合内存内数据             | 适合内存内数据                | 适合超大规模磁盘数据            |<br>
| <strong>时间复杂度</strong> | (O(n \log n))            | (O(n \log k))（k 为 Top-N） | (O((n/m) \log (n/m) \cdot m)) |<br>
| <strong>内存依赖</strong>   | 需全部数据在内存中         | 仅需维护大小为 k 的堆         | 分块处理，每次仅加载部分数据    |<br>
| <strong>适用场景</strong>   | 中等规模数据排序           | 快速获取前 k 小 / 大元素      | 处理 TB 级无法内存容纳的数据    |</p>
<p>（3）核心问题与解决方案</p>
<p><strong>核心挑战</strong></p>
<ul>
<li><strong>问题 1</strong>：数据量超过内存容量，无法直接加载排序（如 128 TB 数据）。</li>
<li><strong>问题 2</strong>：数据库中 <code>ORDER BY</code> 结合 <code>LIMIT</code> 时，全量排序效率低。</li>
</ul>
<p><strong>解决方案</strong></p>
<ul>
<li><strong>外部归并排序</strong>：分治策略，先排序内存可容纳的块，再逐次归并有序块（如 2 路归并）。</li>
<li><strong>Top-N 排序</strong>：使用优先队列（最大堆），仅维护当前 Top-N 元素，避免全量排序。</li>
</ul>
<p>（4）核心算法步骤</p>
<p><strong>Top-N 最小元素算法（最大堆）</strong></p>
<ol>
<li>初始化大小为 N 的最大堆。</li>
<li>遍历数据，若堆中元素数小于 N，直接插入堆。</li>
<li>否则，若当前元素小于堆顶（最大元素），删除堆顶并插入当前元素，调整堆结构。</li>
</ol>
<p><strong>外部归并排序（2 路）</strong></p>
<ol>
<li><strong>排序阶段（Pass 0）</strong>：将数据分块读入内存，排序后写回磁盘（生成 1-page 有序块）。</li>
<li><strong>归并阶段（Pass 1, 2, ...）</strong>：每次合并两个相邻有序块，生成双倍大小的有序块，直至所有数据有序。</li>
</ol>
<p>（5）核心公式与算法</p>
<p><strong>优先队列操作</strong></p>
<ul>
<li>插入元素：时间复杂度 (O(\log k))（k 为堆大小）。</li>
<li>删除堆顶：时间复杂度 (O(\log k))。</li>
</ul>
<p><strong>外部归并阶段数计算</strong></p>
<p>设数据总页数为 n，内存可容纳 m 页，则归并阶段数为 (\lceil \log_{k}(n/m) \rceil)（k 为归并路数，此处 k=2）</p>
<p><strong>问题 1：Top-N 最小元素算法例题（最大堆）</strong></p>
<p><strong>知识点讲解</strong><br>
使用最大堆维护当前 Top-N 元素，堆顶为当前最大元素。新元素若小于堆顶，则替换堆顶并调整堆，确保堆中始终为最小的 N 个元素。</p>
<p><strong>核心规则</strong></p>
<ol>
<li>堆大小固定为 N，存储当前最小的 N 个元素。</li>
<li>新元素小于堆顶时，删除堆顶并插入新元素；否则跳过。</li>
</ol>
<p><strong>例题</strong></p>
<p><strong>目标</strong>：查找数组 <code>[3, 8, 4, 9, 1, 5, 7, 11]</code> 中前 3 小的元素。</p>
<p><strong>步骤解析</strong></p>
<ol>
<li><strong>初始化堆</strong>：堆大小为 3，初始为空。</li>
<li>插入前 3 个元素（3, 8, 4）
<ul>
<li>插入 3，堆：<code>[3]</code>（堆大小 1）。</li>
<li>插入 8，堆：<code>[3, 8]</code>（堆大小 2）。</li>
<li>插入 4，堆：调整为最大堆 <code>[8, 3, 4]</code>（堆顶 8 为当前最大）。</li>
</ul>
</li>
<li>处理后续元素（9, 1, 5, 7, 11）
<ul>
<li>9 &gt; 堆顶 8，跳过，堆不变。</li>
<li>1 &lt; 堆顶 8，删除 8，插入 1，调整堆为 <code>[4, 3, 1]</code>（堆顶 4）。</li>
<li>5 &gt; 堆顶 4，跳过，堆不变。</li>
<li>7 &gt; 堆顶 4，跳过，堆不变。</li>
<li>11 &gt; 堆顶 4，跳过，堆不变。</li>
</ul>
</li>
<li><strong>最终堆元素</strong>：1, 3, 4（排序后为 [1, 3, 4]）。</li>
</ol>
<p><strong>步骤表格</strong></p>
<p>| 步骤 | 操作    | 堆状态（最大堆） | 对比结果        | 备注                     |<br>
| ---- | ------- | ---------------- | --------------- | ------------------------ |<br>
| 1    | 插入 3  | <code>[3]</code>            | -               | 堆大小不足 3，直接插入   |<br>
| 2    | 插入 8  | <code>[8, 3]</code>         | -               | 堆大小不足 3，直接插入   |<br>
| 3    | 插入 4  | <code>[8, 3, 4]</code>      | -               | 堆大小达 3，调整为最大堆 |<br>
| 4    | 处理 9  | <code>[8, 3, 4]</code>      | 9 &gt; 8，跳过     | 不更新堆                 |<br>
| 5    | 处理 1  | <code>[4, 3, 1]</code>      | 1 &lt; 8，替换堆顶 | 删除 8，插入 1，调整堆   |<br>
| 6    | 处理 5  | <code>[4, 3, 1]</code>      | 5 &gt; 4，跳过     | 不更新堆                 |<br>
| 7    | 处理 7  | <code>[4, 3, 1]</code>      | 7 &gt; 4，跳过     | 不更新堆                 |<br>
| 8    | 处理 11 | <code>[4, 3, 1]</code>      | 11 &gt; 4，跳过    | 不更新堆                 |</p>
<p><strong>问题 2：2 路外部归并排序例题</strong></p>
<p><strong>知识点讲解</strong><br>
外部归并排序分排序阶段和归并阶段，每次归并两个有序块，逐步生成更大有序块，适用于数据量超过内存的场景。</p>
<p><strong>核心规则</strong></p>
<ol>
<li><strong>排序阶段</strong>：将数据分块读入内存，排序后写回磁盘（生成初始有序块）。</li>
<li><strong>归并阶段</strong>：每次合并两个相邻有序块，生成双倍大小的有序块，直至所有数据有序。</li>
</ol>
<p><strong>例题</strong><br>
<strong>数据</strong>：磁盘上的数组 <code>[17, 3, 9, 22, 13, 7, 5, 11]</code>，内存仅能容纳 4 个元素。</p>
<p><strong>步骤解析</strong></p>
<ol>
<li>排序阶段（Pass 0）
<ul>
<li>分块 1：<code>[17, 3, 9, 22]</code> → 排序后 <code>[3, 9, 17, 22]</code>（写入磁盘）。</li>
<li>分块 2：<code>[13, 7, 5, 11]</code> → 排序后 <code>[5, 7, 11, 13]</code>（写入磁盘）。</li>
</ul>
</li>
<li>归并阶段（Pass 1）
<ul>
<li>合并两个有序块：
<ul>
<li>比较 3（块 1）和 5（块 2），取 3，块 1 指针后移。</li>
<li>比较 9（块 1）和 5（块 2），取 5，块 2 指针后移。</li>
<li>比较 9（块 1）和 7（块 2），取 7，块 2 指针后移。</li>
<li>比较 9（块 1）和 11（块 2），取 9，块 1 指针后移。</li>
<li>比较 17（块 1）和 11（块 2），取 11，块 2 指针后移。</li>
<li>比较 17（块 1）和 13（块 2），取 13，块 2 指针后移。</li>
<li>取块 1 剩余元素 17、22。</li>
</ul>
</li>
<li>生成最终有序数组：<code>[3, 5, 7, 9, 11, 13, 17, 22]</code>。</li>
</ul>
</li>
</ol>
<p><strong>步骤表格</strong></p>
<p>| 阶段   | 操作     | 内存中数据块      | 磁盘写入结果          | 备注                       |<br>
| ------ | -------- | ----------------- | --------------------- | -------------------------- |<br>
| Pass 0 | 分块排序 | 块 1: [17,3,9,22] | 块 1: [3,9,17,22]     | 生成初始有序块             |<br>
| Pass 0 | 分块排序 | 块 2: [13,7,5,11] | 块 2: [5,7,11,13]     | 生成初始有序块             |<br>
| Pass 1 | 2 路归并 | 块 1 + 块 2 合并  | [3,5,7,9,11,13,17,22] | 合并两个有序块生成最终结果 |</p>
<p><strong>总结对比</strong></p>
<p>| <strong>算法</strong>         | <strong>核心机制</strong>          | <strong>优点</strong>                            | <strong>缺点</strong>                    | <strong>典型场景</strong>                   |<br>
| ---------------- | --------------------- | ----------------------------------- | --------------------------- | ------------------------------ |<br>
| <strong>Top-N 排序</strong>   | 最大堆维护 Top-N 元素 | 避免全量排序，节省时间              | 需维护堆结构                | 数据库 <code>ORDER BY + LIMIT</code> 场景 |<br>
| <strong>外部归并排序</strong> | 分块排序后逐次归并    | 处理超大规模数据                    | 多次磁盘 I/O 操作           | 处理 TB 级数据排序             |<br>
| <strong>快速排序</strong>     | 分治 + 分区交换       | 平均时间复杂度低（(O(n \log n))） | 最坏情况 (O(n^2))，不稳定 | 内存中大规模数据排序           |</p>
<h2 id="5-14（3）transaction-and-ACID（事务和ACID特性）">5.14（3）transaction and ACID（事务和ACID特性）</h2>
<p>ACID是数据库事务的四个基本特性，分别是<strong>原子性</strong>（Atomicity）、<strong>一致性</strong>（Consistency）、<strong>隔离性</strong>（Isolation）和<strong>持久性</strong>（Durability）。</p>
<p>1.事务（Transaction）与 ACID 特性</p>
<p>（1）定义与特性</p>
<ul>
<li><strong>本质</strong>：数据库操作的基本单元，由一组逻辑相关的读写操作组成，确保数据一致性和可靠性。</li>
<li>核心特性（ACID）
<ul>
<li><strong>原子性（Atomicity）</strong>：事务中的操作要么全部执行，要么全部回滚（全或无）。</li>
<li><strong>一致性（Consistency）</strong>：事务执行前后，数据库约束（如主键、外键、CHECK 条件）保持成立。</li>
<li><strong>隔离性（Isolation）</strong>：事务执行时不受其他事务干扰，如同独占数据库。</li>
<li><strong>持久性（Durability）</strong>：已提交事务的修改永久保存，即使系统崩溃也不丢失。</li>
</ul>
</li>
<li><strong>生命周期</strong>：以<code>BEGIN</code>开始，以<code>COMMIT</code>（提交）或<code>ABORT</code>（回滚）结束。</li>
</ul>
<p>（2）ACID 核心特性对比</p>
<p>| <strong>特性</strong> | <strong>核心作用</strong>                                 | <strong>实现方式</strong>                                        |<br>
| -------- | -------------------------------------------- | --------------------------------------------------- |<br>
| 原子性   | 确保事务操作的完整性，失败时回滚到初始状态。 | 日志记录（Redo/Undo 日志）、影子分页。              |<br>
| 一致性   | 维护数据库约束，确保业务规则不被破坏。       | 应用层约束定义、数据库内置约束（如 SQL 的 CHECK）。 |<br>
| 隔离性   | 控制并发事务的交互，避免数据不一致。         | 并发控制协议（锁机制、时间戳排序、乐观并发控制）。  |<br>
| 持久性   | 保证已提交数据的永久性。                     | 日志持久化（WAL，预写日志）、磁盘同步。             |</p>
<p>（3）核心问题与解决方案</p>
<p><strong>核心挑战</strong></p>
<ul>
<li><strong>并发执行导致的数据不一致</strong>：如脏读（读取未提交数据）、丢失更新（覆盖未提交修改）、不可重复读（多次读取结果不同）。</li>
<li><strong>事务失败后的状态恢复</strong>：部分执行的事务需回滚，已提交事务需持久化。</li>
</ul>
<p><strong>解决方案</strong></p>
<ul>
<li>并发控制协议
<ul>
<li><strong>悲观协议</strong>：提前预防冲突（如锁机制，事务提前获取所需锁）。</li>
<li><strong>乐观协议</strong>：假设冲突罕见，事后验证冲突并回滚（如版本控制）。</li>
</ul>
</li>
<li><strong>恢复机制</strong>：通过日志记录事务操作，崩溃后利用 Redo 日志重做已提交事务，Undo 日志回滚未完成事务。</li>
</ul>
<p>（4）并发控制关键策略</p>
<p><strong>冲突操作定义</strong></p>
<p>两个事务对同一数据的操作满足以下条件之一：</p>
<ol>
<li><strong>读 - 写（RW）**或**写 - 读（WR）</strong>：一个读，一个写。</li>
<li><strong>写 - 写（WW）</strong>：两个写操作。</li>
</ol>
<p><strong>可串行化调度</strong></p>
<ul>
<li><strong>定义</strong>：多个事务的并发执行结果等同于某一串行执行结果（顺序不影响最终一致性）。</li>
<li><strong>冲突可串行化</strong>：若两个冲突操作的顺序在调度中与某一串行调度一致，则该调度为冲突可串行化。</li>
<li>依赖图判断法
<ul>
<li>节点：事务（如 T1、T2）。</li>
<li>边：若事务 Ti 的操作先于 Tj 的冲突操作，添加边 Ti→Tj。</li>
<li>结论：若依赖图无环，则调度是冲突可串行化的。</li>
</ul>
</li>
</ul>
<p>（5）核心公式与算法</p>
<p><strong>依赖图构建规则</strong></p>
<ol>
<li>每个事务为一个节点。</li>
<li>若 Ti 的操作 Oi 与 Tj 的操作 Oj 冲突，且 Oi 在 Oj 前执行，则添加边 Ti→Tj。</li>
<li>若图中存在环（如 T1→T2→T1），则调度不可串行化。</li>
</ol>
<p><strong>问题 1：判断冲突可串行化</strong></p>
<p><strong>操作序列</strong>：</p>
<p>T1: R(A) W(A)</p>
<p>T2: R(A) W(B)</p>
<p>T3: R(B) W(C)</p>
<p><strong>知识点讲解</strong></p>
<p>冲突操作仅发生在不同事务对同一数据的读写 / 写读 / 写写操作。本例中：</p>
<ul>
<li>T1 与 T2 对 A 有 RW 冲突（T1 读 A，T2 读 A 不冲突，因均为读；T1 写 A 与 T2 读 A 为 RW 冲突）。</li>
<li>T2 写 B 与 T3 读 B 为 RW 冲突。</li>
</ul>
<p><strong>依赖图构建</strong></p>
<p>T1→T2（T1 写 A 先于 T2 读 A？不，T2 读 A 在 T1 写 A 之前？需明确操作顺序。假设顺序为 T1.R (A), T2.R (A), T1.W (A), T2.W (B), T3.R (B), T3.W (C)，则 T1 写 A 在</p>
<p>T2 读 A 之后，无冲突；T2 写 B 先于 T3 读 B，边 T2→T3。图无环，故冲突可串行化。</p>
<p><strong>答案解析</strong></p>
<p>需明确操作顺序：</p>
<p>若顺序为：</p>
<p>T1: R(A), W(A)</p>
<p>T2: R(A), W(B)</p>
<p>T3: R(B), W(C)</p>
<p>则：</p>
<ul>
<li>T1 与 T2 对 A 的操作：T1 写 A 在 T2 读 A 之后？若 T2 读 A 在 T1 写 A 之前，则无 RW 冲突（T2 读 A 时 A 未被 T1 修改）。</li>
<li>T2 写 B 与 T3 读 B 为 RW 冲突，边 T2→T3。依赖图无环，调度冲突可串行化。</li>
</ul>
<p><strong>问题 2：脏读场景分析</strong></p>
<p><strong>事务序列</strong>：</p>
<p>T1: BEGIN, W (A, 10), 未提交</p>
<p>T2: BEGIN, R (A)（读取 T1 未提交的 A=10）, ABORT</p>
<p><strong>知识点讲解</strong></p>
<p>脏读发生在事务读取另一个未提交事务修改的数据。若 T2 在 T1 提交前读取 A，且 T1 最终回滚，T2 读取的是无效数据。</p>
<p><strong>答案解析</strong></p>
<ul>
<li>T2 执行 R (A) 时，T1 未提交，属于脏读。</li>
<li>隔离性要求需避免此类场景（如通过读已提交隔离级别）。</li>
</ul>
<p><strong>总结对比</strong></p>
<p>| <strong>并发问题</strong> | <strong>现象</strong>                       | <strong>解决方案</strong>                       |<br>
| ------------ | ------------------------------ | ---------------------------------- |<br>
| 脏读         | 读取未提交数据                 | 提高隔离级别（如读已提交）、写锁。 |<br>
| 丢失更新     | 后提交事务覆盖前事务未提交修改 | 行级锁、乐观锁（版本号校验）。     |<br>
| 不可重复读   | 两次读取结果不同               | 快照隔离、范围锁。                 |<br>
| 幻读         | 新增数据导致范围查询结果变化   | 可串行化隔离级别、间隙锁。         |</p>
<p>通过 ACID 特性和并发控制协议，数据库确保了事务的正确性和可靠性，平衡了性能与一致性需求。</p>
<h2 id="5-15（最后一次课）12-concurrency-control并发控制">5.15（最后一次课）12.concurrency control并发控制</h2>
<p>1.并发控制（Concurrency Control）</p>
<p>（1）定义与特性</p>
<ul>
<li><strong>本质</strong>：确保数据库事务并发执行时结果与串行执行一致（可串行化），通过锁机制或时间戳排序避免冲突。</li>
<li><strong>核心目标</strong>：处理读写冲突（如脏读、不可重复读、幻读），保证数据一致性。</li>
<li>主要方法
<ul>
<li><strong>锁机制</strong>：通过共享锁（S-Lock）和排他锁（X-Lock）控制对数据对象的访问。</li>
<li><strong>时间戳排序（Timestamp Ordering）</strong>：为每个事务分配唯一时间戳，按时间戳顺序处理操作，冲突时回滚事务。</li>
</ul>
</li>
</ul>
<p>（2）与时间戳排序对比</p>
<p>| <strong>特性</strong>     | <strong>锁机制</strong>           | <strong>时间戳排序</strong>       |<br>
| ------------ | -------------------- | -------------------- |<br>
| <strong>冲突处理</strong> | 阻塞等待（可能死锁） | 回滚重启（无死锁）   |<br>
| <strong>执行顺序</strong> | 由锁获取顺序决定     | 由时间戳顺序决定     |<br>
| <strong>系统开销</strong> | 锁管理开销、死锁检测 | 时间戳维护、回滚开销 |<br>
| <strong>适用场景</strong> | 高竞争、长事务       | 低冲突、短事务       |</p>
<p>（3）核心问题与解决方案</p>
<p><strong>核心挑战</strong></p>
<ul>
<li><strong>问题 1</strong>：锁冲突导致死锁（多个事务循环等待锁）。</li>
<li><strong>问题 2</strong>：级联回滚（Cascading Abort）：一个事务回滚导致依赖它的事务也回滚。</li>
<li><strong>问题 3</strong>：读写顺序冲突（如写 - 读、读 - 写冲突）。</li>
</ul>
<p><strong>解决方案</strong></p>
<ul>
<li><strong>死锁处理</strong>：超时检测、等待图检测（Cycle Detection）或银行家算法（通过安全序列避免死锁）。</li>
<li><strong>避免级联回滚</strong>：使用严格两阶段锁（Strict 2PL），事务提交前不释放写锁。</li>
<li>冲突控制
<ul>
<li>锁机制：通过兼容性矩阵（如 S 锁与 X 锁互斥）控制并发访问。</li>
<li>时间戳排序：通过比较事务时间戳与数据对象的读写时间戳（R-TS/W-TS）决定是否允许操作。</li>
</ul>
</li>
</ul>
<p>（4）关键策略与协议</p>
<p><strong>1. 锁类型与兼容性矩阵</strong></p>
<ul>
<li>
<p><strong>S-Lock（共享锁）</strong>：允许多个事务同时读取同一数据项，但禁止其他事务写入。</p>
</li>
<li>
<p><strong>X-Lock（排他锁）</strong>：独占数据项，禁止其他事务读写。</p>
</li>
<li>
<p><strong>锁兼容性矩阵</strong>：</p>
</li>
</ul>
<p>| 现有锁 \ 请求锁                                              | S-Lock | X-Lock |<br>
| ------------------------------------------------------------ | ------ | ------ |<br>
| S-Lock                                                       | 允许   | 拒绝   |<br>
| X-Lock                                                       | 拒绝   | 拒绝   |<br>
| 例如，若事务 T1 持有 S 锁，事务 T2 可申请 S 锁（共享读），但 T2 申请 X 锁会被拒绝。 |        |        |</p>
<h2 id="assignment-3前置练习：B-树">assignment 3前置练习：B+树</h2>
<p><strong>B+ Tree</strong></p>
<p>Construct a B+ Tree where each node can hold a maximum of 4 keys.</p>
<p>To ensure consistency and avoid ambiguity during node splits, follow these rules:</p>
<ol>
<li>
<p>Splitting Rule: When a node overflows (i.e., receives a 5th key), split it into two child nodes such that the right node contains more keys than the left node (in case of an odd number).</p>
</li>
<li>
<p>Promotion Rule:</p>
</li>
</ol>
<p>Leaf Node Split: <strong>Copy</strong> (<strong>do not move</strong>) the leftmost key of the right node up to the parent. Leaf nodes store actual data, so the inserted key must remain in the leaf.</p>
<p>Internal Node Split: <strong>Move</strong> the leftmost key of the right node up to the parent. Internal nodes are used purely for navigation, so the promoted key is removed from the child node to reduce redundancy. (This splitting behavior differs from that presented in our lecture slides. However, both approaches are considered acceptable in practice. For the purposes of this exercise, please follow the rule described above)</p>
<ol start="3">
<li>Deletion Rule:</li>
</ol>
<p>When a key is deleted and a node underflows (i.e., it has fewer than the minimum number of keys), attempt to borrow a key from a sibling. If borrowing is not possible, merge the underflowed node with a sibling, and remove the separating key from the parent. This can cause cascading merges up the tree.</p>
<p>If, as a result of merging, the root node ends up with only one remaining child, the root is removed, and its single child becomes the new root, effectively reducing the height of the tree by one.</p>
<p>Task 1: Insert the following sequence of keys and draw the final tree</p>
<p>10, 20, 5, 6, 12, 30, 7, 17, 3, 25, 27, 4, 31</p>
<p>Task 2: Delete the following number of keys 3, 4, 25 Tip: You can use the visualisation tool to verify your answer</p>
<p>(https://www.cs.usfca.edu/~galles/visualization/BPlusTree.html)</p>

    </div>

    
    
    

    <footer class="post-footer">
          <div class="reward-container">
  <div>请我一杯咖啡吧！</div>
  <button>
    赞赏
  </button>
  <div class="post-reward">
      <div>
        <img src="/images/wechatpay.png" alt="Viny Yang 微信">
        <span>微信</span>
      </div>
      <div>
        <img src="/images/alipay.png" alt="Viny Yang 支付宝">
        <span>支付宝</span>
      </div>

  </div>
</div>

          

<div class="post-copyright">
<ul>
  <li class="post-copyright-author">
      <strong>本文作者： </strong>Viny Yang
  </li>
  <li class="post-copyright-link">
      <strong>本文链接：</strong>
      <a href="https://vinyyang.github.io/%E6%95%B0%E6%8D%AE%E5%BA%93%E5%8E%9F%E7%90%86%E4%B8%8E%E5%BA%94%E7%94%A8%EF%BC%88%E5%A4%96%E6%95%99%E7%89%88%EF%BC%89/" title="数据库原理与应用（外教版）">https://vinyyang.github.io/数据库原理与应用（外教版）/</a>
  </li>
  <li class="post-copyright-license">
      <strong>版权声明： </strong>本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" rel="noopener" target="_blank"><i class="fab fa-fw fa-creative-commons"></i>BY-NC-SA</a> 许可协议。转载请注明出处！
  </li>
</ul>
</div>

          <div class="post-tags">
              <a href="/tags/%E5%AD%A6%E4%B9%A0/" rel="tag"><i class="fa fa-tag"></i> 学习</a>
          </div>

        
  <div class="social-like a2a_kit a2a_kit_size_32 a2a_default_style">
    <a class="a2a_dd" target="_blank" rel="noopener" href="https://www.addtoany.com/share"></a>
      <a class="a2a_button_wechat"></a>
  </div>

          <div class="post-nav">
            <div class="post-nav-item">
                <a href="/%E7%BB%84%E4%BC%9A%E5%AD%A6%E4%B9%A0%E8%AE%B0%E5%BD%95/" rel="prev" title="组会学习记录">
                  <i class="fa fa-angle-left"></i> 组会学习记录
                </a>
            </div>
            <div class="post-nav-item">
                <a href="/%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90%E6%96%B9%E6%B3%95%EF%BC%88%E5%A4%96%E6%95%99%E7%89%88%EF%BC%89/" rel="next" title="数据分析方法（外教版）">
                  数据分析方法（外教版） <i class="fa fa-angle-right"></i>
                </a>
            </div>
          </div>
    </footer>
  </article>
</div>






    
  
  <div class="comments giscus-container">
  </div>
  
  
</div>
  </main>

  <footer class="footer">
    <div class="footer-inner">

  <div class="copyright">
    &copy; 
    <span itemprop="copyrightYear">2025</span>
    <span class="with-love">
      <i class="fa fa-heart"></i>
    </span>
    <span class="author" itemprop="copyrightHolder">Viny Yang</span>
  </div>
<div class="wordcount">
  <span class="post-meta-item">
    <span class="post-meta-item-icon">
      <i class="fa fa-chart-line"></i>
    </span>
    <span title="站点总字数">340k</span>
  </span>
  <span class="post-meta-item">
    <span class="post-meta-item-icon">
      <i class="fa fa-coffee"></i>
    </span>
    <span title="站点阅读时长">10:19</span>
  </span>
</div>
<div class="busuanzi-count">
    <span class="post-meta-item" id="busuanzi_container_site_uv">
      <span class="post-meta-item-icon">
        <i class="fa fa-user"></i>
      </span>
      <span class="site-uv" title="总访客量">
        <span id="busuanzi_value_site_uv"></span>
      </span>
    </span>
    <span class="post-meta-item" id="busuanzi_container_site_pv">
      <span class="post-meta-item-icon">
        <i class="fa fa-eye"></i>
      </span>
      <span class="site-pv" title="总访问量">
        <span id="busuanzi_value_site_pv"></span>
      </span>
    </span>
</div>

<!-- 网站运行时间的设置 -->
<span id="timeDate">载入天数...</span>
<span id="times">载入时分秒...</span>
<script>
    var now = new Date();
    function createtime() {
        var grt= new Date("03/01/2023 10:00:00"); //此处修改你的建站时间或者网站上线时间
        now.setTime(now.getTime()+250);
        days = (now - grt ) / 1000 / 60 / 60 / 24; dnum = Math.floor(days);
        hours = (now - grt ) / 1000 / 60 / 60 - (24 * dnum); hnum = Math.floor(hours);
        if(String(hnum).length ==1 ){hnum = "0" + hnum;} minutes = (now - grt ) / 1000 /60 - (24 * 60 * dnum) - (60 * hnum);
        mnum = Math.floor(minutes); if(String(mnum).length ==1 ){mnum = "0" + mnum;}
        seconds = (now - grt ) / 1000 - (24 * 60 * 60 * dnum) - (60 * 60 * hnum) - (60 * mnum);
        snum = Math.round(seconds); if(String(snum).length ==1 ){snum = "0" + snum;}
        document.getElementById("timeDate").innerHTML = "本站已安全运行 "+dnum+" 天 ";
        document.getElementById("times").innerHTML = hnum + " 小时 " + mnum + " 分 " + snum + " 秒.";
    }
setInterval("createtime()",250);
</script>
    </div>
  </footer>

  
  <div class="toggle sidebar-toggle" role="button">
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
  </div>
  <div class="sidebar-dimmer"></div>
  <div class="reading-progress-bar"></div>

  <a href="https://github.com/VinyYang" class="github-corner" title="在 GitHub 上关注我" aria-label="在 GitHub 上关注我" rel="noopener" target="_blank"><svg width="80" height="80" viewBox="0 0 250 250" aria-hidden="true"><path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"></path><path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2" fill="currentColor" style="transform-origin: 130px 106px;" class="octo-arm"></path><path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z" fill="currentColor" class="octo-body"></path></svg></a>

<noscript>
  <div class="noscript-warning">Theme NexT works best with JavaScript enabled</div>
</noscript>


  
  <script src="https://cdnjs.cloudflare.com/ajax/libs/animejs/3.2.1/anime.min.js" integrity="sha256-XL2inqUJaslATFnHdJOi9GfQ60on8Wx1C2H8DYiN1xY=" crossorigin="anonymous"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/fancyapps-ui/5.0.31/fancybox/fancybox.umd.js" integrity="sha256-a+H7FYzJv6oU2hfsfDGM2Ohw/cR9v+hPfxHCLdmCrE8=" crossorigin="anonymous"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/pangu/4.0.7/pangu.min.js" integrity="sha256-j+yj56cdEY2CwkVtGyz18fNybFGpMGJ8JxG3GSyO2+I=" crossorigin="anonymous"></script>
<script src="/js/comments.js"></script><script src="/js/utils.js"></script><script src="/js/motion.js"></script><script src="/js/sidebar.js"></script><script src="/js/next-boot.js"></script>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/hexo-generator-searchdb/1.4.1/search.js" integrity="sha256-1kfA5uHPf65M5cphT2dvymhkuyHPQp5A53EGZOnOLmc=" crossorigin="anonymous"></script>
<script src="/js/third-party/search/local-search.js"></script>

  <script class="next-config" data-name="pdf" type="application/json">{"object_url":{"url":"https://cdnjs.cloudflare.com/ajax/libs/pdfobject/2.3.0/pdfobject.min.js","integrity":"sha256-JJZNsid68vnh3/zyj0lY9BN5ynxVX/12XgOa1TlaYN0="},"url":"/lib/pdf/web/viewer.html"}</script>
  <script src="/js/third-party/tags/pdf.js"></script>

  <script class="next-config" data-name="mermaid" type="application/json">{"enable":true,"theme":{"light":"default","dark":"dark"},"js":{"url":"https://cdnjs.cloudflare.com/ajax/libs/mermaid/11.4.0/mermaid.min.js","integrity":"sha256-G8ouPAnw4zzMbnAenHnVz6h9XpKbNdOkrqTh7AadyHs="}}</script>
  <script src="/js/third-party/tags/mermaid.js"></script>


  <script src="/js/third-party/fancybox.js"></script>

  <script src="/js/third-party/pace.js"></script>

  <script src="/js/third-party/addtoany.js"></script>

  
  <script async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>




  

  <script class="next-config" data-name="enableMath" type="application/json">true</script><script class="next-config" data-name="mathjax" type="application/json">{"enable":true,"tags":"all","js":{"url":"https://cdnjs.cloudflare.com/ajax/libs/mathjax/3.2.2/es5/tex-mml-chtml.js","integrity":"sha256-MASABpB4tYktI2Oitl4t+78w/lyA+D7b/s9GEP0JOGI="}}</script>
<script src="/js/third-party/math/mathjax.js"></script>


<script class="next-config" data-name="giscus" type="application/json">{"enable":true,"repo":"VinyYang/VinyYang.github.io","repo_id":"R_kgDON5FgxA","category":"Announcements","category_id":"DIC_kwDON5FgxM4Cm-MG","mapping":"pathname","strict":0,"reactions_enabled":1,"emit_metadata":0,"theme":"light","lang":"zh-CN","crossorigin":"anonymous","input_position":"bottom","loading":"lazy"}</script>

<script>
document.addEventListener('page:loaded', () => {
  if (!CONFIG.page.comments) return;

  NexT.utils.loadComments('.giscus-container')
    .then(() => NexT.utils.getScript('https://giscus.app/client.js', {
      attributes: {
        async                   : true,
        crossOrigin             : 'anonymous',
        'data-repo'             : CONFIG.giscus.repo,
        'data-repo-id'          : CONFIG.giscus.repo_id,
        'data-category'         : CONFIG.giscus.category,
        'data-category-id'      : CONFIG.giscus.category_id,
        'data-mapping'          : CONFIG.giscus.mapping,
        'data-strict'           : CONFIG.giscus.strict,
        'data-reactions-enabled': CONFIG.giscus.reactions_enabled,
        'data-emit-metadata'    : CONFIG.giscus.emit_metadata,
        'data-theme'            : CONFIG.giscus.theme,
        'data-lang'             : CONFIG.giscus.lang,
        'data-input-position'   : CONFIG.giscus.input_position,
        'data-loading'          : CONFIG.giscus.loading
      },
      parentNode: document.querySelector('.giscus-container')
    }));
});
</script>

<div class="contact-modal-overlay" style="display: none;">
  <div class="contact-modal-box">
    <div class="contact-modal-header">
      <span class="contact-modal-title"></span>
      <div class="header-actions">
        <button class="copy-button" data-email="yhy520@email.swu.edu.cn">
          <i class="fa fa-copy"></i>
        </button>
        <button class="contact-modal-close">&times;</button>
      </div>
    </div>
    <div class="contact-modal-body">
      <div class="image-wrapper">
        <img class="contact-qrcode" src="" alt="联系方式">
      </div>
    </div>
  </div>
</div>

<style>
/* 模态框基础样式 */
.contact-modal-overlay {
  position: fixed;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  background: rgba(0,0,0,0.6);
  z-index: 9999;
  display: flex;
  justify-content: center;
  align-items: center;
  opacity: 0;
  transition: opacity 0.3s ease;
}

.contact-modal-box {
  background: #fff;
  border-radius: 12px;
  box-shadow: 0 5px 15px rgba(0,0,0,0.3);
  max-width: 80%;
  min-width: 300px;
  transform: scale(0.8);
  transition: all 0.3s ease;
}

.contact-modal-overlay.active {
  opacity: 1;
}

.contact-modal-overlay.active .contact-modal-box {
  transform: scale(1);
}

.contact-modal-header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  padding: 15px 20px;
  border-bottom: 1px solid #eee;
}

.header-actions {
  display: flex;
  align-items: center;
  gap: 15px;
}

.contact-modal-title {
  font-size: 1.2em;
  color: #333;
  font-weight: bold;
}

.contact-modal-close {
  background: none;
  border: none;
  font-size: 24px;
  cursor: pointer;
  color: #666;
  transition: color 0.2s;
}

.contact-modal-close:hover {
  color: #333;
}

/* 图片容器 */
.image-wrapper {
  padding: 20px;
}

.contact-qrcode {
  max-width: 280px;
  max-height: 60vh;
  display: block;
  margin: 0 auto;
}

/* 复制按钮样式 */
.copy-button {
  background: rgba(255,255,255,0.9);
  border: 1px solid #eee;
  border-radius: 4px;
  padding: 6px 12px;
  cursor: pointer;
  transition: all 0.3s;
  display: none;
  color: #666;
}

.copy-button:hover {
  background: #fff;
  box-shadow: 0 2px 8px rgba(0,0,0,0.1);
}

/* 邮箱按钮颜色保护 */
a[href*="/images/email.png"] {
  color: #fff !important;
}

a[href*="/images/email.png"] i {
  color: inherit !important;
}

@media (max-width: 767px) {
  .contact-modal-box {
    max-width: 90%;
  }
  
  .contact-qrcode {
    max-width: 200px;
  }
  
  .header-actions {
    gap: 10px;
  }
  
  .copy-button {
    padding: 4px 8px;
  }
}
</style>

<script>
document.addEventListener('DOMContentLoaded', function() {
  // 绑定所有按钮事件
  const contactButtons = document.querySelectorAll(
    'a[href*="/images/wechat.png"], ' +
    'a[href*="/images/qq.png"], ' +
    'a[href*="/images/email.png"]'
  );

  // 通用展示函数
  const showContactModal = (type, path) => {
    const overlay = document.querySelector('.contact-modal-overlay');
    const title = document.querySelector('.contact-modal-title');
    const img = document.querySelector('.contact-qrcode');
    const copyBtn = document.querySelector('.copy-button');

    // 设置内容
    title.textContent = type;
    img.src = path;
    
    // 邮箱特殊处理
    if (type === '邮箱') {
      copyBtn.style.display = 'flex';
      copyBtn.querySelector('i').className = 'fa fa-copy'; // 重置图标状态
    } else {
      copyBtn.style.display = 'none';
    }

    // 显示模态框
    overlay.style.display = 'flex';
    setTimeout(() => overlay.classList.add('active'), 10);
  };

  // 绑定按钮点击事件
  contactButtons.forEach(btn => {
    btn.addEventListener('click', function(e) {
      e.preventDefault();
      const typeMap = {
        weixin: '微信',
        qq: 'QQ',
        envelope: '邮箱'
      };
      const iconClass = this.querySelector('i').className;
      const type = Object.keys(typeMap).find(key => iconClass.includes(key)) || '联系方式';
      showContactModal(typeMap[type], this.href);
    });
  });

  // 复制功能（防爬虫版）
  document.querySelector('.copy-button').addEventListener('click', function() {
    try {
      // 混淆邮箱地址（反转+Base64）
      const reversedEmail = 'yhy520@email.swu.edu.cn'.split('').reverse().join('');
      const realEmail = atob('eWh5NTIwQGVtYWlsLnN3dS5lZHUuY24='); // Base64解码
      
      navigator.clipboard.writeText(realEmail).then(() => {
        this.innerHTML = '<i class="fa fa-check"></i>';
        setTimeout(() => {
          this.innerHTML = '<i class="fa fa-copy"></i>';
        }, 2000);
      });
    } catch (error) {
      console.error('复制失败:', error);
      this.innerHTML = '<i class="fa fa-times"></i>';
      setTimeout(() => {
        this.innerHTML = '<i class="fa fa-copy"></i>';
      }, 2000);
    }
  });

  // 关闭逻辑
  const closeModal = () => {
    const overlay = document.querySelector('.contact-modal-overlay');
    overlay.classList.remove('active');
    setTimeout(() => {
      overlay.style.display = 'none';
    }, 300);
  };

  document.querySelector('.contact-modal-close').addEventListener('click', closeModal);
  document.querySelector('.contact-modal-overlay').addEventListener('click', (e) => {
    if(e.target === e.currentTarget) closeModal();
  });
});
</script>
</body>
</html>
